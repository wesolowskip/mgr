+ CONTAINER=/home2/faculty/pwesolowski/containers/cuml-prod.sif
+ CONTAINER_RC_FILE=/home2/faculty/pwesolowski/containers/singularity_rc
+ SCRIPT=/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ for FILES in "California.json" ""
+ for PROTOCOL in tcp ucx
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (2998786)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 20:09:18,936 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:09:18,937 - distributed.diskutils - INFO - Found stale lock file and directory '/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-9k33g8hl', purging
2023-07-04 20:09:18,938 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:09:18,940 - distributed.diskutils - INFO - Found stale lock file and directory '/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-97b9jkq0', purging
2023-07-04 20:09:18,944 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:09:18,944 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 32711.63778 ms
Code block 'ddf-preprocessing' took: 7623.05714 ms
Code block 'ddf-preprocessing' took: 7628.32862 ms
Code block 'ddf-preprocessing' took: 7629.41051 ms
Code block 'ddf-preprocessing' took: 7651.63739 ms
Code block 'ddf-scaler-fit' took: 12082.52517 ms
Code block 'ddf-scaler-fit' took: 7785.72938 ms
Code block 'ddf-scaler-fit' took: 8324.76450 ms
Code block 'ddf-scaler-fit' took: 8479.15670 ms
Code block 'ddf-scaler-fit' took: 8665.02044 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13742.82426 ms
Code block 'ddf-kmeans-score' took: 8480.62248 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9753.08750 ms
Code block 'ddf-kmeans-score' took: 8415.60135 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10246.17387 ms
Code block 'ddf-kmeans-score' took: 8299.16118 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9875.03988 ms
Code block 'ddf-kmeans-score' took: 8421.98314 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9870.55522 ms
Code block 'ddf-kmeans-score' took: 8420.96337 ms
scores=[array(-318381.20825195)]
client.get_worker_logs()={'tcp://127.0.0.1:34887': (('INFO', "2023-07-04 20:12:50,845 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:12:49,230 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:12:31,520 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:12:29,899 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:12:12,317 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:12:10,459 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:11:52,463 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:11:50,918 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:11:33,202 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:11:27,602 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:09:22,926 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:09:22,925 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:38247'), ('INFO', '2023-07-04 20:09:22,893 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:09:22,893 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-2b9bf1cf-76e9-43ba-ae71-9d68690cd915'), ('INFO', '2023-07-04 20:09:22,892 - distributed.worker - INFO - Starting Worker plugin RMMSetup-2e9fa10d-9708-431c-9ce6-7f7c92fde988'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO - Starting Worker plugin PreImport-53022dc7-fe52-45d8-9b7d-38acf165bb63'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-vnuyralg'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:38247'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33731'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:34887'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:34887')), 'tcp://127.0.0.1:36697': (('INFO', "2023-07-04 20:12:50,845 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:12:49,230 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:12:31,521 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:12:29,899 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:12:12,317 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:12:10,459 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:11:52,463 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:11:50,918 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:11:33,202 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:11:27,602 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:09:22,925 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:09:22,924 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:38247'), ('INFO', '2023-07-04 20:09:22,895 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO - Starting Worker plugin PreImport-45ded38e-1078-4e49-8314-39f1981ee0d9'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-5783fbc9-c622-4bf3-9994-bf30d3972529'), ('INFO', '2023-07-04 20:09:20,136 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ea991c53-8cf7-4008-bc49-386b681ad1aa'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-uxsfae6f'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:38247'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45093'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:36697'), ('INFO', '2023-07-04 20:09:20,135 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:36697'))}
2023-07-04 20:13:04,021 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-04 20:13:04,023 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3003944)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 20:13:21,126 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:13:21,127 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:13:21,127 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:13:21,127 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31336.59566 ms
Code block 'ddf-preprocessing' took: 7654.58000 ms
Code block 'ddf-preprocessing' took: 7640.86412 ms
Code block 'ddf-preprocessing' took: 7980.48394 ms
Code block 'ddf-preprocessing' took: 7891.11305 ms
Code block 'ddf-scaler-fit' took: 13465.21608 ms
Code block 'ddf-scaler-fit' took: 9498.54724 ms
Code block 'ddf-scaler-fit' took: 9354.74110 ms
Code block 'ddf-scaler-fit' took: 9820.89043 ms
Code block 'ddf-scaler-fit' took: 10128.82913 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 15106.36276 ms
Code block 'ddf-kmeans-score' took: 9985.62398 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12201.03631 ms
Code block 'ddf-kmeans-score' took: 10129.75727 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11512.89106 ms
Code block 'ddf-kmeans-score' took: 9955.39017 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11348.28301 ms
Code block 'ddf-kmeans-score' took: 9881.42743 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11543.91309 ms
Code block 'ddf-kmeans-score' took: 9836.36652 ms
scores=[array(-365185.88671875)]
client.get_worker_logs()={'tcp://127.0.0.1:34143': (('INFO', "2023-07-04 20:17:13,858 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:17:12,228 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:16:51,408 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:16:49,781 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:16:28,891 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:16:27,189 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:16:06,212 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:16:03,930 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:15:42,991 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:15:37,771 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:13:25,401 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:13:25,400 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:45037'), ('INFO', '2023-07-04 20:13:25,356 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:13:25,356 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-cb07b4dc-973b-404d-b5c5-47afe41da672'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO - Starting Worker plugin PreImport-24141024-028d-49f0-9f7c-f509703aa2c8'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO - Starting Worker plugin RMMSetup-48bd6b4e-9855-4b55-8513-63d0bee4de27'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-99retjxk'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:45037'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34783'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:34143'), ('INFO', '2023-07-04 20:13:22,330 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:34143')), 'tcp://127.0.0.1:39293': (('INFO', "2023-07-04 20:17:13,858 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:17:12,228 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:16:51,408 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:16:49,781 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:16:28,891 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:16:27,189 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:16:06,212 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:16:03,930 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:15:42,991 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:15:37,770 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:13:25,400 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:13:25,400 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:45037'), ('INFO', '2023-07-04 20:13:25,356 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:13:25,356 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-a97ee469-cc7c-402a-81eb-d955fe4ce4f1'), ('INFO', '2023-07-04 20:13:25,356 - distributed.worker - INFO - Starting Worker plugin RMMSetup-e7268153-f709-416d-91dc-69fb7d71f4d7'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO - Starting Worker plugin PreImport-fbed2645-c6da-42b5-9b7e-dbe4f2707e4c'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-8d4kn8nf'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:45037'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40027'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:39293'), ('INFO', '2023-07-04 20:13:22,331 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:39293'))}
2023-07-04 20:17:28,281 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-04 20:17:28,283 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3009552)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 20:17:45,639 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:17:45,640 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:17:45,641 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:17:45,641 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 32887.42213 ms
Code block 'ddf-preprocessing' took: 9042.20980 ms
Code block 'ddf-preprocessing' took: 8022.64136 ms
Code block 'ddf-preprocessing' took: 9124.80835 ms
Code block 'ddf-preprocessing' took: 9021.84755 ms
Code block 'ddf-scaler-fit' took: 11496.02986 ms
Code block 'ddf-scaler-fit' took: 6850.59399 ms
Code block 'ddf-scaler-fit' took: 7024.79629 ms
Code block 'ddf-scaler-fit' took: 7096.09291 ms
Code block 'ddf-scaler-fit' took: 7178.10246 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13148.39888 ms
Code block 'ddf-kmeans-score' took: 7298.16618 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9204.66254 ms
Code block 'ddf-kmeans-score' took: 7348.23837 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8965.22315 ms
Code block 'ddf-kmeans-score' took: 7350.08653 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8631.21247 ms
Code block 'ddf-kmeans-score' took: 7181.12860 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8724.65419 ms
Code block 'ddf-kmeans-score' took: 7344.22928 ms
scores=[array(-883829.11328125)]
client.get_worker_logs()={'tcp://127.0.0.1:37917': (('INFO', "2023-07-04 20:21:06,734 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:21:05,351 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:20:49,814 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:20:48,328 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:20:32,811 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:20:31,096 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:20:15,488 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:20:13,461 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:19:57,820 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:19:51,857 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:17:49,706 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:17:49,705 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:42755'), ('INFO', '2023-07-04 20:17:49,671 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO - Starting Worker plugin PreImport-40c9251c-95f2-4ae9-844d-01ef7319ac4d'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-dd41b298-4ee6-4f5b-806a-d9b8c3a2a272'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO - Starting Worker plugin RMMSetup-f04e9d69-8954-40dd-be9e-89611c0d24b5'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-koubyvzt'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:42755'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35755'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:37917'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:37917')), 'tcp://127.0.0.1:44929': (('INFO', "2023-07-04 20:21:06,734 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:21:05,352 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:20:49,815 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:20:48,329 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:20:32,811 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:20:31,096 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:20:15,488 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:20:13,460 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:19:57,820 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:19:51,858 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:17:49,706 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:17:49,706 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:42755'), ('INFO', '2023-07-04 20:17:49,671 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:17:49,671 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-11832145-bf19-4d61-b629-075546b1e418'), ('INFO', '2023-07-04 20:17:49,671 - distributed.worker - INFO - Starting Worker plugin RMMSetup-3b9394e2-3195-45b6-aa05-0e0a6f28496a'), ('INFO', '2023-07-04 20:17:46,849 - distributed.worker - INFO - Starting Worker plugin PreImport-772464ef-ff51-4ee8-939d-50b7b8e606eb'), ('INFO', '2023-07-04 20:17:46,849 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-np46kgom'), ('INFO', '2023-07-04 20:17:46,849 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:17:46,849 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:17:46,849 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:17:46,849 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:42755'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43007'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:44929'), ('INFO', '2023-07-04 20:17:46,848 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:44929'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3014705)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 20:21:34,966 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:21:34,967 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:21:34,967 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:21:34,967 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31910.18866 ms
Code block 'ddf-preprocessing' took: 8011.56021 ms
Code block 'ddf-preprocessing' took: 9037.89615 ms
Code block 'ddf-preprocessing' took: 9155.14549 ms
Code block 'ddf-preprocessing' took: 8019.41660 ms
Code block 'ddf-scaler-fit' took: 13172.93656 ms
Code block 'ddf-scaler-fit' took: 8533.66129 ms
Code block 'ddf-scaler-fit' took: 9559.20874 ms
Code block 'ddf-scaler-fit' took: 8739.40087 ms
Code block 'ddf-scaler-fit' took: 8572.94102 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 14669.09787 ms
Code block 'ddf-kmeans-score' took: 8993.40339 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10285.17668 ms
Code block 'ddf-kmeans-score' took: 9035.19278 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10259.09739 ms
Code block 'ddf-kmeans-score' took: 8708.65713 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11237.30372 ms
Code block 'ddf-kmeans-score' took: 9008.70018 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10300.24258 ms
Code block 'ddf-kmeans-score' took: 8880.41791 ms
scores=[array(-186977.23925781)]
client.get_worker_logs()={'tcp://127.0.0.1:33801': (('INFO', "2023-07-04 20:25:17,029 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:25:15,317 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:24:56,721 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:24:54,433 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:24:35,787 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:24:34,200 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:24:15,504 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:24:13,790 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:23:55,078 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:23:49,370 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:21:38,651 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:21:38,651 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:41061'), ('INFO', '2023-07-04 20:21:38,620 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:21:38,620 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-dc618dbd-78f1-427e-8c1d-e51de0a4072d'), ('INFO', '2023-07-04 20:21:38,620 - distributed.worker - INFO - Starting Worker plugin RMMSetup-b1842b33-f2ed-441d-a313-0616f5de2e11'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO - Starting Worker plugin PreImport-82f93216-2554-4f3c-beff-80ae467f9539'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-vi6ilriy'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:41061'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44897'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:33801'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:33801')), 'tcp://127.0.0.1:43065': (('INFO', "2023-07-04 20:25:17,029 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:25:15,317 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:24:56,722 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:24:54,433 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:24:35,787 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:24:34,200 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:24:15,504 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:24:13,790 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:23:55,078 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:23:49,370 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:21:38,652 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:21:38,652 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:41061'), ('INFO', '2023-07-04 20:21:38,620 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:21:38,620 - distributed.worker - INFO - Starting Worker plugin RMMSetup-8cb7382a-4fd3-40c3-9250-fe546442b8c1'), ('INFO', '2023-07-04 20:21:38,620 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-a0a8c2c0-352f-472d-aaf5-6c71ef0dbf2f'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO - Starting Worker plugin PreImport-8daac86c-d32e-4fe1-9948-5bb08bdb7ef3'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-jvzzj_jy'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:41061'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44437'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:43065'), ('INFO', '2023-07-04 20:21:36,186 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:43065'))}
2023-07-04 20:25:30,526 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-04 20:25:30,528 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3019976)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 20:25:46,946 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:25:46,947 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:25:46,947 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:25:46,947 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25437.50196 ms
Code block 'ddf-preprocessing' took: 7991.63207 ms
Code block 'ddf-preprocessing' took: 7658.43464 ms
Code block 'ddf-preprocessing' took: 7661.07005 ms
Code block 'ddf-preprocessing' took: 7630.16140 ms
Code block 'ddf-scaler-fit' took: 11108.37772 ms
Code block 'ddf-scaler-fit' took: 6757.47996 ms
Code block 'ddf-scaler-fit' took: 7223.12994 ms
Code block 'ddf-scaler-fit' took: 7160.09507 ms
Code block 'ddf-scaler-fit' took: 7463.12540 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12153.80795 ms
Code block 'ddf-kmeans-score' took: 6680.66391 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8583.74546 ms
Code block 'ddf-kmeans-score' took: 7016.67860 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8140.33630 ms
Code block 'ddf-kmeans-score' took: 6791.87810 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8315.86612 ms
Code block 'ddf-kmeans-score' took: 7016.85576 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8455.50017 ms
Code block 'ddf-kmeans-score' took: 6819.00116 ms
scores=[array(-216626.92163086)]
client.get_worker_logs()={'tcp://127.0.0.1:32971': (('INFO', "2023-07-04 20:28:57,858 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:56,085 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:28:41,393 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:39,712 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:28:25,290 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:23,589 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:28:09,141 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:07,246 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:27:52,878 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:27:47,533 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:25:51,305 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:25:51,305 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:41817'), ('INFO', '2023-07-04 20:25:51,271 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:25:48,712 - distributed.worker - INFO - Starting Worker plugin PreImport-5bfa637f-c349-4203-9a12-e33cb447f96e'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - Starting Worker plugin RMMSetup-01204e65-0cce-47f4-bbf8-62d72ac19384'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-eee56d4a-1d4e-480a-a776-da75c4a52b63'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-zocyoo9a'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:41817'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46341'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:32971'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:32971')), 'tcp://127.0.0.1:42641': (('INFO', "2023-07-04 20:28:57,858 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:56,085 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:28:41,393 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:39,712 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:28:25,290 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:23,589 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:28:09,141 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:28:07,246 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:27:52,878 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:27:47,533 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:25:57,359 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:25:57,359 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:41817'), ('INFO', '2023-07-04 20:25:57,351 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:25:51,271 - distributed.worker - INFO - Starting Worker plugin RMMSetup-6b3d822f-e9b6-41dd-93fa-c821e868ba74'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - Starting Worker plugin PreImport-f6f0dc4b-f8bb-4ba2-ad25-a07aa2ea466f'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-953f275e-5662-450b-9587-9dfe65e09d7e'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-a1i1uadj'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:41817'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44359'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:42641'), ('INFO', '2023-07-04 20:25:47,903 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:42641'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3024529)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 20:29:27,401 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:29:27,402 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:29:27,402 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:29:27,403 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30802.31500 ms
Code block 'ddf-preprocessing' took: 7642.57152 ms
Code block 'ddf-preprocessing' took: 7891.61575 ms
Code block 'ddf-preprocessing' took: 7735.64789 ms
Code block 'ddf-preprocessing' took: 7889.62097 ms
Code block 'ddf-scaler-fit' took: 12654.35873 ms
Code block 'ddf-scaler-fit' took: 8158.24698 ms
Code block 'ddf-scaler-fit' took: 8665.83303 ms
Code block 'ddf-scaler-fit' took: 8553.80420 ms
Code block 'ddf-scaler-fit' took: 9027.89546 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13453.35762 ms
Code block 'ddf-kmeans-score' took: 8154.90646 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9737.65845 ms
Code block 'ddf-kmeans-score' took: 8395.29405 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10030.48531 ms
Code block 'ddf-kmeans-score' took: 8270.46385 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9987.22998 ms
Code block 'ddf-kmeans-score' took: 8304.72373 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9744.94808 ms
Code block 'ddf-kmeans-score' took: 8382.21589 ms
scores=[array(-216138.40722656)]
client.get_worker_logs()={'tcp://127.0.0.1:38159': (('INFO', "2023-07-04 20:32:59,600 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:32:57,920 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:32:40,380 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:32:38,593 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:32:21,108 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:32:19,214 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:32:01,605 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:31:59,937 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:31:42,597 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:31:37,568 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:29:32,119 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:29:32,119 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:35561'), ('INFO', '2023-07-04 20:29:32,086 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:29:29,056 - distributed.worker - INFO - Starting Worker plugin PreImport-fc202e0e-3612-43c8-bc6b-d0437745e0c1'), ('INFO', '2023-07-04 20:29:29,056 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-5a786496-ec95-4eca-89fc-895c203d47fe'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO - Starting Worker plugin RMMSetup-277d29fd-7ed0-45e2-bf62-35bf24db49af'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-0vgjc2rl'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:35561'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43301'), ('INFO', '2023-07-04 20:29:28,605 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:38159'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:38159')), 'tcp://127.0.0.1:45569': (('INFO', "2023-07-04 20:32:59,600 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:32:57,920 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:32:40,380 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:32:38,593 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:32:21,108 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:32:19,214 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:32:01,605 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:31:59,937 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:31:42,597 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:31:37,568 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:29:32,118 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:29:32,118 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:35561'), ('INFO', '2023-07-04 20:29:32,086 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:29:29,056 - distributed.worker - INFO - Starting Worker plugin PreImport-bc7d8b86-1fde-44ad-89c9-268d1936ab0b'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO - Starting Worker plugin RMMSetup-c9a60cb2-f952-4363-89ef-bed731a15a83'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-260c840d-23db-43eb-9ce1-75f8da9cf566'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-8hhkghfq'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:35561'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -          dashboard at:            127.0.0.1:42507'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:45569'), ('INFO', '2023-07-04 20:29:28,604 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:45569'))}
2023-07-04 20:33:12,530 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-04 20:33:12,531 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3029573)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 20:33:29,011 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:33:29,012 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:33:29,012 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:33:29,012 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 27269.60297 ms
Code block 'ddf-preprocessing' took: 8184.52080 ms
Code block 'ddf-preprocessing' took: 9111.46486 ms
Code block 'ddf-preprocessing' took: 8999.24779 ms
Code block 'ddf-preprocessing' took: 9002.43346 ms
Code block 'ddf-scaler-fit' took: 10388.68239 ms
Code block 'ddf-scaler-fit' took: 7229.74242 ms
Code block 'ddf-scaler-fit' took: 6550.42175 ms
Code block 'ddf-scaler-fit' took: 6560.37482 ms
Code block 'ddf-scaler-fit' took: 6689.93275 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12306.73773 ms
Code block 'ddf-kmeans-score' took: 6362.73450 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7916.34264 ms
Code block 'ddf-kmeans-score' took: 6378.66829 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7981.27574 ms
Code block 'ddf-kmeans-score' took: 6500.59801 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8019.41814 ms
Code block 'ddf-kmeans-score' took: 6443.14955 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8096.51510 ms
Code block 'ddf-kmeans-score' took: 6502.73364 ms
scores=[array(-293097.21289062)]
client.get_worker_logs()={'tcp://127.0.0.1:35249': (('INFO', "2023-07-04 20:36:40,253 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:36:38,656 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:36:24,752 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:36:23,147 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:36:09,276 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:36:07,721 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:35:53,947 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:35:52,378 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:35:38,555 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:35:32,860 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:33:33,194 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:33:33,194 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37955'), ('INFO', '2023-07-04 20:33:33,175 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:33:33,174 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-91c0ee03-c10b-42cb-bd30-838c4db5ad71'), ('INFO', '2023-07-04 20:33:30,875 - distributed.worker - INFO - Starting Worker plugin PreImport-181b93ef-9aca-4fdb-ba95-437059cefe56'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO - Starting Worker plugin RMMSetup-06de1974-2ff5-41e3-b115-15a613c98bce'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-wtzplu2o'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37955'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37937'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:35249'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:35249')), 'tcp://127.0.0.1:41003': (('INFO', "2023-07-04 20:36:40,253 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:36:38,656 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:36:24,752 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:36:23,147 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:36:09,276 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:36:07,724 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:35:53,946 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:35:52,378 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:35:38,555 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:35:32,860 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:33:39,220 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:33:39,220 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37955'), ('INFO', '2023-07-04 20:33:39,211 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:33:33,174 - distributed.worker - INFO - Starting Worker plugin RMMSetup-d2ce6e68-522d-4c34-be1c-f78c3d0ac2e3'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO - Starting Worker plugin PreImport-c14d9f91-aa2f-4bfa-9106-0c7a4b3b7e40'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-1567e73f-b700-4a8c-a4d6-34a6e49e2646'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-owu5uc54'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37955'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -          dashboard at:            127.0.0.1:41605'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:41003'), ('INFO', '2023-07-04 20:33:29,953 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:41003'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=California.json
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3034406)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol tcp --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 20:37:07,805 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:37:07,807 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:37:07,807 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:37:07,807 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25503.35876 ms
Code block 'ddf-preprocessing' took: 9006.17502 ms
Code block 'ddf-preprocessing' took: 7998.80858 ms
Code block 'ddf-preprocessing' took: 8008.60780 ms
Code block 'ddf-preprocessing' took: 9093.50997 ms
Code block 'ddf-scaler-fit' took: 12520.06202 ms
Code block 'ddf-scaler-fit' took: 8257.06584 ms
Code block 'ddf-scaler-fit' took: 8110.34889 ms
Code block 'ddf-scaler-fit' took: 8329.65572 ms
Code block 'ddf-scaler-fit' took: 8302.81253 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13783.68907 ms
Code block 'ddf-kmeans-score' took: 7808.89160 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9080.66549 ms
Code block 'ddf-kmeans-score' took: 7921.91327 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9395.63805 ms
Code block 'ddf-kmeans-score' took: 8097.68623 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9303.71201 ms
Code block 'ddf-kmeans-score' took: 8292.95770 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9486.60133 ms
Code block 'ddf-kmeans-score' took: 7990.70787 ms
scores=[array(-291769.69921875)]
client.get_worker_logs()={'tcp://127.0.0.1:39055': (('INFO', "2023-07-04 20:40:38,777 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:40:37,307 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:40:20,018 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:40:18,687 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:40:01,641 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:40:00,103 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:39:43,288 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:39:41,825 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:39:25,268 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:39:19,391 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:37:12,861 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:37:12,861 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:38861'), ('INFO', '2023-07-04 20:37:12,827 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:37:10,047 - distributed.worker - INFO - Starting Worker plugin PreImport-1422b57e-b267-4de4-a94f-0b882654bf33'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO - Starting Worker plugin RMMSetup-26e20250-7792-40a1-aa0b-08c22ca30f65'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-fae341dc-1e6c-42f2-abe6-e2ec6fe4c220'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-fh3jdamx'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:38861'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40115'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:39055'), ('INFO', '2023-07-04 20:37:08,783 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:39055')), 'tcp://127.0.0.1:44223': (('INFO', "2023-07-04 20:40:38,777 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:40:37,307 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:40:20,018 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:40:18,687 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:40:01,641 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:40:00,103 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:39:43,288 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:39:41,825 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:39:25,268 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:39:19,391 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:37:19,157 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:37:19,157 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:38861'), ('INFO', '2023-07-04 20:37:19,149 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:37:12,827 - distributed.worker - INFO - Starting Worker plugin RMMSetup-3511a725-3c31-4db8-980c-a963560148a6'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO - Starting Worker plugin PreImport-5bd4f536-ef83-42e3-ac2a-e66c15c07f88'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-778cbd63-45b8-4994-ba7a-ab6dbb5d03f1'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-bxgnj8y0'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:38861'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33181'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:44223'), ('INFO', '2023-07-04 20:37:08,784 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:44223'))}
+ sleep 1
+ for PROTOCOL in tcp ucx
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3039393)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 20:41:09,640 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:41:09,642 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:41:09,642 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:41:09,642 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31351.19369 ms
Code block 'ddf-preprocessing' took: 7652.23898 ms
Code block 'ddf-preprocessing' took: 7652.79524 ms
Code block 'ddf-preprocessing' took: 7759.34638 ms
Code block 'ddf-preprocessing' took: 7898.83281 ms
Code block 'ddf-scaler-fit' took: 12260.16980 ms
Code block 'ddf-scaler-fit' took: 7865.14674 ms
Code block 'ddf-scaler-fit' took: 9559.86275 ms
Code block 'ddf-scaler-fit' took: 8414.35529 ms
Code block 'ddf-scaler-fit' took: 8680.43390 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13580.96258 ms
Code block 'ddf-kmeans-score' took: 8628.32466 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9595.03950 ms
Code block 'ddf-kmeans-score' took: 8532.54618 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9907.78089 ms
Code block 'ddf-kmeans-score' took: 8390.13855 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10419.49757 ms
Code block 'ddf-kmeans-score' took: 8463.89159 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10144.07982 ms
Code block 'ddf-kmeans-score' took: 8431.58827 ms
scores=[array(-306237.05566406)]
client.get_worker_logs()={'ucx://127.0.0.1:40997': (('INFO', "2023-07-04 20:44:42,637 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:44:40,795 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:44:22,902 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:44:21,018 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:44:02,930 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:44:01,359 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:43:43,361 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:43:42,010 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:43:23,986 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:43:18,848 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:41:13,304 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:41:13,304 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:42481'), ('INFO', '2023-07-04 20:41:13,213 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:41:13,213 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-e732836b-e753-4ce3-86f3-7af0b3641949'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - Starting Worker plugin PreImport-9a86b7de-2b85-4da5-a260-88e152c71612'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - Starting Worker plugin RMMSetup-54eed4f9-bf64-4a91-9357-303fde38c025'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-bhta96ik'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:42481'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46803'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:40997'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:40997')), 'ucx://127.0.0.1:43391': (('INFO', "2023-07-04 20:44:42,637 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:44:40,795 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:44:22,902 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:44:21,018 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:44:02,930 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:44:01,359 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:43:43,361 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:43:42,010 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:43:23,986 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:43:18,848 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:41:13,303 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:41:13,303 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:42481'), ('INFO', '2023-07-04 20:41:13,213 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:41:13,213 - distributed.worker - INFO - Starting Worker plugin RMMSetup-4eab3eca-46c3-40f0-8cb1-7bcc91599c69'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - Starting Worker plugin PreImport-ab57cda3-f7a0-4895-9a60-9f6ad92d24c5'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-84b93aef-e236-4323-b85b-2b9981c6aaed'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-mem2gbmu'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:42481'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36077'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:43391'), ('INFO', '2023-07-04 20:41:10,325 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:43391'))}
2023-07-04 20:44:55,798 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-04 20:44:55,800 - distributed.nanny - WARNING - Worker process still alive after 3.19999984741211 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3044348)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 20:45:13,647 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:45:13,648 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:45:13,648 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:45:13,648 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30033.63056 ms
Code block 'ddf-preprocessing' took: 7653.58246 ms
Code block 'ddf-preprocessing' took: 7766.38748 ms
Code block 'ddf-preprocessing' took: 7928.05915 ms
Code block 'ddf-preprocessing' took: 7889.98177 ms
Code block 'ddf-scaler-fit' took: 13984.21171 ms
Code block 'ddf-scaler-fit' took: 9617.64366 ms
Code block 'ddf-scaler-fit' took: 10106.55377 ms
Code block 'ddf-scaler-fit' took: 10348.04044 ms
Code block 'ddf-scaler-fit' took: 10764.16443 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 15485.62662 ms
Code block 'ddf-kmeans-score' took: 10156.01344 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11325.49830 ms
Code block 'ddf-kmeans-score' took: 9929.15054 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11498.40541 ms
Code block 'ddf-kmeans-score' took: 10090.42760 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11526.20554 ms
Code block 'ddf-kmeans-score' took: 10236.13691 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11163.50909 ms
Code block 'ddf-kmeans-score' took: 10208.09074 ms
scores=[array(-733394.16894531)]
client.get_worker_logs()={'ucx://127.0.0.1:42355': (('INFO', "2023-07-04 20:49:07,019 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:49:05,652 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:48:44,488 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:48:42,901 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:48:21,618 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:48:20,099 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:47:58,906 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:47:57,448 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:47:36,288 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:47:30,831 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:45:17,241 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:45:17,241 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:60265'), ('INFO', '2023-07-04 20:45:17,139 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:45:17,139 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-2d15e691-7eea-465f-8bc4-cf0df94a98a0'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO - Starting Worker plugin PreImport-3fd0afc7-f8f0-4f85-b810-cdb6bd5d1471'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO - Starting Worker plugin RMMSetup-0a466ba5-1f66-4c85-8b53-e677f26aebc0'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-cnl5etxs'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:60265'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34947'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:42355'), ('INFO', '2023-07-04 20:45:14,330 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:42355')), 'ucx://127.0.0.1:43827': (('INFO', "2023-07-04 20:49:07,019 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:49:05,652 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:48:44,488 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:48:42,901 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:48:21,617 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:48:20,099 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:47:58,906 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:47:57,448 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:47:36,288 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:47:30,831 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:45:17,242 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:45:17,241 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:60265'), ('INFO', '2023-07-04 20:45:17,139 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO - Starting Worker plugin PreImport-b808db60-34af-4058-8e7e-9e04901d0ba7'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-98bada1e-3202-46c9-aa66-4f774876745c'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO - Starting Worker plugin RMMSetup-a08fd3fc-0584-4cf2-906f-c9b8ab034686'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-hnhytgo5'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:60265'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO -          dashboard at:            127.0.0.1:41959'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:43827'), ('INFO', '2023-07-04 20:45:14,331 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:43827'))}
2023-07-04 20:49:21,885 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-04 20:49:21,886 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3050000)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 20:49:39,545 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:49:39,546 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:49:39,546 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:49:39,546 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30287.75943 ms
Code block 'ddf-preprocessing' took: 8020.80218 ms
Code block 'ddf-preprocessing' took: 8119.43851 ms
Code block 'ddf-preprocessing' took: 8007.84551 ms
Code block 'ddf-preprocessing' took: 9010.99924 ms
Code block 'ddf-scaler-fit' took: 11786.75970 ms
Code block 'ddf-scaler-fit' took: 7711.08113 ms
Code block 'ddf-scaler-fit' took: 7097.20986 ms
Code block 'ddf-scaler-fit' took: 7253.29554 ms
Code block 'ddf-scaler-fit' took: 7449.06520 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12551.72112 ms
Code block 'ddf-kmeans-score' took: 7376.40364 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8810.64579 ms
Code block 'ddf-kmeans-score' took: 7439.25309 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8675.55046 ms
Code block 'ddf-kmeans-score' took: 7372.53034 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10894.55131 ms
Code block 'ddf-kmeans-score' took: 7352.56322 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9124.90687 ms
Code block 'ddf-kmeans-score' took: 7331.04325 ms
scores=[array(-186952.82421875)]
client.get_worker_logs()={'ucx://127.0.0.1:40845': (('INFO', "2023-07-04 20:52:59,498 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:57,578 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:52:41,957 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:40,582 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:52:22,630 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:21,059 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:52:05,449 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:03,802 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:51:48,033 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:51:42,788 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:49:43,301 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:49:43,301 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:37563'), ('INFO', '2023-07-04 20:49:43,212 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:49:43,212 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-ad77a072-3dae-4624-b34e-c58528050f8f'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO - Starting Worker plugin PreImport-e3cd07d3-5fd2-43fb-8330-e38e0525b07f'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO - Starting Worker plugin RMMSetup-e8c17392-976b-4a42-a27f-4f42b82f906a'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-ui2wkt3z'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:37563'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34127'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:40845'), ('INFO', '2023-07-04 20:49:40,227 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:40845')), 'ucx://127.0.0.1:49821': (('INFO', "2023-07-04 20:52:59,498 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:57,578 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:52:41,957 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:40,582 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:52:22,630 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:21,059 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:52:05,449 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:52:03,802 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:51:48,033 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:51:42,788 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:49:43,300 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:49:43,300 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:37563'), ('INFO', '2023-07-04 20:49:43,212 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO - Starting Worker plugin PreImport-c3342d31-367e-4129-acfc-ec99b410d36d'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-780965a3-d64e-4ebe-9d2d-cdff8db21c36'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO - Starting Worker plugin RMMSetup-3f592c76-37ea-4980-9336-af7dfaff0ec8'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-mxbl9vo9'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:37563'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33197'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:49821'), ('INFO', '2023-07-04 20:49:40,228 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:49821'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3054562)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 20:53:29,481 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:53:29,482 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:53:29,482 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:53:29,482 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30165.33329 ms
Code block 'ddf-preprocessing' took: 8040.06742 ms
Code block 'ddf-preprocessing' took: 8130.97888 ms
Code block 'ddf-preprocessing' took: 8052.76285 ms
Code block 'ddf-preprocessing' took: 8035.04279 ms
Code block 'ddf-scaler-fit' took: 13242.61367 ms
Code block 'ddf-scaler-fit' took: 8679.90869 ms
Code block 'ddf-scaler-fit' took: 9541.03615 ms
Code block 'ddf-scaler-fit' took: 8831.68332 ms
Code block 'ddf-scaler-fit' took: 9013.35038 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 14805.81711 ms
Code block 'ddf-kmeans-score' took: 8807.96371 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10403.85410 ms
Code block 'ddf-kmeans-score' took: 8699.79663 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10892.04702 ms
Code block 'ddf-kmeans-score' took: 8710.37911 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11274.21559 ms
Code block 'ddf-kmeans-score' took: 8992.08904 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10243.37487 ms
Code block 'ddf-kmeans-score' took: 8663.07743 ms
scores=[array(-293705.88476562)]
client.get_worker_logs()={'ucx://127.0.0.1:50839': (('INFO', "2023-07-04 20:57:09,415 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:57:07,628 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:56:49,101 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:56:46,509 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:56:27,990 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:56:25,935 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:56:07,314 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:56:05,801 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:55:46,854 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:55:40,602 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:53:32,958 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:53:32,958 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:42499'), ('INFO', '2023-07-04 20:53:32,871 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:53:32,871 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-9351e8c3-c75a-4694-9ae4-6ef8b37cd926'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - Starting Worker plugin PreImport-0af1639a-ce0f-4a0b-a97a-00037f46b467'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - Starting Worker plugin RMMSetup-98694b83-8d93-4997-bce6-23c10712455b'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-l8t1nky2'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:42499'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -          dashboard at:            127.0.0.1:39187'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:50839'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:50839')), 'ucx://127.0.0.1:55863': (('INFO', "2023-07-04 20:57:09,415 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:57:07,628 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:56:49,101 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:56:46,509 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:56:27,990 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:56:25,935 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:56:07,314 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:56:05,800 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:55:46,854 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:55:40,602 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:53:32,957 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:53:32,957 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:42499'), ('INFO', '2023-07-04 20:53:32,871 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:53:32,871 - distributed.worker - INFO - Starting Worker plugin RMMSetup-97a316de-64dd-4c47-bc3f-ffe001175c1d'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - Starting Worker plugin PreImport-eb680de8-89aa-44a3-8efd-8519a3f04812'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-14663303-48f8-49e4-95da-da518ed636f7'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-jd54h96q'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:42499'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35525'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:55863'), ('INFO', '2023-07-04 20:53:30,162 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:55863'))}
+ sleep 1
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3059942)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 20:57:39,037 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:57:39,038 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 20:57:39,038 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 20:57:39,038 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30114.34376 ms
Code block 'ddf-preprocessing' took: 7642.89071 ms
Code block 'ddf-preprocessing' took: 7673.70933 ms
Code block 'ddf-preprocessing' took: 7652.54151 ms
Code block 'ddf-preprocessing' took: 7654.21987 ms
Code block 'ddf-scaler-fit' took: 11701.10562 ms
Code block 'ddf-scaler-fit' took: 6941.58989 ms
Code block 'ddf-scaler-fit' took: 7452.57423 ms
Code block 'ddf-scaler-fit' took: 7408.43277 ms
Code block 'ddf-scaler-fit' took: 7708.26445 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12476.79721 ms
Code block 'ddf-kmeans-score' took: 6771.88858 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8596.98470 ms
Code block 'ddf-kmeans-score' took: 6819.70257 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8338.83090 ms
Code block 'ddf-kmeans-score' took: 6766.40751 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7966.29122 ms
Code block 'ddf-kmeans-score' took: 6825.70239 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8304.15797 ms
Code block 'ddf-kmeans-score' took: 6824.66468 ms
scores=[array(-274764.57470703)]
client.get_worker_logs()={'ucx://127.0.0.1:55251': (('INFO', "2023-07-04 21:00:49,204 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:00:47,488 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:00:32,996 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:00:31,609 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:00:17,170 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:00:15,490 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:00:00,909 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:59:59,217 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:59:44,419 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:59:38,777 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:57:42,871 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:57:42,871 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:53433'), ('INFO', '2023-07-04 20:57:42,786 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:57:40,342 - distributed.worker - INFO - Starting Worker plugin PreImport-be19cc85-21f5-4ae4-82f3-9f008c182e8a'), ('INFO', '2023-07-04 20:57:40,342 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-8bfb1e36-5565-4e7f-b6bd-22ab90db9d3d'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO - Starting Worker plugin RMMSetup-5e18b770-6caf-42c0-8cbf-73c5dd73aa26'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-5nlvcbgt'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:53433'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35881'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:55251'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:55251')), 'ucx://127.0.0.1:60487': (('INFO', "2023-07-04 21:00:49,204 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:00:47,488 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:00:32,996 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:00:31,610 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:00:17,170 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:00:15,490 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:00:00,909 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:59:59,217 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 20:59:44,419 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 20:59:38,777 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 20:57:42,870 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:57:42,870 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:53433'), ('INFO', '2023-07-04 20:57:42,786 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:57:42,786 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-44748473-39a2-4f28-ae41-40f6d8ef8191'), ('INFO', '2023-07-04 20:57:40,342 - distributed.worker - INFO - Starting Worker plugin PreImport-6c0be68b-17bb-4e7e-89b5-f47a55c958c5'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO - Starting Worker plugin RMMSetup-32db44d8-2f28-4831-9120-000a4f9c55ec'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-g5dhu04n'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:53433'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44291'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:60487'), ('INFO', '2023-07-04 20:57:39,724 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:60487'))}
2023-07-04 21:01:00,869 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
2023-07-04 21:01:00,870 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3064601)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 21:01:19,305 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:01:19,306 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:01:19,306 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:01:19,306 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25835.26487 ms
Code block 'ddf-preprocessing' took: 7651.88924 ms
Code block 'ddf-preprocessing' took: 7752.11266 ms
Code block 'ddf-preprocessing' took: 7663.51283 ms
Code block 'ddf-preprocessing' took: 7648.19848 ms
Code block 'ddf-scaler-fit' took: 12732.83950 ms
Code block 'ddf-scaler-fit' took: 8565.44953 ms
Code block 'ddf-scaler-fit' took: 8864.96126 ms
Code block 'ddf-scaler-fit' took: 8768.94487 ms
Code block 'ddf-scaler-fit' took: 9151.75512 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13681.87825 ms
Code block 'ddf-kmeans-score' took: 8135.90537 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9831.83647 ms
Code block 'ddf-kmeans-score' took: 8181.46026 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10445.13514 ms
Code block 'ddf-kmeans-score' took: 8436.00117 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9552.93664 ms
Code block 'ddf-kmeans-score' took: 8328.88047 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9661.91068 ms
Code block 'ddf-kmeans-score' took: 8526.56191 ms
scores=[array(-216180.88720703)]
client.get_worker_logs()={'ucx://127.0.0.1:34303': (('INFO', "2023-07-04 21:04:54,195 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:04:52,627 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:04:35,123 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:04:33,754 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:04:16,045 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:04:13,788 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:03:55,983 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:03:54,299 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:03:36,994 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:03:31,546 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:01:24,531 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:01:24,531 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:34515'), ('INFO', '2023-07-04 21:01:24,438 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:01:24,438 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-6b22dc5a-9c4f-4a37-8a6d-058671b820de'), ('INFO', '2023-07-04 21:01:21,498 - distributed.worker - INFO - Starting Worker plugin PreImport-76f2cfa6-3dd7-4686-86c3-e74b1b665214'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO - Starting Worker plugin RMMSetup-5e8af5be-f7f1-4277-9579-8711bbcf45fd'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-cjt3v8ob'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:34515'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33477'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:34303'), ('INFO', '2023-07-04 21:01:20,004 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:34303')), 'ucx://127.0.0.1:48591': (('INFO', "2023-07-04 21:04:54,195 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:04:52,627 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:04:35,123 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:04:33,754 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:04:16,045 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:04:13,788 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:03:55,983 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:03:54,299 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:03:36,994 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:03:31,544 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:01:30,738 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:01:30,738 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:34515'), ('INFO', '2023-07-04 21:01:30,700 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:01:30,700 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-78aff7bb-9655-4789-937a-d139c4980448'), ('INFO', '2023-07-04 21:01:24,438 - distributed.worker - INFO - Starting Worker plugin RMMSetup-c231b742-310d-4ca8-8407-605029919819'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO - Starting Worker plugin PreImport-730c7b08-a08e-46a3-8fff-34aa2c403be6'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-7dxnkd8m'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:34515'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45783'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:48591'), ('INFO', '2023-07-04 21:01:20,005 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:48591'))}
2023-07-04 21:05:07,531 - distributed.nanny - WARNING - Worker process still alive after 3.1999989318847657 seconds, killing
2023-07-04 21:05:07,532 - distributed.nanny - WARNING - Worker process still alive after 3.19999984741211 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3070180)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 21:05:26,726 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:05:26,727 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:05:26,727 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:05:26,727 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25716.90805 ms
Code block 'ddf-preprocessing' took: 8077.59297 ms
Code block 'ddf-preprocessing' took: 8058.43193 ms
Code block 'ddf-preprocessing' took: 8008.55832 ms
Code block 'ddf-preprocessing' took: 7989.12947 ms
Code block 'ddf-scaler-fit' took: 10545.88259 ms
Code block 'ddf-scaler-fit' took: 7197.28986 ms
Code block 'ddf-scaler-fit' took: 6607.43070 ms
Code block 'ddf-scaler-fit' took: 6627.09096 ms
Code block 'ddf-scaler-fit' took: 6796.44713 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11921.01330 ms
Code block 'ddf-kmeans-score' took: 6398.45914 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7586.58955 ms
Code block 'ddf-kmeans-score' took: 6454.48256 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7850.30833 ms
Code block 'ddf-kmeans-score' took: 6411.32858 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7862.92492 ms
Code block 'ddf-kmeans-score' took: 6482.14920 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7855.56120 ms
Code block 'ddf-kmeans-score' took: 6378.16739 ms
scores=[array(-186981.67480469)]
client.get_worker_logs()={'ucx://127.0.0.1:45353': (('INFO', "2023-07-04 21:08:33,722 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:08:32,161 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:08:18,266 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:08:16,729 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:08:02,949 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:08:01,478 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:07:47,580 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:07:46,331 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:07:32,408 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:07:26,912 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:05:31,262 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:05:31,262 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:51981'), ('INFO', '2023-07-04 21:05:31,171 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:05:28,391 - distributed.worker - INFO - Starting Worker plugin PreImport-3a5edc2e-9da2-45b4-93c4-c0b098b5b9cf'), ('INFO', '2023-07-04 21:05:28,391 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-afd80539-658c-4c54-b69d-ca0a1a4c6dc7'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO - Starting Worker plugin RMMSetup-b64c9239-77cd-4919-a235-eba2c5341a76'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-ijseplc7'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:51981'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45737'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:45353'), ('INFO', '2023-07-04 21:05:27,442 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:45353')), 'ucx://127.0.0.1:50433': (('INFO', "2023-07-04 21:08:33,722 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:08:32,161 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:08:18,266 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:08:16,729 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:08:02,949 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:08:01,478 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:07:47,580 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:07:46,330 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:07:32,408 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:07:26,912 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:05:37,098 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:05:37,098 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:51981'), ('INFO', '2023-07-04 21:05:37,060 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:05:31,171 - distributed.worker - INFO - Starting Worker plugin RMMSetup-9a011200-28fa-4067-819d-ea8866a5d8c5'), ('INFO', '2023-07-04 21:05:31,170 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-68357c2d-522d-43c1-84ff-061ade942e5e'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO - Starting Worker plugin PreImport-21fd9704-4b0f-4817-8cce-6eed8d6735ad'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-matzchul'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:51981'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO -          dashboard at:            127.0.0.1:42985'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:50433'), ('INFO', '2023-07-04 21:05:27,440 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:50433'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3074520)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 21:09:01,831 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:09:01,833 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:09:01,833 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:09:01,833 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25016.08425 ms
Code block 'ddf-preprocessing' took: 8022.28869 ms
Code block 'ddf-preprocessing' took: 8024.51365 ms
Code block 'ddf-preprocessing' took: 8109.02645 ms
Code block 'ddf-preprocessing' took: 8059.00714 ms
Code block 'ddf-scaler-fit' took: 11625.07886 ms
Code block 'ddf-scaler-fit' took: 8234.46417 ms
Code block 'ddf-scaler-fit' took: 8153.51570 ms
Code block 'ddf-scaler-fit' took: 8435.16553 ms
Code block 'ddf-scaler-fit' took: 8375.70250 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13806.88199 ms
Code block 'ddf-kmeans-score' took: 8072.27666 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9268.44510 ms
Code block 'ddf-kmeans-score' took: 8040.77209 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9394.35479 ms
Code block 'ddf-kmeans-score' took: 8727.09931 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9414.44656 ms
Code block 'ddf-kmeans-score' took: 7974.17536 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9692.73981 ms
Code block 'ddf-kmeans-score' took: 8032.75846 ms
scores=[array(-294357.6953125)]
client.get_worker_logs()={'ucx://127.0.0.1:35821': (('INFO', "2023-07-04 21:12:30,505 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:12:28,514 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:12:11,759 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:12:10,183 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:11:52,558 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:11:51,214 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:11:34,032 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:11:32,488 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:11:15,480 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:11:09,891 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:09:12,084 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:09:12,084 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:48199'), ('INFO', '2023-07-04 21:09:12,046 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:09:06,096 - distributed.worker - INFO - Starting Worker plugin RMMSetup-50ee0c36-d151-499c-832a-834d164f4796'), ('INFO', '2023-07-04 21:09:06,096 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-e4e5fc3b-4213-4a45-a8a6-8ea4861a6b39'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO - Starting Worker plugin PreImport-c09b5f21-351f-49ec-828b-ab5a2ed2d093'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-l3a49o4b'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:48199'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45323'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:35821'), ('INFO', '2023-07-04 21:09:02,532 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:35821')), 'ucx://127.0.0.1:46839': (('INFO', "2023-07-04 21:12:30,505 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:12:28,514 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:12:11,759 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:12:10,183 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:11:52,558 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:11:51,214 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:11:34,032 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:11:32,488 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:11:15,480 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:11:09,891 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:09:06,208 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:09:06,208 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:48199'), ('INFO', '2023-07-04 21:09:06,096 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:09:03,880 - distributed.worker - INFO - Starting Worker plugin PreImport-b8bd63af-5043-41b0-a4c0-cbdfe60091b1'), ('INFO', '2023-07-04 21:09:03,879 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-7c3a0c9a-ead4-4a59-b9e7-00b621fae669'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO - Starting Worker plugin RMMSetup-e03f99fb-6328-4d48-adbf-57a203d28c44'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-jc1qzgvc'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:48199'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43845'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:46839'), ('INFO', '2023-07-04 21:09:02,533 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:46839'))}
+ sleep 1
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3079656)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 21:13:02,834 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:13:02,835 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:13:02,836 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:13:02,836 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31288.22086 ms
Code block 'ddf-preprocessing' took: 7655.12468 ms
Code block 'ddf-preprocessing' took: 8048.36248 ms
Code block 'ddf-preprocessing' took: 7914.98537 ms
Code block 'ddf-preprocessing' took: 7642.54340 ms
Code block 'ddf-scaler-fit' took: 12125.72312 ms
Code block 'ddf-scaler-fit' took: 7913.17202 ms
Code block 'ddf-scaler-fit' took: 8292.28367 ms
Code block 'ddf-scaler-fit' took: 8519.29754 ms
Code block 'ddf-scaler-fit' took: 8809.47297 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13961.15585 ms
Code block 'ddf-kmeans-score' took: 8471.94726 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9689.11790 ms
Code block 'ddf-kmeans-score' took: 8632.39722 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9541.88610 ms
Code block 'ddf-kmeans-score' took: 8561.58598 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10162.89472 ms
Code block 'ddf-kmeans-score' took: 8528.61910 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9964.60549 ms
Code block 'ddf-kmeans-score' took: 8433.50883 ms
scores=[array(-355991.61767578)]
client.get_worker_logs()={'ucx://127.0.0.1:44223': (('INFO', "2023-07-04 21:16:35,028 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:16:33,374 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:16:15,416 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:16:13,724 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:15:55,571 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:15:54,222 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:15:36,265 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:15:34,730 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:15:16,812 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:15:11,447 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:13:06,785 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:13:06,785 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:39259'), ('INFO', '2023-07-04 21:13:06,696 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:13:06,696 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-e92d8f5f-3367-4cf6-b443-479c41bda234'), ('INFO', '2023-07-04 21:13:06,696 - distributed.worker - INFO - Starting Worker plugin RMMSetup-1e9b23b3-35cd-4d6d-8841-4ef35789723d'), ('INFO', '2023-07-04 21:13:03,497 - distributed.worker - INFO - Starting Worker plugin PreImport-e156b3d9-8911-4ced-80a9-b0a4111bf2cb'), ('INFO', '2023-07-04 21:13:03,497 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-e57a9bz0'), ('INFO', '2023-07-04 21:13:03,497 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:13:03,497 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:13:03,497 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:39259'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36291'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:44223'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:44223')), 'ucx://127.0.0.1:55973': (('INFO', "2023-07-04 21:16:35,028 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:16:33,374 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:16:15,416 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:16:13,724 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:15:55,571 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:15:54,222 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:15:36,265 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:15:34,731 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:15:16,812 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:15:11,446 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:13:06,785 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:13:06,784 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:39259'), ('INFO', '2023-07-04 21:13:06,696 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO - Starting Worker plugin PreImport-aeee7e8a-094a-40b1-9aaf-6031dfc10c4b'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-13966964-f58c-44b0-8d8e-bf10e5d3bca6'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO - Starting Worker plugin RMMSetup-c308d00e-1759-46c6-b33b-1d281f7a59f3'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-b5wuewej'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:39259'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -          dashboard at:            127.0.0.1:41059'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:55973'), ('INFO', '2023-07-04 21:13:03,496 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:55973'))}
2023-07-04 21:16:48,415 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-04 21:16:48,417 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3085036)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 21:17:06,592 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:17:06,593 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:17:06,593 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:17:06,593 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31161.21230 ms
Code block 'ddf-preprocessing' took: 7633.78735 ms
Code block 'ddf-preprocessing' took: 7754.82561 ms
Code block 'ddf-preprocessing' took: 7631.96662 ms
Code block 'ddf-preprocessing' took: 7631.51729 ms
Code block 'ddf-scaler-fit' took: 13966.35708 ms
Code block 'ddf-scaler-fit' took: 9325.53658 ms
Code block 'ddf-scaler-fit' took: 9700.15169 ms
Code block 'ddf-scaler-fit' took: 10140.15351 ms
Code block 'ddf-scaler-fit' took: 10395.10955 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 15279.84749 ms
Code block 'ddf-kmeans-score' took: 10143.14156 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11933.26224 ms
Code block 'ddf-kmeans-score' took: 9933.86064 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11920.71965 ms
Code block 'ddf-kmeans-score' took: 9914.90954 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11612.35901 ms
Code block 'ddf-kmeans-score' took: 10032.47708 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11228.70867 ms
Code block 'ddf-kmeans-score' took: 10236.34295 ms
scores=[array(-217612.94799805)]
client.get_worker_logs()={'ucx://127.0.0.1:33807': (('INFO', "2023-07-04 21:20:59,692 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:20:58,126 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:20:37,314 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:20:35,641 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:20:14,675 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:20:12,864 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:19:51,680 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:19:49,693 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:19:28,451 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:19:23,109 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:17:10,030 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:17:10,030 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:54393'), ('INFO', '2023-07-04 21:17:09,945 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:17:09,945 - distributed.worker - INFO - Starting Worker plugin RMMSetup-d850912c-c1c1-4ae0-a141-b8f9bb23560b'), ('INFO', '2023-07-04 21:17:09,945 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-1217769e-e723-462a-8814-84b5f3fe493f'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO - Starting Worker plugin PreImport-d1a906b0-8c2e-4dfc-bdb3-760243c23284'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-glh6k07v'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:54393'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34547'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:33807'), ('INFO', '2023-07-04 21:17:07,257 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:33807')), 'ucx://127.0.0.1:40317': (('INFO', "2023-07-04 21:20:59,692 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:20:58,126 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:20:37,314 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:20:35,641 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:20:14,675 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:20:12,863 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:19:51,680 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:19:49,693 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:19:28,451 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:19:23,109 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:17:10,031 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:17:10,031 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:54393'), ('INFO', '2023-07-04 21:17:09,945 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO - Starting Worker plugin PreImport-82400b8b-97e0-48bc-bf9e-9110610d8e06'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-0f91ca33-b0f8-43b6-ba5e-bd1897a2e5d1'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO - Starting Worker plugin RMMSetup-15f1c01c-3db4-4fa6-8ce7-9fa7340f99ee'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-g8qedgby'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:54393'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO -          dashboard at:            127.0.0.1:42753'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:40317'), ('INFO', '2023-07-04 21:17:07,258 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:40317'))}
2023-07-04 21:21:14,583 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-04 21:21:14,584 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3090400)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 21:21:31,657 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:21:31,658 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:21:31,659 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:21:31,659 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30988.20977 ms
Code block 'ddf-preprocessing' took: 8117.98353 ms
Code block 'ddf-preprocessing' took: 8023.32264 ms
Code block 'ddf-preprocessing' took: 8032.28830 ms
Code block 'ddf-preprocessing' took: 8035.57111 ms
Code block 'ddf-scaler-fit' took: 11707.20077 ms
Code block 'ddf-scaler-fit' took: 7016.01320 ms
Code block 'ddf-scaler-fit' took: 7091.97056 ms
Code block 'ddf-scaler-fit' took: 7176.58095 ms
Code block 'ddf-scaler-fit' took: 7404.85449 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12875.97948 ms
Code block 'ddf-kmeans-score' took: 7234.16391 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8694.61290 ms
Code block 'ddf-kmeans-score' took: 7417.74323 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8780.39053 ms
Code block 'ddf-kmeans-score' took: 7331.44233 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8652.21486 ms
Code block 'ddf-kmeans-score' took: 7275.92451 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8754.88845 ms
Code block 'ddf-kmeans-score' took: 7351.10795 ms
scores=[array(-186979.32226562)]
client.get_worker_logs()={'ucx://127.0.0.1:53377': (('INFO', "2023-07-04 21:24:47,503 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:24:45,806 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:24:30,395 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:24:29,004 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:24:13,341 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:24:11,766 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:23:56,068 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:23:54,508 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:23:38,911 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:23:33,299 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:21:35,156 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:21:35,156 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:60251'), ('INFO', '2023-07-04 21:21:35,070 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:21:35,070 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-98da23dd-bd01-47bd-b448-f4be8c1f97dd'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO - Starting Worker plugin PreImport-9dff5c32-0e8f-44f2-a0d9-f0b82e1a6838'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO - Starting Worker plugin RMMSetup-700aaada-3b79-4e40-801b-056ea726fba6'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-23_svnzr'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:60251'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33055'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:53377'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:53377')), 'ucx://127.0.0.1:53481': (('INFO', "2023-07-04 21:24:47,503 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:24:45,806 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:24:30,395 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:24:29,004 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:24:13,341 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:24:11,766 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:23:56,068 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:23:54,508 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:23:38,911 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:23:33,299 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:21:35,155 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:21:35,155 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:60251'), ('INFO', '2023-07-04 21:21:35,070 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO - Starting Worker plugin PreImport-aaae9ad9-9be4-436b-a6d2-4879c8023453'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-b4a575d9-3117-493b-bf8c-6467cee4fda8'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO - Starting Worker plugin RMMSetup-243ee786-fd09-4c19-b43a-7e0ed6728ecf'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-7qaefr4g'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:60251'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44083'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:21:32,324 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:53481'), ('INFO', '2023-07-04 21:21:32,323 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:53481'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3094827)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 21:25:16,682 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:25:16,683 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:25:16,683 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:25:16,683 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30837.27082 ms
Code block 'ddf-preprocessing' took: 8013.93773 ms
Code block 'ddf-preprocessing' took: 8098.11736 ms
Code block 'ddf-preprocessing' took: 8020.24065 ms
Code block 'ddf-preprocessing' took: 8016.25780 ms
Code block 'ddf-scaler-fit' took: 13318.68286 ms
Code block 'ddf-scaler-fit' took: 8621.99306 ms
Code block 'ddf-scaler-fit' took: 8762.30711 ms
Code block 'ddf-scaler-fit' took: 8723.70582 ms
Code block 'ddf-scaler-fit' took: 8862.16947 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 14289.49097 ms
Code block 'ddf-kmeans-score' took: 8441.36469 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10470.29525 ms
Code block 'ddf-kmeans-score' took: 8903.08346 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9878.42869 ms
Code block 'ddf-kmeans-score' took: 8630.62127 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10549.11905 ms
Code block 'ddf-kmeans-score' took: 8684.34682 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10480.21310 ms
Code block 'ddf-kmeans-score' took: 9020.62089 ms
scores=[array(-186976.97851562)]
client.get_worker_logs()={'ucx://127.0.0.1:39211': (('INFO', "2023-07-04 21:28:53,989 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:28:52,406 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:28:33,748 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:28:32,013 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:28:13,493 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:28:12,108 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:27:53,634 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:27:52,040 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:27:33,478 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:27:28,069 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:25:20,469 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:25:20,469 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:38371'), ('INFO', '2023-07-04 21:25:20,382 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - Starting Worker plugin PreImport-dceea2e5-c690-4af7-bfd4-ed8ac125d053'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-a9556f18-8590-425d-9160-5c5359df3f79'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - Starting Worker plugin RMMSetup-352360ef-4553-493d-a608-1b0942da4e8b'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-texj97hn'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:38371'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -          dashboard at:            127.0.0.1:41343'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:39211'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:39211')), 'ucx://127.0.0.1:44555': (('INFO', "2023-07-04 21:28:53,989 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:28:52,407 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:28:33,748 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:28:32,013 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:28:13,493 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:28:12,108 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:27:53,634 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:27:52,040 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:27:33,477 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:27:28,069 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:25:20,468 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:25:20,468 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:38371'), ('INFO', '2023-07-04 21:25:20,382 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:25:20,382 - distributed.worker - INFO - Starting Worker plugin RMMSetup-1e30bf71-c010-446f-b778-887cbd6aac05'), ('INFO', '2023-07-04 21:25:20,382 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-aeedcfa5-0186-44ee-8043-108a4d0417d2'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - Starting Worker plugin PreImport-25350228-bec3-41e4-98bc-65b266e49ae6'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-jgk1ocim'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:38371'), ('INFO', '2023-07-04 21:25:17,347 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35845'), ('INFO', '2023-07-04 21:25:17,346 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:25:17,346 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:44555'), ('INFO', '2023-07-04 21:25:17,346 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:44555'))}
+ sleep 1
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3100072)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 21:29:24,617 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:29:24,618 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:29:24,618 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:29:24,618 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 29980.58228 ms
Code block 'ddf-preprocessing' took: 7740.02088 ms
Code block 'ddf-preprocessing' took: 7630.86350 ms
Code block 'ddf-preprocessing' took: 7632.70364 ms
Code block 'ddf-preprocessing' took: 7626.31957 ms
Code block 'ddf-scaler-fit' took: 11476.60484 ms
Code block 'ddf-scaler-fit' took: 7021.40447 ms
Code block 'ddf-scaler-fit' took: 7464.29352 ms
Code block 'ddf-scaler-fit' took: 7343.75571 ms
Code block 'ddf-scaler-fit' took: 7677.62248 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12256.60802 ms
Code block 'ddf-kmeans-score' took: 6833.04190 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8280.08412 ms
Code block 'ddf-kmeans-score' took: 6775.97904 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8451.73313 ms
Code block 'ddf-kmeans-score' took: 6889.73965 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8156.38045 ms
Code block 'ddf-kmeans-score' took: 6923.61821 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8491.04159 ms
Code block 'ddf-kmeans-score' took: 7040.77035 ms
scores=[array(-318913.78613281)]
client.get_worker_logs()={'ucx://127.0.0.1:45857': (('INFO', "2023-07-04 21:32:35,441 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:32:33,875 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:32:18,960 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:32:17,401 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:32:02,841 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:32:01,050 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:31:46,355 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:31:44,755 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:31:30,151 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:31:24,727 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:29:28,620 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:29:28,620 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35869'), ('INFO', '2023-07-04 21:29:28,524 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:29:25,715 - distributed.worker - INFO - Starting Worker plugin PreImport-44d2e398-0d29-430d-b6c6-4353f391ced1'), ('INFO', '2023-07-04 21:29:25,715 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-7c7f352d-2e25-4d08-8324-b7282c89a525'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO - Starting Worker plugin RMMSetup-98a24382-822f-4180-88ad-fdfefab6faa1'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-lyfaw8ep'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35869'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36617'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:45857'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:45857')), 'ucx://127.0.0.1:50365': (('INFO', "2023-07-04 21:32:35,442 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:32:33,875 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:32:18,960 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:32:17,402 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:32:02,841 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:32:01,050 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:31:46,355 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:31:44,755 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:31:30,151 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:31:24,727 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:29:28,620 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:29:28,619 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35869'), ('INFO', '2023-07-04 21:29:28,525 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:29:28,524 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-26af4c3f-ecae-47b6-87d7-a073d6680a17'), ('INFO', '2023-07-04 21:29:25,751 - distributed.worker - INFO - Starting Worker plugin PreImport-0940bfd4-98c3-4586-9dfb-11d943b396ee'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO - Starting Worker plugin RMMSetup-95c0ecf1-2946-48f3-80a8-b574be1b3921'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-mxbooviu'), ('INFO', '2023-07-04 21:29:25,285 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:29:25,284 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:29:25,284 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:29:25,284 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35869'), ('INFO', '2023-07-04 21:29:25,284 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43921'), ('INFO', '2023-07-04 21:29:25,284 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:29:25,284 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:50365'), ('INFO', '2023-07-04 21:29:25,284 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:50365'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3104350)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 21:33:03,634 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:33:03,636 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:33:03,636 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:33:03,636 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 29403.07873 ms
Code block 'ddf-preprocessing' took: 7905.87304 ms
Code block 'ddf-preprocessing' took: 7685.16592 ms
Code block 'ddf-preprocessing' took: 7764.00060 ms
Code block 'ddf-preprocessing' took: 7649.33578 ms
Code block 'ddf-scaler-fit' took: 13035.37350 ms
Code block 'ddf-scaler-fit' took: 8556.43779 ms
Code block 'ddf-scaler-fit' took: 8917.59844 ms
Code block 'ddf-scaler-fit' took: 9003.41499 ms
Code block 'ddf-scaler-fit' took: 9277.13047 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13794.36324 ms
Code block 'ddf-kmeans-score' took: 8282.71616 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9733.67627 ms
Code block 'ddf-kmeans-score' took: 8429.91914 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10014.33672 ms
Code block 'ddf-kmeans-score' took: 8281.41076 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9666.70817 ms
Code block 'ddf-kmeans-score' took: 8355.49844 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9938.36822 ms
Code block 'ddf-kmeans-score' took: 8502.61411 ms
scores=[array(-382891.30078125)]
client.get_worker_logs()={'ucx://127.0.0.1:43755': (('INFO', "2023-07-04 21:36:34,605 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:36:32,811 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:36:15,111 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:36:13,528 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:35:56,036 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:35:54,237 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:35:36,543 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:35:34,957 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:35:17,435 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:35:12,098 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:33:07,289 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:33:07,289 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:42501'), ('INFO', '2023-07-04 21:33:07,204 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:33:07,204 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-61c804b4-58a2-45af-9da2-26917d80135e'), ('INFO', '2023-07-04 21:33:04,636 - distributed.worker - INFO - Starting Worker plugin PreImport-24a25861-0b0f-4180-8777-ece12f67bfa8'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO - Starting Worker plugin RMMSetup-9d41c811-0716-4a82-899a-649a12cf7799'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-p3f81ejy'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:42501'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -          dashboard at:            127.0.0.1:39657'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:43755'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:43755')), 'ucx://127.0.0.1:53779': (('INFO', "2023-07-04 21:36:34,605 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:36:32,811 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:36:15,111 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:36:13,528 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:35:56,036 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:35:54,237 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:35:36,543 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:35:34,957 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:35:17,435 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:35:12,098 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:33:07,289 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:33:07,289 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:42501'), ('INFO', '2023-07-04 21:33:07,204 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:33:04,636 - distributed.worker - INFO - Starting Worker plugin PreImport-74ecbea3-6f17-44c4-84d6-685b87095a5c'), ('INFO', '2023-07-04 21:33:04,636 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-30c644e8-bb7e-46e1-8813-ed4f6cd05bdc'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO - Starting Worker plugin RMMSetup-4a8b4ee5-5a31-4be6-a582-57346c81ee37'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-z9xx77b4'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:42501'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37625'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:53779'), ('INFO', '2023-07-04 21:33:04,301 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:53779'))}
2023-07-04 21:36:47,783 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-04 21:36:47,785 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3109597)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 21:37:05,865 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:37:05,866 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:37:05,866 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:37:05,866 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25293.94968 ms
Code block 'ddf-preprocessing' took: 8136.01818 ms
Code block 'ddf-preprocessing' took: 8008.10587 ms
Code block 'ddf-preprocessing' took: 9015.98257 ms
Code block 'ddf-preprocessing' took: 8006.89956 ms
Code block 'ddf-scaler-fit' took: 10602.06247 ms
Code block 'ddf-scaler-fit' took: 6559.59926 ms
Code block 'ddf-scaler-fit' took: 6611.20741 ms
Code block 'ddf-scaler-fit' took: 6614.96952 ms
Code block 'ddf-scaler-fit' took: 6714.23684 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11998.30059 ms
Code block 'ddf-kmeans-score' took: 6375.05195 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7856.70063 ms
Code block 'ddf-kmeans-score' took: 6431.89926 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7920.43547 ms
Code block 'ddf-kmeans-score' took: 6414.56961 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7677.44895 ms
Code block 'ddf-kmeans-score' took: 6478.17313 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7923.49339 ms
Code block 'ddf-kmeans-score' took: 6371.06319 ms
scores=[array(-225683.96191406)]
client.get_worker_logs()={'ucx://127.0.0.1:35573': (('INFO', "2023-07-04 21:40:13,463 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:40:11,892 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:57,973 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:56,539 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:42,781 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:41,202 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:27,324 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:25,824 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:11,850 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:06,328 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:37:16,508 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:37:16,508 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:45551'), ('INFO', '2023-07-04 21:37:16,469 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:37:10,460 - distributed.worker - INFO - Starting Worker plugin RMMSetup-9e2fe483-c637-47ed-88bf-c997f7e39cef'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO - Starting Worker plugin PreImport-b23061df-d69c-4ed3-ad4c-bdcd51cfe0c5'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-4c577330-5c7b-4a7c-aeca-cc0c5b1a80e9'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-qg96dyc4'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:45551'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44597'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:35573'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:35573')), 'ucx://127.0.0.1:36087': (('INFO', "2023-07-04 21:40:13,463 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:40:11,892 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:57,973 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:56,539 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:42,781 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:41,202 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:27,324 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:25,823 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:39:11,850 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:39:06,328 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:37:10,556 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:37:10,556 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:45551'), ('INFO', '2023-07-04 21:37:10,460 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:37:10,460 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-3d891452-04af-4911-9001-4132dec635db'), ('INFO', '2023-07-04 21:37:07,925 - distributed.worker - INFO - Starting Worker plugin PreImport-5f7df480-7bcd-481b-806c-a1212176bdb2'), ('INFO', '2023-07-04 21:37:06,528 - distributed.worker - INFO - Starting Worker plugin RMMSetup-459e3bf7-966e-4717-a81f-64931fb7bb0b'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-kzv5yipw'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:45551'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38233'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:36087'), ('INFO', '2023-07-04 21:37:06,527 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:36087'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3114402)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-infiniband --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 21:40:41,177 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:40:41,178 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:40:41,178 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:40:41,178 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25970.97007 ms
Code block 'ddf-preprocessing' took: 8017.63049 ms
Code block 'ddf-preprocessing' took: 8033.77536 ms
Code block 'ddf-preprocessing' took: 8138.83895 ms
Code block 'ddf-preprocessing' took: 8023.48563 ms
Code block 'ddf-scaler-fit' took: 11609.35495 ms
Code block 'ddf-scaler-fit' took: 8239.33261 ms
Code block 'ddf-scaler-fit' took: 8133.76234 ms
Code block 'ddf-scaler-fit' took: 8335.22464 ms
Code block 'ddf-scaler-fit' took: 8147.49841 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 14651.90317 ms
Code block 'ddf-kmeans-score' took: 7888.74518 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9350.21720 ms
Code block 'ddf-kmeans-score' took: 7960.06596 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9253.03689 ms
Code block 'ddf-kmeans-score' took: 8681.30761 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9403.60800 ms
Code block 'ddf-kmeans-score' took: 8839.91190 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9189.32391 ms
Code block 'ddf-kmeans-score' took: 8098.59063 ms
scores=[array(-276666.6328125)]
client.get_worker_logs()={'ucx://127.0.0.1:32817': (('INFO', "2023-07-04 21:44:10,890 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:44:09,339 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:43:51,741 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:43:50,083 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:43:32,592 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:43:31,242 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:43:14,297 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:43:12,530 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:42:55,829 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:42:49,458 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:40:50,962 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:40:50,962 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:55357'), ('INFO', '2023-07-04 21:40:50,923 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:40:45,073 - distributed.worker - INFO - Starting Worker plugin RMMSetup-820a58d7-32cb-4206-8f62-af6e89c43afd'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO - Starting Worker plugin PreImport-5152be9a-5ba4-4f61-af78-0f9d39134bf8'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-540942f8-3d37-40b2-b060-ca14ff6c93e1'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-fkx1s4xe'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:55357'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35451'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:32817'), ('INFO', '2023-07-04 21:40:41,860 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:32817')), 'ucx://127.0.0.1:41803': (('INFO', "2023-07-04 21:44:10,890 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:44:09,339 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:43:51,741 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:43:50,083 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:43:32,592 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:43:31,242 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:43:14,297 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:43:12,530 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:42:55,829 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:42:49,458 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:40:45,166 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:40:45,166 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:55357'), ('INFO', '2023-07-04 21:40:45,074 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:40:45,073 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-aeff97bc-aa31-4243-856b-070862b0c595'), ('INFO', '2023-07-04 21:40:42,720 - distributed.worker - INFO - Starting Worker plugin PreImport-53394b17-b2da-4b82-8c22-ca9219d20823'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO - Starting Worker plugin RMMSetup-a2dab869-62c1-474e-869e-3920af863a2d'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-e4giktek'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:55357'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46149'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:41803'), ('INFO', '2023-07-04 21:40:41,859 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:41803'))}
2023-07-04 21:44:23,653 - distributed.nanny - WARNING - Worker process still alive after 3.1999990844726565 seconds, killing
2023-07-04 21:44:23,654 - distributed.nanny - WARNING - Worker process still alive after 3.19999984741211 seconds, killing
+ sleep 1
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3119143)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 21:44:41,969 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:44:41,970 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:44:41,970 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:44:41,970 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31689.53534 ms
Code block 'ddf-preprocessing' took: 7656.73934 ms
Code block 'ddf-preprocessing' took: 7627.78421 ms
Code block 'ddf-preprocessing' took: 7747.83049 ms
Code block 'ddf-preprocessing' took: 7660.34592 ms
Code block 'ddf-scaler-fit' took: 12341.20585 ms
Code block 'ddf-scaler-fit' took: 7805.79230 ms
Code block 'ddf-scaler-fit' took: 8508.45682 ms
Code block 'ddf-scaler-fit' took: 8785.65527 ms
Code block 'ddf-scaler-fit' took: 9031.25732 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13984.72160 ms
Code block 'ddf-kmeans-score' took: 8433.85337 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9896.49729 ms
Code block 'ddf-kmeans-score' took: 8397.61750 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10096.66775 ms
Code block 'ddf-kmeans-score' took: 8671.07850 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10948.17741 ms
Code block 'ddf-kmeans-score' took: 8721.61179 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9982.17471 ms
Code block 'ddf-kmeans-score' took: 8725.95395 ms
scores=[array(-215712.91088867)]
client.get_worker_logs()={'ucx://127.0.0.1:49839': (('INFO', "2023-07-04 21:48:15,869 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:48:14,176 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:47:55,966 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:47:53,369 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:47:35,354 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:47:33,651 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:47:15,638 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:47:14,090 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:46:56,195 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:46:50,617 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:44:45,608 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:44:45,608 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:54321'), ('INFO', '2023-07-04 21:44:45,530 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:44:45,530 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ba43214f-d9f6-4404-90ec-389eba99485f'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - Starting Worker plugin PreImport-f178a711-1f0a-4d4f-8e90-544313b92f0e'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-2eafd954-d750-4d72-86bf-a48c0f56c15e'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-7kuxnddc'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:54321'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36993'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:49839'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:49839')), 'ucx://127.0.0.1:57369': (('INFO', "2023-07-04 21:48:15,869 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:48:14,176 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:47:55,966 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:47:53,370 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:47:35,354 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:47:33,651 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:47:15,638 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:47:14,090 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:46:56,195 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:46:50,617 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:44:45,609 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:44:45,609 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:54321'), ('INFO', '2023-07-04 21:44:45,530 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:44:45,530 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-28b93a35-bcff-48ad-9f70-6ea0a2793def'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - Starting Worker plugin PreImport-84b8afb6-1def-4ff8-9d7c-c5f041def277'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - Starting Worker plugin RMMSetup-aa7ca6bb-77a4-4ce9-98ad-cf0563061ac6'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-m3bwk21g'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:54321'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -          dashboard at:            127.0.0.1:39719'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:57369'), ('INFO', '2023-07-04 21:44:42,569 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:57369'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3124177)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 21:48:45,815 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:48:45,816 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:48:45,816 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:48:45,816 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 30945.32966 ms
Code block 'ddf-preprocessing' took: 7640.28788 ms
Code block 'ddf-preprocessing' took: 7994.22311 ms
Code block 'ddf-preprocessing' took: 7631.71807 ms
Code block 'ddf-preprocessing' took: 7886.13640 ms
Code block 'ddf-scaler-fit' took: 13705.02571 ms
Code block 'ddf-scaler-fit' took: 9216.00392 ms
Code block 'ddf-scaler-fit' took: 9999.95370 ms
Code block 'ddf-scaler-fit' took: 10082.63951 ms
Code block 'ddf-scaler-fit' took: 10520.03667 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 15201.66185 ms
Code block 'ddf-kmeans-score' took: 10205.84338 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11517.56913 ms
Code block 'ddf-kmeans-score' took: 10150.29812 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11733.06377 ms
Code block 'ddf-kmeans-score' took: 10040.36252 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11397.28262 ms
Code block 'ddf-kmeans-score' took: 9990.22452 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11246.02840 ms
Code block 'ddf-kmeans-score' took: 10165.71232 ms
scores=[array(-677891.11328125)]
client.get_worker_logs()={'ucx://127.0.0.1:37601': (('INFO', "2023-07-04 21:52:38,334 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:52:36,994 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:52:15,957 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:52:14,409 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:51:53,375 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:51:51,693 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:51:30,164 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:51:28,514 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:51:07,295 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:51:02,096 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:48:49,109 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:48:49,109 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:40583'), ('INFO', '2023-07-04 21:48:49,029 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO - Starting Worker plugin PreImport-f9713dc9-75bb-4602-833e-cb0c61f29027'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-2006e215-5f95-4907-ac2a-3d57c5671653'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ea023d75-2eec-43a6-8f3c-bf5b4d85c1e8'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-0bnjnlz0'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:40583'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33999'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:37601'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:37601')), 'ucx://127.0.0.1:55895': (('INFO', "2023-07-04 21:52:38,334 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:52:36,995 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:52:15,957 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:52:14,409 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:51:53,375 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:51:51,693 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:51:30,164 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:51:28,514 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:51:07,295 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:51:02,096 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:48:49,108 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:48:49,108 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:40583'), ('INFO', '2023-07-04 21:48:49,029 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:48:49,029 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-666050a5-3f93-4286-b3bb-acc45667fafa'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO - Starting Worker plugin PreImport-aeb3f74f-41a0-45dd-a746-d8f13262e600'), ('INFO', '2023-07-04 21:48:46,425 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ad5880c3-b477-4c2a-8b56-e6400b8e69e3'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-1mvzmi12'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:40583'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46495'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:55895'), ('INFO', '2023-07-04 21:48:46,424 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:55895'))}
2023-07-04 21:52:53,402 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-04 21:52:53,404 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-04 21:52:54,010 - distributed.nanny - ERROR - Error in Nanny killing Worker subprocess
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/asyncio/tasks.py", line 456, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/nanny.py", line 603, in close
    await self.kill(timeout=timeout, reason=reason)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/nanny.py", line 388, in kill
    await self.process.kill(reason=reason, timeout=0.8 * (deadline - time()))
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/nanny.py", line 840, in kill
    await process.join(max(0, deadline - time()))
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/process.py", line 316, in join
    await asyncio.wait_for(asyncio.shield(self._exit_future), timeout)
  File "/opt/conda/envs/rapids/lib/python3.10/asyncio/tasks.py", line 458, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError
2023-07-04 21:52:54,032 - distributed.nanny - ERROR - Error in Nanny killing Worker subprocess
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/asyncio/tasks.py", line 456, in wait_for
    return fut.result()
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/nanny.py", line 603, in close
    await self.kill(timeout=timeout, reason=reason)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/nanny.py", line 388, in kill
    await self.process.kill(reason=reason, timeout=0.8 * (deadline - time()))
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/nanny.py", line 840, in kill
    await process.join(max(0, deadline - time()))
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/distributed/process.py", line 316, in join
    await asyncio.wait_for(asyncio.shield(self._exit_future), timeout)
  File "/opt/conda/envs/rapids/lib/python3.10/asyncio/tasks.py", line 458, in wait_for
    raise exceptions.TimeoutError() from exc
asyncio.exceptions.TimeoutError
2023-07-04 21:52:54,219 - distributed.process - WARNING - [<AsyncProcess Dask Worker process (from Nanny)>] process 3125416 exit status was already read will report exitcode 255
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3129490)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 21:53:12,820 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:53:12,821 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:53:12,821 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:53:12,822 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 32118.50684 ms
Code block 'ddf-preprocessing' took: 8172.53216 ms
Code block 'ddf-preprocessing' took: 8029.33313 ms
Code block 'ddf-preprocessing' took: 8034.19437 ms
Code block 'ddf-preprocessing' took: 8030.44972 ms
Code block 'ddf-scaler-fit' took: 12380.01941 ms
Code block 'ddf-scaler-fit' took: 6934.38433 ms
Code block 'ddf-scaler-fit' took: 7099.44520 ms
Code block 'ddf-scaler-fit' took: 7297.78245 ms
Code block 'ddf-scaler-fit' took: 7341.34226 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12596.61705 ms
Code block 'ddf-kmeans-score' took: 7292.60803 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8802.17124 ms
Code block 'ddf-kmeans-score' took: 7245.20505 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8870.92760 ms
Code block 'ddf-kmeans-score' took: 7342.01689 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8812.85360 ms
Code block 'ddf-kmeans-score' took: 7293.95971 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8854.41723 ms
Code block 'ddf-kmeans-score' took: 7207.90519 ms
scores=[array(-187505.99023438)]
client.get_worker_logs()={'ucx://127.0.0.1:39117': (('INFO', "2023-07-04 21:56:30,604 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:56:28,994 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:56:13,383 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:56:11,898 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:55:56,077 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:55:54,413 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:55:38,934 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:55:37,304 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:55:21,589 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:55:16,336 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:53:16,189 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:53:16,188 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:57557'), ('INFO', '2023-07-04 21:53:16,109 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO - Starting Worker plugin PreImport-60aa1489-046a-4dd4-9ac9-33c6952522d1'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-9477fc52-0006-4c1d-a6a8-c17aa85d2ea6'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO - Starting Worker plugin RMMSetup-1476056e-1139-4720-a343-6d12983d0ab7'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-v0qik98f'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:57557'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45733'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:39117'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:39117')), 'ucx://127.0.0.1:52277': (('INFO', "2023-07-04 21:56:30,604 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:56:28,994 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:56:13,383 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:56:11,898 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:55:56,077 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:55:54,413 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:55:38,934 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:55:37,304 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:55:21,589 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:55:16,336 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:53:16,189 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:53:16,189 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:57557'), ('INFO', '2023-07-04 21:53:16,109 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:53:16,109 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-c8916c1e-4775-4d3f-8f5d-a3c5c73b3439'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO - Starting Worker plugin PreImport-f74202d1-3302-4eca-8cdb-4cc13da8b24d'), ('INFO', '2023-07-04 21:53:13,430 - distributed.worker - INFO - Starting Worker plugin RMMSetup-df390f8d-0488-45c0-b0ce-ba178edb5bd8'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-8ulv3nh8'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:57557'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO -          dashboard at:            127.0.0.1:41365'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:52277'), ('INFO', '2023-07-04 21:53:13,429 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:52277'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3134512)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-04 21:56:59,480 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:56:59,482 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 21:56:59,482 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 21:56:59,482 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31349.66407 ms
Code block 'ddf-preprocessing' took: 8003.09655 ms
Code block 'ddf-preprocessing' took: 9101.88043 ms
Code block 'ddf-preprocessing' took: 8012.45359 ms
Code block 'ddf-preprocessing' took: 7972.87288 ms
Code block 'ddf-scaler-fit' took: 13220.14690 ms
Code block 'ddf-scaler-fit' took: 8636.13830 ms
Code block 'ddf-scaler-fit' took: 9580.81217 ms
Code block 'ddf-scaler-fit' took: 8831.40074 ms
Code block 'ddf-scaler-fit' took: 9007.37288 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 14091.26978 ms
Code block 'ddf-kmeans-score' took: 9099.85824 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10433.69138 ms
Code block 'ddf-kmeans-score' took: 9060.50710 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10203.62907 ms
Code block 'ddf-kmeans-score' took: 9045.62363 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10480.23195 ms
Code block 'ddf-kmeans-score' took: 9064.75010 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10415.89583 ms
Code block 'ddf-kmeans-score' took: 8994.35043 ms
scores=[array(-298643.84375)]
client.get_worker_logs()={'ucx://127.0.0.1:42867': (('INFO', "2023-07-04 22:00:40,626 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:00:39,104 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:00:20,074 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:00:18,479 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:59:59,403 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:59:58,015 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:59:39,057 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:59:37,548 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:59:18,318 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:59:12,824 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:57:03,132 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:57:03,132 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:50247'), ('INFO', '2023-07-04 21:57:03,054 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO - Starting Worker plugin PreImport-77fd33c3-3ef5-4efe-bfb2-8e219d806e3e'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-6e6356f2-4c9e-4fc1-bf23-c9be075aa81d'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO - Starting Worker plugin RMMSetup-96145960-ddef-461a-9516-04bea880d8ba'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-0u8tix0u'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:50247'), ('INFO', '2023-07-04 21:57:00,085 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36067'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:42867'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:42867')), 'ucx://127.0.0.1:44677': (('INFO', "2023-07-04 22:00:40,626 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:00:39,104 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:00:20,074 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:00:18,479 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:59:59,403 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:59:58,016 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:59:39,057 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:59:37,548 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 21:59:18,318 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 21:59:12,824 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 21:57:03,132 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:57:03,131 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:50247'), ('INFO', '2023-07-04 21:57:03,054 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:57:03,054 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-5fd64a82-5443-4c2a-8e18-458c8ef45915'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO - Starting Worker plugin PreImport-b7dc4574-47c3-4537-914e-4048b0a8a817'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO - Starting Worker plugin RMMSetup-51a4f1f1-1c44-451c-8747-5394a9a8cbb5'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-7yh4qdlg'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:50247'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46387'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:44677'), ('INFO', '2023-07-04 21:57:00,084 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:44677'))}
+ sleep 1
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3139847)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 22:01:11,987 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:01:11,988 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:01:11,988 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:01:11,988 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25612.97996 ms
Code block 'ddf-preprocessing' took: 7669.11868 ms
Code block 'ddf-preprocessing' took: 7670.34078 ms
Code block 'ddf-preprocessing' took: 7669.13098 ms
Code block 'ddf-preprocessing' took: 8012.29357 ms
Code block 'ddf-scaler-fit' took: 10875.68118 ms
Code block 'ddf-scaler-fit' took: 7010.38292 ms
Code block 'ddf-scaler-fit' took: 7377.88843 ms
Code block 'ddf-scaler-fit' took: 7336.84638 ms
Code block 'ddf-scaler-fit' took: 7537.92144 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12497.71069 ms
Code block 'ddf-kmeans-score' took: 6686.51088 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8196.80206 ms
Code block 'ddf-kmeans-score' took: 6789.29932 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8372.45357 ms
Code block 'ddf-kmeans-score' took: 6819.07154 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8512.19707 ms
Code block 'ddf-kmeans-score' took: 6736.43731 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8262.20043 ms
Code block 'ddf-kmeans-score' took: 6948.75951 ms
scores=[array(-216878.05517578)]
client.get_worker_logs()={'ucx://127.0.0.1:44893': (('INFO', "2023-07-04 22:04:23,966 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:04:22,399 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:04:07,891 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:04:06,087 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:03:51,468 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:03:49,797 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:03:35,234 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:03:33,955 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:03:19,268 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:03:13,599 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:01:22,404 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:01:22,404 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:58211'), ('INFO', '2023-07-04 22:01:22,372 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:01:22,372 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-a5005991-0a37-4c21-bf08-866d2eed560a'), ('INFO', '2023-07-04 22:01:16,480 - distributed.worker - INFO - Starting Worker plugin RMMSetup-d438608a-d114-424c-944e-3120edc32f98'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO - Starting Worker plugin PreImport-5ee4145e-0e36-42fb-a3a7-82ae98e6a1bd'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-w2nq_haj'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:58211'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46535'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:44893'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:44893')), 'ucx://127.0.0.1:56803': (('INFO', "2023-07-04 22:04:23,966 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:04:22,399 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:04:07,891 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:04:06,087 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:03:51,468 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:03:49,797 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:03:35,234 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:03:33,955 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:03:19,268 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:03:13,598 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:01:16,577 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:01:16,577 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:58211'), ('INFO', '2023-07-04 22:01:16,481 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:01:16,480 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-11f9bb81-aeab-43f2-a8d7-c6bc9d41de2c'), ('INFO', '2023-07-04 22:01:14,188 - distributed.worker - INFO - Starting Worker plugin PreImport-74b1f6ae-4dc3-4e68-8d32-bf6ebbc98c60'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO - Starting Worker plugin RMMSetup-1f6bc17c-3040-4705-95a9-26ddf66bcfb1'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-20o0ks5_'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:58211'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35805'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:56803'), ('INFO', '2023-07-04 22:01:12,598 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:56803'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3146350)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 22:04:53,079 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:04:53,080 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:04:53,081 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:04:53,081 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25387.14829 ms
Code block 'ddf-preprocessing' took: 7758.23966 ms
Code block 'ddf-preprocessing' took: 7647.45794 ms
Code block 'ddf-preprocessing' took: 7650.50877 ms
Code block 'ddf-preprocessing' took: 7651.29289 ms
Code block 'ddf-scaler-fit' took: 12254.83388 ms
Code block 'ddf-scaler-fit' took: 8336.77631 ms
Code block 'ddf-scaler-fit' took: 8811.73324 ms
Code block 'ddf-scaler-fit' took: 8834.22939 ms
Code block 'ddf-scaler-fit' took: 9018.95296 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13577.24118 ms
Code block 'ddf-kmeans-score' took: 8566.27573 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9832.94102 ms
Code block 'ddf-kmeans-score' took: 8317.27177 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9840.23141 ms
Code block 'ddf-kmeans-score' took: 8374.28761 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9859.43343 ms
Code block 'ddf-kmeans-score' took: 8187.28390 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9777.33146 ms
Code block 'ddf-kmeans-score' took: 8526.18308 ms
scores=[array(-217453.80639648)]
client.get_worker_logs()={'ucx://127.0.0.1:49719': (('INFO', "2023-07-04 22:08:35,601 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:08:34,032 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:08:16,419 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:08:14,740 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:07:57,084 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:07:55,415 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:07:37,843 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:07:36,275 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:07:18,357 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:07:13,130 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:05:13,213 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:05:13,213 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:40527'), ('INFO', '2023-07-04 22:05:13,173 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:05:13,173 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-692f4ded-0c64-4a54-ab7b-3abe540a0d54'), ('INFO', '2023-07-04 22:04:56,814 - distributed.worker - INFO - Starting Worker plugin RMMSetup-23cac727-6ba6-4799-87ff-2dddff3075dd'), ('INFO', '2023-07-04 22:04:53,686 - distributed.worker - INFO - Starting Worker plugin PreImport-e5cceed6-f91f-45d0-a02c-a4dd9d5d5b6e'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-zf0d2ch3'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:40527'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40341'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:49719'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:49719')), 'ucx://127.0.0.1:53699': (('INFO', "2023-07-04 22:08:35,601 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:08:34,032 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:08:16,419 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:08:14,740 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:07:57,084 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:07:55,415 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:07:37,843 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:07:36,275 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:07:18,357 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:07:13,130 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:05:13,204 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:05:13,204 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:40527'), ('INFO', '2023-07-04 22:05:13,129 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:04:56,814 - distributed.worker - INFO - Starting Worker plugin RMMSetup-8fcb75d9-29ab-4296-ad0a-f8fa03efebca'), ('INFO', '2023-07-04 22:04:56,814 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-74669afc-9d03-421f-bd85-32227a086f30'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO - Starting Worker plugin PreImport-bbe8196e-d19d-41ed-81c4-fe9e9589f015'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-x9ykfmp9'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:40527'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -          dashboard at:            127.0.0.1:42221'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:53699'), ('INFO', '2023-07-04 22:04:53,685 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:53699'))}
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3151178)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 22:09:07,228 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:09:07,229 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:09:07,229 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:09:07,229 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25194.93648 ms
Code block 'ddf-preprocessing' took: 8009.44613 ms
Code block 'ddf-preprocessing' took: 9013.09353 ms
Code block 'ddf-preprocessing' took: 8163.80359 ms
Code block 'ddf-preprocessing' took: 9012.80225 ms
Code block 'ddf-scaler-fit' took: 10516.56597 ms
Code block 'ddf-scaler-fit' took: 6516.79757 ms
Code block 'ddf-scaler-fit' took: 6653.03772 ms
Code block 'ddf-scaler-fit' took: 6569.82457 ms
Code block 'ddf-scaler-fit' took: 6682.99790 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12371.05654 ms
Code block 'ddf-kmeans-score' took: 6455.90552 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7600.62843 ms
Code block 'ddf-kmeans-score' took: 6440.22527 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8884.32782 ms
Code block 'ddf-kmeans-score' took: 6525.47432 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7865.37117 ms
Code block 'ddf-kmeans-score' took: 6606.83294 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8197.62980 ms
Code block 'ddf-kmeans-score' took: 6550.21252 ms
scores=[array(-293098.67773438)]
client.get_worker_logs()={'ucx://127.0.0.1:42689': (('INFO', "2023-07-04 22:12:20,279 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:12:18,471 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:12:04,425 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:12:02,869 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:11:48,969 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:11:46,469 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:11:32,582 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:11:31,253 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:11:17,325 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:11:11,440 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:09:21,100 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:09:21,100 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:43779'), ('INFO', '2023-07-04 22:09:21,041 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:09:21,041 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-79d034a6-ebb9-4577-9495-668cd78df3a1'), ('INFO', '2023-07-04 22:09:10,587 - distributed.worker - INFO - Starting Worker plugin RMMSetup-2479da66-8535-4a45-bd56-45c00e87b4d1'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO - Starting Worker plugin PreImport-7fbc3c5e-9151-4f17-85f8-61e5d10c209b'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-txtgppcv'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:43779'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40995'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:42689'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:42689')), 'ucx://127.0.0.1:42855': (('INFO', "2023-07-04 22:12:20,279 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:12:18,471 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:12:04,425 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:12:02,869 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:11:48,969 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:11:46,469 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:11:32,582 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:11:31,253 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:11:17,325 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:11:11,439 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:09:21,099 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:09:21,099 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:43779'), ('INFO', '2023-07-04 22:09:21,015 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:09:10,587 - distributed.worker - INFO - Starting Worker plugin RMMSetup-2d297b49-7b6d-4576-8948-be70bc7e9bfc'), ('INFO', '2023-07-04 22:09:10,587 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-82aaaa46-4c44-4033-836e-299739a7d098'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO - Starting Worker plugin PreImport-5cd466c9-95ff-497e-8e89-54441d7fca7a'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-1ewzjhbb'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:43779'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44509'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:42855'), ('INFO', '2023-07-04 22:09:07,833 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:42855'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3156252)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --enable-nvlink --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 22:12:48,949 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:12:48,951 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:12:48,960 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:12:48,960 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31486.36703 ms
Code block 'ddf-preprocessing' took: 8039.96279 ms
Code block 'ddf-preprocessing' took: 8061.16907 ms
Code block 'ddf-preprocessing' took: 8061.05491 ms
Code block 'ddf-preprocessing' took: 8158.59730 ms
Code block 'ddf-scaler-fit' took: 12952.08604 ms
Code block 'ddf-scaler-fit' took: 8255.49000 ms
Code block 'ddf-scaler-fit' took: 8929.80457 ms
Code block 'ddf-scaler-fit' took: 9242.29807 ms
Code block 'ddf-scaler-fit' took: 8227.68382 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13780.00362 ms
Code block 'ddf-kmeans-score' took: 8154.25103 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9264.38139 ms
Code block 'ddf-kmeans-score' took: 8120.44807 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9243.31059 ms
Code block 'ddf-kmeans-score' took: 7954.93230 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9327.88662 ms
Code block 'ddf-kmeans-score' took: 7862.39240 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9460.26182 ms
Code block 'ddf-kmeans-score' took: 8134.04060 ms
scores=[array(-282098.36328125)]
client.get_worker_logs()={'ucx://127.0.0.1:39245': (('INFO', "2023-07-04 22:16:20,144 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:16:18,483 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:16:01,767 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:16:00,341 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:15:43,409 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:15:41,733 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:15:24,985 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:15:23,430 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:15:06,312 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:15:00,727 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:12:53,256 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:12:53,256 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:49461'), ('INFO', '2023-07-04 22:12:53,168 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:12:49,997 - distributed.worker - INFO - Starting Worker plugin PreImport-e59b356a-f3dc-4b38-939f-8bc6be81f4ea'), ('INFO', '2023-07-04 22:12:49,997 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-b92f9ef7-aeac-4785-9577-5217d3685867'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO - Starting Worker plugin RMMSetup-10180af2-c96a-418a-854f-bebc10b738bb'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-vrgn4ne0'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:49461'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38433'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:39245'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:39245')), 'ucx://127.0.0.1:47005': (('INFO', "2023-07-04 22:16:20,144 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:16:18,483 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:16:01,767 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:16:00,341 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:15:43,409 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:15:41,733 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:15:24,985 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:15:23,430 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:15:06,312 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:15:00,727 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:12:53,257 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:12:53,257 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:49461'), ('INFO', '2023-07-04 22:12:53,168 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:12:53,168 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-feebdaf1-e4a4-4a8d-9a6d-18acc9e3bbd2'), ('INFO', '2023-07-04 22:12:49,997 - distributed.worker - INFO - Starting Worker plugin PreImport-dd3b13cf-306f-4c49-b59a-c650de4f47e3'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO - Starting Worker plugin RMMSetup-29735675-4671-4536-af04-89e5409aaa3e'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-tl7wwin2'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:49461'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -          dashboard at:            127.0.0.1:41001'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:47005'), ('INFO', '2023-07-04 22:12:49,585 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:47005'))}
+ sleep 1
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3161481)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 22:16:50,135 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:16:50,136 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:16:50,136 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:16:50,136 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31013.11798 ms
Code block 'ddf-preprocessing' took: 7624.24337 ms
Code block 'ddf-preprocessing' took: 7649.51145 ms
Code block 'ddf-preprocessing' took: 7612.24726 ms
Code block 'ddf-preprocessing' took: 7717.13532 ms
Code block 'ddf-scaler-fit' took: 12118.86930 ms
Code block 'ddf-scaler-fit' took: 7788.93657 ms
Code block 'ddf-scaler-fit' took: 8341.93941 ms
Code block 'ddf-scaler-fit' took: 8552.91345 ms
Code block 'ddf-scaler-fit' took: 8877.88865 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13770.84656 ms
Code block 'ddf-kmeans-score' took: 8399.27658 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9872.82583 ms
Code block 'ddf-kmeans-score' took: 8438.50930 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9797.38874 ms
Code block 'ddf-kmeans-score' took: 8473.28473 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9866.84553 ms
Code block 'ddf-kmeans-score' took: 8680.96966 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9979.10237 ms
Code block 'ddf-kmeans-score' took: 8630.71949 ms
scores=[array(-318698.95629883)]
client.get_worker_logs()={'ucx://127.0.0.1:45683': (('INFO', "2023-07-04 22:20:20,591 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:20:18,934 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:20:00,789 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:19:59,126 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:19:41,303 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:19:39,946 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:19:21,924 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:19:20,405 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:19:02,481 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:18:57,058 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:16:53,667 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:16:53,667 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:59181'), ('INFO', '2023-07-04 22:16:53,586 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO - Starting Worker plugin PreImport-dda4e344-0b93-4955-84cd-80a7a11c12be'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-ae65bb39-462d-49f9-a29f-ec0fc2bced65'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ed102796-c64d-4780-9065-e2dbd1db697b'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-3i22hl3q'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:59181'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40735'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:45683'), ('INFO', '2023-07-04 22:16:50,729 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:45683')), 'ucx://127.0.0.1:58241': (('INFO', "2023-07-04 22:20:20,591 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:20:18,934 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:20:00,789 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:19:59,126 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:19:41,303 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:19:39,946 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:19:21,924 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:19:20,404 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:19:02,481 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:18:57,057 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:16:53,666 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:16:53,666 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:59181'), ('INFO', '2023-07-04 22:16:53,586 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:16:53,586 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-0d9bef98-5c21-4fc8-9835-5e705099ed0b'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO - Starting Worker plugin PreImport-e9349ea3-6c3d-4228-aa47-8a42bba47c43'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO - Starting Worker plugin RMMSetup-92829ba8-96d4-4f31-b33d-22ddbbbb4ec7'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-e6vggaf3'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:59181'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO -          dashboard at:            127.0.0.1:41253'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:58241'), ('INFO', '2023-07-04 22:16:50,728 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:58241'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3166603)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 22:20:50,594 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:20:50,595 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:20:50,595 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:20:50,595 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31713.54094 ms
Code block 'ddf-preprocessing' took: 7656.52632 ms
Code block 'ddf-preprocessing' took: 7651.80284 ms
Code block 'ddf-preprocessing' took: 7744.52227 ms
Code block 'ddf-preprocessing' took: 7890.41037 ms
Code block 'ddf-scaler-fit' took: 13594.48091 ms
Code block 'ddf-scaler-fit' took: 9293.97803 ms
Code block 'ddf-scaler-fit' took: 10063.84568 ms
Code block 'ddf-scaler-fit' took: 9930.94045 ms
Code block 'ddf-scaler-fit' took: 10687.14901 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 15327.74446 ms
Code block 'ddf-kmeans-score' took: 9896.08062 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11636.01405 ms
Code block 'ddf-kmeans-score' took: 10142.62021 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11116.31878 ms
Code block 'ddf-kmeans-score' took: 10093.72653 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 11329.54768 ms
Code block 'ddf-kmeans-score' took: 9919.19857 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12495.12926 ms
Code block 'ddf-kmeans-score' took: 10228.91629 ms
scores=[array(-200390.5559082)]
client.get_worker_logs()={'ucx://127.0.0.1:38549': (('INFO', "2023-07-04 22:24:44,092 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:24:41,621 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:24:20,563 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:24:19,027 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:23:58,023 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:23:56,370 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:23:35,634 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:23:34,005 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:23:12,991 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:23:07,553 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:20:53,922 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:20:53,922 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:41265'), ('INFO', '2023-07-04 22:20:53,843 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO - Starting Worker plugin PreImport-6ea928a7-b8e7-4e3f-b8c4-d37f6fb4b769'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-927df15b-1f21-46a4-84ca-5feaf9d6d550'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO - Starting Worker plugin RMMSetup-39b79f61-b020-4072-afb4-00632e19417b'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-f2w7l5np'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:41265'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO -          dashboard at:            127.0.0.1:39559'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:38549'), ('INFO', '2023-07-04 22:20:51,198 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:38549')), 'ucx://127.0.0.1:60361': (('INFO', "2023-07-04 22:24:44,092 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:24:41,621 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:24:20,563 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:24:19,027 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:23:58,023 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:23:56,370 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:23:35,634 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:23:34,005 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:23:12,991 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:23:07,553 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:20:53,921 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:20:53,921 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:41265'), ('INFO', '2023-07-04 22:20:53,843 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO - Starting Worker plugin PreImport-ecd18c8f-b6cb-4c08-8fbe-b1b3aa4a2b2a'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-b2a97974-0dd3-49c1-b6bc-8e4034b1ec60'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO - Starting Worker plugin RMMSetup-5b4ffa10-e2d9-4f15-a720-d1a07d1eae6b'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-a4yo9lpz'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:41265'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40601'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:60361'), ('INFO', '2023-07-04 22:20:51,199 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:60361'))}
2023-07-04 22:24:59,047 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-04 22:24:59,048 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3171877)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 22:25:17,402 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:25:17,403 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:25:17,403 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:25:17,403 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 31556.91656 ms
Code block 'ddf-preprocessing' took: 7996.31194 ms
Code block 'ddf-preprocessing' took: 7994.71552 ms
Code block 'ddf-preprocessing' took: 8104.01663 ms
Code block 'ddf-preprocessing' took: 7978.78945 ms
Code block 'ddf-scaler-fit' took: 11631.86926 ms
Code block 'ddf-scaler-fit' took: 6982.03502 ms
Code block 'ddf-scaler-fit' took: 7740.69724 ms
Code block 'ddf-scaler-fit' took: 7901.80552 ms
Code block 'ddf-scaler-fit' took: 7540.55228 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13593.16162 ms
Code block 'ddf-kmeans-score' took: 7417.69858 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8745.86246 ms
Code block 'ddf-kmeans-score' took: 7292.46688 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8819.51781 ms
Code block 'ddf-kmeans-score' took: 7337.05623 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8660.17639 ms
Code block 'ddf-kmeans-score' took: 7221.56957 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8718.54407 ms
Code block 'ddf-kmeans-score' took: 7559.11563 ms
scores=[array(-186955.17089844)]
client.get_worker_logs()={'ucx://127.0.0.1:55507': (('INFO', "2023-07-04 22:28:36,377 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:28:34,796 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:28:19,239 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:28:17,664 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:28:02,184 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:28:00,701 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:27:44,998 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:27:43,382 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:27:27,625 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:27:21,436 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:25:20,765 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:25:20,765 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:33401'), ('INFO', '2023-07-04 22:25:20,681 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - Starting Worker plugin PreImport-26b9b36e-d86b-42c4-8a6e-e3b310624d85'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-c33112e6-816e-49b7-ad26-0120a88222ef'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - Starting Worker plugin RMMSetup-bd23fb99-2162-44fe-b2dd-b6dc29e38a91'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-s0dmpran'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:33401'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37197'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:55507'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:55507')), 'ucx://127.0.0.1:57521': (('INFO', "2023-07-04 22:28:36,377 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:28:34,795 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:28:19,239 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:28:17,664 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:28:02,184 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:28:00,701 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:27:44,998 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:27:43,382 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:27:27,625 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:27:21,436 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:25:20,764 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:25:20,764 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:33401'), ('INFO', '2023-07-04 22:25:20,681 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:25:20,681 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-10f468d3-8d67-46ec-9636-5050eff970e1'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - Starting Worker plugin PreImport-5a6bda23-f975-4684-8b2e-57445b32032b'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ef99c4d8-fdcf-451b-9edb-d0d78b85ec88'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-mqe716th'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:33401'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37153'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:57521'), ('INFO', '2023-07-04 22:25:17,996 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:57521'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3179037)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 22:29:06,350 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:29:06,351 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:29:06,351 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:29:06,351 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 32379.23825 ms
Code block 'ddf-preprocessing' took: 8008.39148 ms
Code block 'ddf-preprocessing' took: 8037.75347 ms
Code block 'ddf-preprocessing' took: 8115.39633 ms
Code block 'ddf-preprocessing' took: 8034.15822 ms
Code block 'ddf-scaler-fit' took: 13371.84273 ms
Code block 'ddf-scaler-fit' took: 8232.93587 ms
Code block 'ddf-scaler-fit' took: 8726.83229 ms
Code block 'ddf-scaler-fit' took: 8822.22555 ms
Code block 'ddf-scaler-fit' took: 8962.17680 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 14690.37565 ms
Code block 'ddf-kmeans-score' took: 8945.37111 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10593.86077 ms
Code block 'ddf-kmeans-score' took: 8912.18791 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10501.39332 ms
Code block 'ddf-kmeans-score' took: 8745.74329 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10503.27038 ms
Code block 'ddf-kmeans-score' took: 8966.39824 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9999.30837 ms
Code block 'ddf-kmeans-score' took: 8976.77807 ms
scores=[array(-186984.41894531)]
client.get_worker_logs()={'ucx://127.0.0.1:54141': (('INFO', "2023-07-04 22:32:46,781 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:32:45,188 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:32:26,744 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:32:25,160 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:32:06,425 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:32:04,842 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:31:45,948 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:31:44,128 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:31:25,188 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:31:19,556 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:29:10,365 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:29:10,365 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:55427'), ('INFO', '2023-07-04 22:29:10,283 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO - Starting Worker plugin PreImport-412c384f-b534-4969-9f71-0a66e0ff35fc'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-debd3a27-4cb7-4bbb-893a-c3e181da626c'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO - Starting Worker plugin RMMSetup-b217ab63-845e-47ad-b503-3c1fa5b262ad'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-f2_mdvgc'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:55427'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO -          dashboard at:            127.0.0.1:44665'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:54141'), ('INFO', '2023-07-04 22:29:06,943 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:54141')), 'ucx://127.0.0.1:58813': (('INFO', "2023-07-04 22:32:46,781 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:32:45,188 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:32:26,744 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:32:25,160 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:32:06,425 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:32:04,842 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:31:45,948 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:31:44,128 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:31:25,188 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:31:19,556 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:29:10,364 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:29:10,364 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:55427'), ('INFO', '2023-07-04 22:29:10,283 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO - Starting Worker plugin PreImport-6af12844-25f2-48e3-8f96-ab3b7c328538'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-cb3d2057-a2d2-4d47-a64f-95eedf87b483'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO - Starting Worker plugin RMMSetup-af4a6c78-26fc-4d6d-b9a6-b80299830efa'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-1bprzzvv'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:55427'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45545'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:58813'), ('INFO', '2023-07-04 22:29:06,940 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:58813'))}
2023-07-04 22:33:00,536 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-04 22:33:00,537 - distributed.nanny - WARNING - Worker process still alive after 3.19999984741211 seconds, killing
+ sleep 1
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3184356)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 22:33:19,076 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:33:19,077 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:33:19,077 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:33:19,077 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25148.39097 ms
Code block 'ddf-preprocessing' took: 7739.65054 ms
Code block 'ddf-preprocessing' took: 7663.07593 ms
Code block 'ddf-preprocessing' took: 7655.51354 ms
Code block 'ddf-preprocessing' took: 7649.38716 ms
Code block 'ddf-scaler-fit' took: 11402.10833 ms
Code block 'ddf-scaler-fit' took: 6960.80964 ms
Code block 'ddf-scaler-fit' took: 7363.46901 ms
Code block 'ddf-scaler-fit' took: 7257.84212 ms
Code block 'ddf-scaler-fit' took: 7824.53972 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12420.84296 ms
Code block 'ddf-kmeans-score' took: 6889.08965 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8175.42331 ms
Code block 'ddf-kmeans-score' took: 6772.52850 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8191.69053 ms
Code block 'ddf-kmeans-score' took: 6778.57951 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8280.60384 ms
Code block 'ddf-kmeans-score' took: 6813.33944 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 8363.41449 ms
Code block 'ddf-kmeans-score' took: 6940.27962 ms
scores=[array(-318514.45849609)]
client.get_worker_logs()={'ucx://127.0.0.1:36881': (('INFO', "2023-07-04 22:36:30,685 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:36:28,991 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:36:14,424 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:36:12,869 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:35:58,286 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:35:56,764 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:35:42,057 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:35:40,382 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:35:25,890 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:35:20,264 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:33:23,325 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:33:23,325 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:56267'), ('INFO', '2023-07-04 22:33:23,254 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:33:23,254 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-4d48ce3f-e073-4383-8cdf-6a51a497919b'), ('INFO', '2023-07-04 22:33:20,696 - distributed.worker - INFO - Starting Worker plugin PreImport-2bca59b1-058d-4b75-9bea-0c61d2f1add1'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO - Starting Worker plugin RMMSetup-b087aef5-6c42-429b-b3cf-b6d27e0800df'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-cg42lccr'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:56267'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33629'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:36881'), ('INFO', '2023-07-04 22:33:19,663 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:36881')), 'ucx://127.0.0.1:60951': (('INFO', "2023-07-04 22:36:30,685 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:36:28,991 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:36:14,425 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:36:12,869 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:35:58,286 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:35:56,764 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:35:42,057 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:35:40,382 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:35:25,890 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:35:20,264 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:33:28,992 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:33:28,992 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:56267'), ('INFO', '2023-07-04 22:33:28,960 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:33:23,254 - distributed.worker - INFO - Starting Worker plugin RMMSetup-2b45e21a-0b5b-498e-bf08-839cc34ed9d1'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO - Starting Worker plugin PreImport-837d80c7-7ce8-4e9f-8e65-5e5cb4f22cad'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-2386705e-35fb-480d-83f8-c8a402fb9955'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-_y0v2dn5'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:56267'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45723'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:60951'), ('INFO', '2023-07-04 22:33:19,664 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:60951'))}
2023-07-04 22:36:42,450 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3189252)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 22:37:00,240 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:37:00,241 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:37:00,241 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:37:00,241 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 26327.80758 ms
Code block 'ddf-preprocessing' took: 7644.30078 ms
Code block 'ddf-preprocessing' took: 7988.13465 ms
Code block 'ddf-preprocessing' took: 7651.29089 ms
Code block 'ddf-preprocessing' took: 7637.73729 ms
Code block 'ddf-scaler-fit' took: 12835.48860 ms
Code block 'ddf-scaler-fit' took: 8318.11881 ms
Code block 'ddf-scaler-fit' took: 8877.10209 ms
Code block 'ddf-scaler-fit' took: 8738.37142 ms
Code block 'ddf-scaler-fit' took: 9207.18174 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13998.05887 ms
Code block 'ddf-kmeans-score' took: 8294.98166 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10114.91545 ms
Code block 'ddf-kmeans-score' took: 8310.14226 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9769.74084 ms
Code block 'ddf-kmeans-score' took: 8170.20481 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 10018.54605 ms
Code block 'ddf-kmeans-score' took: 8181.88589 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9720.88577 ms
Code block 'ddf-kmeans-score' took: 8772.15956 ms
scores=[array(-646426.75146484)]
client.get_worker_logs()={'ucx://127.0.0.1:47527': (('INFO', "2023-07-04 22:40:34,494 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:40:33,113 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:40:15,500 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:40:13,828 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:39:56,219 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:39:54,557 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:39:37,042 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:39:35,360 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:39:17,546 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:39:11,750 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:37:04,852 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:37:04,852 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:52857'), ('INFO', '2023-07-04 22:37:04,774 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:37:04,774 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-4672689f-3bf7-457b-b146-af51afc0c174'), ('INFO', '2023-07-04 22:37:02,367 - distributed.worker - INFO - Starting Worker plugin PreImport-6b28386d-dd73-4b2d-b70b-42a027b864c9'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ab800315-f45e-40cc-b63d-436537223e08'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-mfwbb69g'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:52857'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34085'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:47527'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:47527')), 'ucx://127.0.0.1:57241': (('INFO', "2023-07-04 22:40:34,494 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:40:33,113 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:40:15,500 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:40:13,828 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:39:56,220 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:39:54,557 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:39:37,042 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:39:35,355 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:39:17,546 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:39:11,750 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:37:10,435 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:37:10,435 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:52857'), ('INFO', '2023-07-04 22:37:10,401 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:37:04,774 - distributed.worker - INFO - Starting Worker plugin RMMSetup-803ba253-e7a2-4cb9-963b-42a7b72492dd'), ('INFO', '2023-07-04 22:37:00,829 - distributed.worker - INFO - Starting Worker plugin PreImport-b18eaaa3-831d-4d2f-9abc-9e96325602e4'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-e0a8aaab-a8eb-4511-9ea6-322b94815d31'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-8q2gih5n'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:52857'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36289'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:57241'), ('INFO', '2023-07-04 22:37:00,828 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:57241'))}
2023-07-04 22:40:47,883 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-04 22:40:47,884 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3194519)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 22:41:07,130 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:41:07,131 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:41:07,131 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:41:07,131 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 25221.09909 ms
Code block 'ddf-preprocessing' took: 8020.55136 ms
Code block 'ddf-preprocessing' took: 8036.86767 ms
Code block 'ddf-preprocessing' took: 8039.37258 ms
Code block 'ddf-preprocessing' took: 8149.85618 ms
Code block 'ddf-scaler-fit' took: 11146.04234 ms
Code block 'ddf-scaler-fit' took: 6531.52936 ms
Code block 'ddf-scaler-fit' took: 6494.29003 ms
Code block 'ddf-scaler-fit' took: 7033.02283 ms
Code block 'ddf-scaler-fit' took: 6793.49275 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 12057.38295 ms
Code block 'ddf-kmeans-score' took: 6427.45205 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7531.31036 ms
Code block 'ddf-kmeans-score' took: 7070.92071 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7994.99172 ms
Code block 'ddf-kmeans-score' took: 6552.69688 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7773.24832 ms
Code block 'ddf-kmeans-score' took: 6534.12374 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 7773.32078 ms
Code block 'ddf-kmeans-score' took: 6424.25025 ms
scores=[array(-293707.28320312)]
client.get_worker_logs()={'ucx://127.0.0.1:35115': (('INFO', "2023-07-04 22:44:16,397 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:44:14,841 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:44:00,913 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:59,484 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:43:45,525 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:43,881 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:43:29,397 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:28,030 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:43:14,224 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:08,752 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:41:12,011 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:41:12,011 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:56155'), ('INFO', '2023-07-04 22:41:11,928 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:41:11,928 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-949d9073-e276-4ec8-92d8-6466df0932cb'), ('INFO', '2023-07-04 22:41:09,143 - distributed.worker - INFO - Starting Worker plugin PreImport-fb452102-454e-43d7-b539-4f93c41fefdd'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO - Starting Worker plugin RMMSetup-9d511c57-bee3-4fa4-ae4d-f87591f09457'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-4mtpc5kg'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:56155'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO -          dashboard at:            127.0.0.1:39705'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:35115'), ('INFO', '2023-07-04 22:41:07,725 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:35115')), 'ucx://127.0.0.1:49899': (('INFO', "2023-07-04 22:44:16,397 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:44:14,842 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:44:00,913 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:59,484 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:43:45,525 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:43,881 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:43:29,397 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:28,030 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:43:14,224 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:43:08,752 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:41:18,778 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:41:18,778 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:56155'), ('INFO', '2023-07-04 22:41:18,746 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:41:11,928 - distributed.worker - INFO - Starting Worker plugin RMMSetup-28d8b8c1-c26c-4142-ad06-7470580ff852'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO - Starting Worker plugin PreImport-6b8b7efb-89f9-406b-97eb-b9f1314fbced'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-4efc0df6-416d-4d8f-ae47-0f347aac659c'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-akjgqtsq'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:56155'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33289'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:49899'), ('INFO', '2023-07-04 22:41:07,726 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:49899'))}
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=California.json
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3199447)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files California.json --reps 5 --protocol ucx --rmm-pool-size 0.7 --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=['California.json'], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 22:44:45,957 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:44:45,959 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:44:45,959 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:44:45,959 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 26640.10892 ms
Code block 'ddf-preprocessing' took: 8030.68635 ms
Code block 'ddf-preprocessing' took: 8116.46644 ms
Code block 'ddf-preprocessing' took: 8041.75237 ms
Code block 'ddf-preprocessing' took: 8044.87999 ms
Code block 'ddf-scaler-fit' took: 12739.17862 ms
Code block 'ddf-scaler-fit' took: 8030.32646 ms
Code block 'ddf-scaler-fit' took: 8825.47332 ms
Code block 'ddf-scaler-fit' took: 8129.24826 ms
Code block 'ddf-scaler-fit' took: 8196.76565 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 13780.98607 ms
Code block 'ddf-kmeans-score' took: 7994.52859 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9166.91265 ms
Code block 'ddf-kmeans-score' took: 8083.64082 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9191.76685 ms
Code block 'ddf-kmeans-score' took: 8146.56343 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9585.03315 ms
Code block 'ddf-kmeans-score' took: 8183.16875 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 9429.20846 ms
Code block 'ddf-kmeans-score' took: 8177.47483 ms
scores=[array(-276678.79296875)]
client.get_worker_logs()={'ucx://127.0.0.1:53181': (('INFO', "2023-07-04 22:48:16,794 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:48:15,143 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:58,111 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:47:56,223 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:39,296 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:47:37,972 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:20,952 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:47:19,497 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:02,567 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:46:57,016 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:44:56,157 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:44:56,157 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:52529'), ('INFO', '2023-07-04 22:44:56,124 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:44:50,159 - distributed.worker - INFO - Starting Worker plugin RMMSetup-edfa9641-866e-424b-b3a6-6be7186ec514'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO - Starting Worker plugin PreImport-6cf5ff12-c5ce-45dd-a7d8-c00142a963d8'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-344da04b-62e7-448e-90af-e84a6e4e188a'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-7d76dl2e'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:52529'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34273'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:53181'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:53181')), 'ucx://127.0.0.1:60559': (('INFO', "2023-07-04 22:48:16,794 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:48:15,144 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:58,111 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:47:56,223 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:39,296 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:47:37,972 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:20,952 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:47:19,497 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 22:47:02,567 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 22:46:57,016 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:44:50,253 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:44:50,253 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:52529'), ('INFO', '2023-07-04 22:44:50,159 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:44:50,159 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-67db4349-7c51-4a5a-8a54-ae57f92e4192'), ('INFO', '2023-07-04 22:44:47,684 - distributed.worker - INFO - Starting Worker plugin PreImport-428611b5-21de-443a-ae63-67dd746a228b'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO - Starting Worker plugin RMMSetup-3e333e6c-c443-4455-bca0-0ac1b0aca157'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-btpth5kl'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:52529'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -          dashboard at:            127.0.0.1:32799'), ('INFO', '2023-07-04 22:44:46,555 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:44:46,554 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:60559'), ('INFO', '2023-07-04 22:44:46,554 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:60559'))}
+ sleep 1
+ for FILES in "California.json" ""
+ for PROTOCOL in tcp ucx
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3204438)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-04 22:48:45,067 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:48:45,068 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 22:48:45,068 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 22:48:45,068 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 117868.21355 ms
Code block 'ddf-preprocessing' took: 96320.12491 ms
Code block 'ddf-preprocessing' took: 97202.44147 ms
Code block 'ddf-preprocessing' took: 96703.80346 ms
Code block 'ddf-preprocessing' took: 97250.92688 ms
Code block 'ddf-scaler-fit' took: 100090.67064 ms
Code block 'ddf-scaler-fit' took: 97766.46559 ms
Code block 'ddf-scaler-fit' took: 100344.94843 ms
Code block 'ddf-scaler-fit' took: 102526.28239 ms
Code block 'ddf-scaler-fit' took: 105685.90367 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 242170.91050 ms
Code block 'ddf-kmeans-score' took: 112409.75985 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 240527.28761 ms
Code block 'ddf-kmeans-score' took: 112552.35674 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 136723.02147 ms
Code block 'ddf-kmeans-score' took: 111953.43320 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 240455.87396 ms
Code block 'ddf-kmeans-score' took: 112894.61421 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 239241.70391 ms
Code block 'ddf-kmeans-score' took: 112876.66875 ms
scores=[array(-4.33882409e+08)]
client.get_worker_logs()={'tcp://127.0.0.1:34753': (('INFO', "2023-07-04 23:31:42,668 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:29:26,692 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:25:49,101 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:23:31,636 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:19:55,314 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:19:20,872 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:15:44,674 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:13:27,093 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:09:50,335 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:07:28,984 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:48:48,652 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:48:48,652 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:41205'), ('INFO', '2023-07-04 22:48:48,618 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:48:48,618 - distributed.worker - INFO - Starting Worker plugin RMMSetup-c466bf0f-0a94-4e41-9f23-d3346017358d'), ('INFO', '2023-07-04 22:48:46,154 - distributed.worker - INFO - Starting Worker plugin PreImport-05e7684c-2c24-4a09-b56a-26cf836c24ac'), ('INFO', '2023-07-04 22:48:46,154 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-c0613b3d-0297-4395-a83e-33581336cedc'), ('INFO', '2023-07-04 22:48:46,154 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-qxh2m608'), ('INFO', '2023-07-04 22:48:46,154 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:48:46,154 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:41205'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -          dashboard at:            127.0.0.1:39649'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:34753'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:34753')), 'tcp://127.0.0.1:39287': (('INFO', "2023-07-04 23:31:42,668 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:29:26,692 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:25:49,100 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:23:31,636 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:19:55,314 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:19:20,872 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:15:44,674 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:13:27,093 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:09:50,335 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:07:28,984 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 22:48:48,653 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:48:48,653 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:41205'), ('INFO', '2023-07-04 22:48:48,618 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO - Starting Worker plugin PreImport-b6c3d0b1-00b5-49a5-82db-878c8bd34a33'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-839282a1-bb1e-4d23-a6bd-fd3f1374845b'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO - Starting Worker plugin RMMSetup-cf436204-66bd-4183-8ba2-7b52f6211374'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-j3yf6hc9'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:41205'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35443'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:39287'), ('INFO', '2023-07-04 22:48:46,153 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:39287'))}
2023-07-04 23:33:40,534 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-04 23:33:40,536 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3247405)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-04 23:34:02,003 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 23:34:02,004 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-04 23:34:02,004 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-04 23:34:02,004 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 123068.78788 ms
Code block 'ddf-preprocessing' took: 96834.65909 ms
Code block 'ddf-preprocessing' took: 96546.39646 ms
Code block 'ddf-preprocessing' took: 96402.88921 ms
Code block 'ddf-preprocessing' took: 96436.28004 ms
Code block 'ddf-scaler-fit' took: 115663.67064 ms
Code block 'ddf-scaler-fit' took: 112726.24170 ms
Code block 'ddf-scaler-fit' took: 115662.01099 ms
Code block 'ddf-scaler-fit' took: 118847.80427 ms
Code block 'ddf-scaler-fit' took: 121737.88311 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 260536.48228 ms
Code block 'ddf-kmeans-score' took: 129762.67939 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 253622.51546 ms
Code block 'ddf-kmeans-score' took: 128996.80899 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 253985.54518 ms
Code block 'ddf-kmeans-score' took: 127958.25620 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 253513.84260 ms
Code block 'ddf-kmeans-score' took: 129112.58938 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 254373.91589 ms
Code block 'ddf-kmeans-score' took: 128447.38201 ms
scores=[array(-4.33891753e+08)]
client.get_worker_logs()={'tcp://127.0.0.1:33791': (('INFO', "2023-07-05 00:22:27,065 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:20:10,364 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:16:02,143 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:13:45,533 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:09:39,244 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:07:23,713 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:03:14,791 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:00:58,652 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:56:50,020 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:54:29,720 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 23:34:06,770 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 23:34:06,770 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:36871'), ('INFO', '2023-07-04 23:34:06,724 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 23:34:06,724 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-25b0087b-55b1-4f64-863f-d69e7912d9de'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO - Starting Worker plugin PreImport-3a49cc1d-d784-43ef-aa10-ec7735546fa3'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO - Starting Worker plugin RMMSetup-d29c0058-6794-4586-8d65-35978f87e654'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-vhmutjt3'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:36871'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -          dashboard at:            127.0.0.1:32985'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:33791'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:33791')), 'tcp://127.0.0.1:45259': (('INFO', "2023-07-05 00:22:27,065 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:20:10,363 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:16:02,143 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:13:45,533 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:09:39,244 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:07:23,713 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:03:14,791 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:00:58,652 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-04 23:56:50,020 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-04 23:54:29,719 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-04 23:34:06,769 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 23:34:06,769 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:36871'), ('INFO', '2023-07-04 23:34:06,724 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 23:34:06,724 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-d09dbc3c-80af-4313-b499-828fc712cf81'), ('INFO', '2023-07-04 23:34:06,724 - distributed.worker - INFO - Starting Worker plugin RMMSetup-81c5c3bb-2598-423b-a21a-e7f64fa5033d'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO - Starting Worker plugin PreImport-ba9c0f51-4639-4682-8cc6-832029bb24c9'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-xyuy9tmf'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:36871'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35943'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:45259'), ('INFO', '2023-07-04 23:34:03,434 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:45259'))}
2023-07-05 00:24:41,287 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-05 00:24:41,289 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3296049)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 00:25:02,646 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 00:25:02,647 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 00:25:02,648 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 00:25:02,648 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 112660.37249 ms
Code block 'ddf-preprocessing' took: 85048.41216 ms
Code block 'ddf-preprocessing' took: 85547.16410 ms
Code block 'ddf-preprocessing' took: 85027.04630 ms
Code block 'ddf-preprocessing' took: 86615.53135 ms
Code block 'ddf-scaler-fit' took: 89307.71402 ms
Code block 'ddf-scaler-fit' took: 84225.26822 ms
Code block 'ddf-scaler-fit' took: 85337.88057 ms
Code block 'ddf-scaler-fit' took: 86193.05750 ms
Code block 'ddf-scaler-fit' took: 87202.31577 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 226786.76374 ms
Code block 'ddf-kmeans-score' took: 90213.60403 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 227618.63291 ms
Code block 'ddf-kmeans-score' took: 89367.00738 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 226467.91064 ms
Code block 'ddf-kmeans-score' took: 89518.26895 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 223271.92525 ms
Code block 'ddf-kmeans-score' took: 89064.46664 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 223698.36468 ms
Code block 'ddf-kmeans-score' took: 89487.68027 ms
scores=[array(-76003457.23828125)]
client.get_worker_logs()={'tcp://127.0.0.1:39129': (('INFO', "2023-07-05 01:04:54,253 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:02:37,080 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:59:40,369 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:57:24,881 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:54:26,383 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:52:07,832 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:49:09,421 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:46:50,077 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:43:50,442 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:41:30,426 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 00:25:07,525 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 00:25:07,524 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:43929'), ('INFO', '2023-07-05 00:25:07,478 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - Starting Worker plugin PreImport-1d51017d-8df9-4207-8a82-5efbd6ce385a'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-15f52a13-9305-4549-b0d7-e5c2700f9c9f'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - Starting Worker plugin RMMSetup-4c5034ab-aeec-4ed5-9a2f-3e6cde6bc92d'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-sj7okq2t'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:43929'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43763'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:39129'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:39129')), 'tcp://127.0.0.1:43283': (('INFO', "2023-07-05 01:04:54,253 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:02:37,080 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:59:40,369 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:57:24,880 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:54:26,383 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:52:07,832 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:49:09,421 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:46:50,077 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 00:43:50,442 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 00:41:30,426 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 00:25:07,524 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 00:25:07,524 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:43929'), ('INFO', '2023-07-05 00:25:07,478 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 00:25:07,478 - distributed.worker - INFO - Starting Worker plugin RMMSetup-ee1977a7-4f71-4e0f-a660-3582c9f9fbf2'), ('INFO', '2023-07-05 00:25:07,478 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-c3d4b4c2-dd5e-470d-852b-4fc5d063b076'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - Starting Worker plugin PreImport-69fa4e3f-49ce-4a0b-a783-f3bef4cc7c9b'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-gtxodzo0'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:43929'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45305'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:43283'), ('INFO', '2023-07-05 00:25:04,067 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:43283'))}
2023-07-05 01:06:28,673 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-05 01:06:28,675 - distributed.nanny - WARNING - Worker process still alive after 3.19999984741211 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3335815)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-05 01:06:49,713 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 01:06:49,715 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 01:06:49,715 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 01:06:49,715 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 110626.73126 ms
Code block 'ddf-preprocessing' took: 84854.13728 ms
Code block 'ddf-preprocessing' took: 84936.63275 ms
Code block 'ddf-preprocessing' took: 85638.20968 ms
Code block 'ddf-preprocessing' took: 86213.89702 ms
Code block 'ddf-scaler-fit' took: 101051.43960 ms
Code block 'ddf-scaler-fit' took: 98157.02299 ms
Code block 'ddf-scaler-fit' took: 99987.45501 ms
Code block 'ddf-scaler-fit' took: 100157.25254 ms
Code block 'ddf-scaler-fit' took: 102280.33868 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 242252.87618 ms
Code block 'ddf-kmeans-score' took: 103422.41311 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 240023.10105 ms
Code block 'ddf-kmeans-score' took: 104668.51324 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 236198.24539 ms
Code block 'ddf-kmeans-score' took: 103840.09783 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 238130.77624 ms
Code block 'ddf-kmeans-score' took: 103356.39360 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 236652.05042 ms
Code block 'ddf-kmeans-score' took: 103424.02664 ms
scores=[array(-3.83386705e+08)]
client.get_worker_logs()={'tcp://127.0.0.1:39753': (('INFO', "2023-07-05 01:49:50,048 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:47:34,342 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:44:08,905 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:41:51,504 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:38:25,798 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:36:10,115 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:32:43,803 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:30:25,965 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:26:59,200 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:24:39,147 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 01:06:54,557 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:06:54,557 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37559'), ('INFO', '2023-07-05 01:06:54,521 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:06:54,520 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-14b9fc3e-4902-4687-80a7-95f38041bdc7'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO - Starting Worker plugin PreImport-799e434b-ee13-4816-89eb-0388eac6c977'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO - Starting Worker plugin RMMSetup-859a8957-d14a-4652-8c7a-8ae901abcb83'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-b8p6v7o3'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37559'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34637'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:39753'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:39753')), 'tcp://127.0.0.1:43037': (('INFO', "2023-07-05 01:49:50,048 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:47:34,342 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:44:08,905 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:41:51,504 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:38:25,798 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:36:10,116 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:32:43,803 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:30:25,965 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 01:26:59,200 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 01:24:39,145 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 01:06:54,557 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:06:54,557 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37559'), ('INFO', '2023-07-05 01:06:54,520 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO - Starting Worker plugin PreImport-1868d90e-7fdc-44e5-8972-00827e3b0294'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-b759804d-0d94-4675-9583-1284d350db30'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO - Starting Worker plugin RMMSetup-61da2a1c-9a25-4bac-a19b-720bd1c00c6c'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-r0yod7_i'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37559'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36689'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 01:06:51,150 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:43037'), ('INFO', '2023-07-05 01:06:51,149 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:43037'))}
2023-07-05 01:51:38,246 - distributed.nanny - WARNING - Worker process still alive after 3.1999989318847657 seconds, killing
2023-07-05 01:51:38,247 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
+ sleep 1
+ for RMM_POOL_SIZE in "" "--rmm-pool-size 0.7"
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE='--rmm-pool-size 0.7'
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3377744)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --rmm-pool-size 0.7 --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=0.7, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 01:51:59,110 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 01:51:59,111 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 01:51:59,111 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 01:51:59,111 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 121760.85909 ms
Code block 'ddf-preprocessing' took: 97491.75473 ms
Code block 'ddf-preprocessing' took: 96607.95822 ms
Code block 'ddf-preprocessing' took: 96872.43400 ms
Code block 'ddf-preprocessing' took: 96491.86586 ms
Code block 'ddf-scaler-fit' took: 94662.09893 ms
Code block 'ddf-scaler-fit' took: 91422.36458 ms
Code block 'ddf-scaler-fit' took: 92589.27174 ms
Code block 'ddf-scaler-fit' took: 94964.13645 ms
Code block 'ddf-scaler-fit' took: 96904.27753 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 127744.66660 ms
Code block 'ddf-kmeans-score' took: 100131.03700 ms
Fitting kmeans with 8 clusters
2023-07-05 02:13:56,501 - distributed.worker - WARNING - Compute Failed
Key:       _func_fit-f8ec2099-8b64-4775-9d15-f474c4a8b978
Function:  _func_fit
args:      (b'\x1eP!\xf9%\x86C.\xa6_\xcf\xdc\x0c\xc8\xba,', [         rating  latitude  longitude
0          0.75  0.649850   0.301483
1          1.00  0.649850   0.301483
2          0.00  0.649850   0.301483
3          1.00  0.649850   0.301483
4          0.75  0.649850   0.301483
...         ...       ...        ...
1156339    0.75  0.651414   0.301539
1156340    1.00  0.651414   0.301539
1156341    1.00  0.651414   0.301539
1156342    1.00  0.651414   0.301539
1156343    0.75  0.651414   0.301539

[1156344 rows x 3 columns],         rating  latitude  longitude
0         0.75  0.651414   0.301539
1         0.75  0.651414   0.301539
2         0.75  0.651414   0.301539
3         1.00  0.651414   0.301539
4         1.00  0.651414   0.301539
...        ...       ...        ...
288976    0.50  0.653283   0.301297
288977    1.00  0.653283   0.301297
288978    0.50  0.653283   0.301297
288979    0.75  0.653283   0.301297
288980    1.00  0.653283   0.301297

[288981 rows x 3 columns],          rating  
kwargs:    {'max_iter': 100, 'tol': 1e-10, 'n_clusters': 8, 'random_state': 1, 'verbose': False}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/rapids/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded')"

2023-07-05 02:13:56,562 - distributed.worker - WARNING - Compute Failed
Key:       _func_fit-cf28100f-78fb-4421-b7ec-0df4b330530c
Function:  _func_fit
args:      (b'\x1eP!\xf9%\x86C.\xa6_\xcf\xdc\x0c\xc8\xba,', [         rating  latitude  longitude
0          0.00  0.656013   0.301301
1          0.00  0.656013   0.301301
2          0.75  0.655884   0.301487
3          1.00  0.655884   0.301487
4          1.00  0.655884   0.301487
...         ...       ...        ...
1185819    1.00  0.649850   0.301483
1185820    1.00  0.649850   0.301483
1185821    0.50  0.649850   0.301483
1185822    0.75  0.649850   0.301483
1185823    0.75  0.649850   0.301483

[1185824 rows x 3 columns],          rating  latitude  longitude
0          1.00  0.615611   0.227269
1          1.00  0.615611   0.227269
2          1.00  0.615611   0.227269
3          1.00  0.615611   0.227269
4          1.00  0.615611   0.227269
...         ...       ...        ...
1190511    1.00  0.610955   0.222146
1190512    0.25  0.610955   0.222146
1190513    0.75  0.610955   0.222146
1190514    0.75  0.610955   0.222146
1190515    1.00  0.610955   0.222146

[1190516 rows x 3 columns],     
kwargs:    {'max_iter': 100, 'tol': 1e-10, 'n_clusters': 8, 'random_state': 1, 'verbose': False}
Exception: "MemoryError('std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/rapids/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded')"

Code block 'ddf-kmeans-fit' took: 94644.54745 ms
client.get_worker_logs()={'tcp://127.0.0.1:36279': (('WARNING', '2023-07-05 02:13:56,501 - distributed.worker - WARNING - Compute Failed\nKey:       _func_fit-f8ec2099-8b64-4775-9d15-f474c4a8b978\nFunction:  _func_fit\nargs:      (b\'\\x1eP!\\xf9%\\x86C.\\xa6_\\xcf\\xdc\\x0c\\xc8\\xba,\', [         rating  latitude  longitude\n0          0.75  0.649850   0.301483\n1          1.00  0.649850   0.301483\n2          0.00  0.649850   0.301483\n3          1.00  0.649850   0.301483\n4          0.75  0.649850   0.301483\n...         ...       ...        ...\n1156339    0.75  0.651414   0.301539\n1156340    1.00  0.651414   0.301539\n1156341    1.00  0.651414   0.301539\n1156342    1.00  0.651414   0.301539\n1156343    0.75  0.651414   0.301539\n\n[1156344 rows x 3 columns],         rating  latitude  longitude\n0         0.75  0.651414   0.301539\n1         0.75  0.651414   0.301539\n2         0.75  0.651414   0.301539\n3         1.00  0.651414   0.301539\n4         1.00  0.651414   0.301539\n...        ...       ...        ...\n288976    0.50  0.653283   0.301297\n288977    1.00  0.653283   0.301297\n288978    0.50  0.653283   0.301297\n288979    0.75  0.653283   0.301297\n288980    1.00  0.653283   0.301297\n\n[288981 rows x 3 columns],          rating  \nkwargs:    {\'max_iter\': 100, \'tol\': 1e-10, \'n_clusters\': 8, \'random_state\': 1, \'verbose\': False}\nException: "MemoryError(\'std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/rapids/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded\')"\n'), ('INFO', "2023-07-05 02:13:52,240 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 02:10:40,575 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 02:10:03,451 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 01:52:04,113 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:52:04,113 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37627'), ('INFO', '2023-07-05 01:52:04,075 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:52:00,803 - distributed.worker - INFO - Starting Worker plugin PreImport-a5150a96-d14f-4cd6-963c-7b676f4cd9d2'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO - Starting Worker plugin RMMSetup-6711f4d2-d6e0-4d94-b242-7ddf3b750e13'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-961f6efb-e889-4899-89ff-56ed928e827b'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-ru0g_l9w'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37627'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38125'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:36279'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:36279')), 'tcp://127.0.0.1:38189': (('WARNING', '2023-07-05 02:13:56,562 - distributed.worker - WARNING - Compute Failed\nKey:       _func_fit-cf28100f-78fb-4421-b7ec-0df4b330530c\nFunction:  _func_fit\nargs:      (b\'\\x1eP!\\xf9%\\x86C.\\xa6_\\xcf\\xdc\\x0c\\xc8\\xba,\', [         rating  latitude  longitude\n0          0.00  0.656013   0.301301\n1          0.00  0.656013   0.301301\n2          0.75  0.655884   0.301487\n3          1.00  0.655884   0.301487\n4          1.00  0.655884   0.301487\n...         ...       ...        ...\n1185819    1.00  0.649850   0.301483\n1185820    1.00  0.649850   0.301483\n1185821    0.50  0.649850   0.301483\n1185822    0.75  0.649850   0.301483\n1185823    0.75  0.649850   0.301483\n\n[1185824 rows x 3 columns],          rating  latitude  longitude\n0          1.00  0.615611   0.227269\n1          1.00  0.615611   0.227269\n2          1.00  0.615611   0.227269\n3          1.00  0.615611   0.227269\n4          1.00  0.615611   0.227269\n...         ...       ...        ...\n1190511    1.00  0.610955   0.222146\n1190512    0.25  0.610955   0.222146\n1190513    0.75  0.610955   0.222146\n1190514    0.75  0.610955   0.222146\n1190515    1.00  0.610955   0.222146\n\n[1190516 rows x 3 columns],     \nkwargs:    {\'max_iter\': 100, \'tol\': 1e-10, \'n_clusters\': 8, \'random_state\': 1, \'verbose\': False}\nException: "MemoryError(\'std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/rapids/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded\')"\n'), ('INFO', "2023-07-05 02:13:52,240 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 02:10:40,575 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 02:10:03,451 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 01:52:04,112 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:52:04,112 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37627'), ('INFO', '2023-07-05 01:52:04,075 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:52:00,769 - distributed.worker - INFO - Starting Worker plugin PreImport-2bca0ae0-d8e2-46cc-a91b-af5eddb6a794'), ('INFO', '2023-07-05 01:52:00,769 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-e1648e3a-71b9-4057-991c-3db0366e1a0f'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO - Starting Worker plugin RMMSetup-9ae1c3d3-c04f-43d8-8186-b69f62457b43'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-fif12piw'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37627'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33761'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:38189'), ('INFO', '2023-07-05 01:52:00,121 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:38189'))}
2023-07-05 02:14:00,419 - distributed.nanny - WARNING - Worker process still alive after 3.1999990844726565 seconds, killing
2023-07-05 02:14:00,420 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/cuml_single_node.py", line 107, in <module>
    raise e
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/cuml_single_node.py", line 94, in <module>
    kmeans.fit(ddf)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cuml/internals/memory_utils.py", line 85, in cupy_rmm_wrapper
    return func(*args, **kwargs)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cuml/dask/cluster/kmeans.py", line 170, in fit
    wait_and_raise_from_futures(kmeans_fit)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cuml/dask/common/utils.py", line 159, in wait_and_raise_from_futures
    raise_exception_from_futures(futures)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cuml/dask/common/utils.py", line 148, in raise_exception_from_futures
    raise RuntimeError("%d of %d worker jobs failed: %s" % (
RuntimeError: 2 of 2 worker jobs failed: std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/rapids/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded, std::bad_alloc: out_of_memory: RMM failure at:/opt/conda/envs/rapids/include/rmm/mr/device/pool_memory_resource.hpp:193: Maximum pool size exceeded
slurmstepd: error: *** JOB 688271 ON dgx-4 CANCELLED AT 2023-07-05T07:45:49 ***
