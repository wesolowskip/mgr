+ CONTAINER=/home2/faculty/pwesolowski/containers/cuml-prod.sif
+ CONTAINER_RC_FILE=/home2/faculty/pwesolowski/containers/singularity_rc
+ SCRIPT=/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ for FILES in ""
+ for PROTOCOL in tcp ucx
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ --enable-infiniband == '' ]]
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ --enable-nvlink == '' ]]
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3721292)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 07:58:22,650 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 07:58:22,651 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 07:58:22,652 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 07:58:22,652 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 118190.83596 ms
Code block 'ddf-preprocessing' took: 96932.36828 ms
Code block 'ddf-preprocessing' took: 96632.99494 ms
Code block 'ddf-preprocessing' took: 96837.00163 ms
Code block 'ddf-preprocessing' took: 96323.10033 ms
Code block 'ddf-scaler-fit' took: 100759.63282 ms
Code block 'ddf-scaler-fit' took: 97997.23819 ms
Code block 'ddf-scaler-fit' took: 100475.97519 ms
Code block 'ddf-scaler-fit' took: 102967.86002 ms
Code block 'ddf-scaler-fit' took: 106520.82654 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 200680.91169 ms
Code block 'ddf-kmeans-score' took: 112409.92340 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 237592.97778 ms
Code block 'ddf-kmeans-score' took: 112785.38757 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 238581.32061 ms
Code block 'ddf-kmeans-score' took: 112169.77412 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 237513.76400 ms
Code block 'ddf-kmeans-score' took: 112538.25191 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 239040.40030 ms
Code block 'ddf-kmeans-score' took: 113699.93364 ms
scores=[array(-4.3389356e+08)]
client.get_worker_logs()={'tcp://127.0.0.1:44161': (('INFO', "2023-07-05 08:42:17,811 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:40:01,238 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:36:24,861 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:34:09,949 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:30:33,761 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:28:17,447 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:24:40,901 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:22:25,545 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:18:49,535 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:17:10,597 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 07:58:26,642 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 07:58:26,642 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:40115'), ('INFO', '2023-07-05 07:58:26,622 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO - Starting Worker plugin PreImport-824481c8-a65f-4335-8ccd-06f9df631757'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-c7253fa6-401e-4059-ad6b-e6593ebb67c3'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO - Starting Worker plugin RMMSetup-4878b673-da61-4392-b471-719f94ef9872'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-d7i76z46'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:40115'), ('INFO', '2023-07-05 07:58:23,750 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38413'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:44161'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:44161')), 'tcp://127.0.0.1:45183': (('INFO', "2023-07-05 08:42:17,811 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:40:01,238 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:36:24,861 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:34:09,949 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:30:33,761 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:28:17,447 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:24:40,901 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:22:25,544 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 08:18:49,535 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 08:17:10,596 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 07:58:26,642 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 07:58:26,642 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:40115'), ('INFO', '2023-07-05 07:58:26,622 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO - Starting Worker plugin PreImport-ac9f198b-fd61-4f5d-a5af-621a6a84fdd5'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO - Starting Worker plugin RMMSetup-34b14072-b0af-4885-b642-0f9e52c6b26b'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-9e683704-8516-4370-9af0-d37137924e49'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-horu2gjv'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:40115'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33353'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:45183'), ('INFO', '2023-07-05 07:58:23,749 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:45183'))}
2023-07-05 08:44:16,249 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-05 08:44:16,251 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3764955)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-05 08:44:37,564 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 08:44:37,565 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 08:44:37,566 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 08:44:37,566 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 124150.52654 ms
Code block 'ddf-preprocessing' took: 99095.13379 ms
Code block 'ddf-preprocessing' took: 98887.78005 ms
Code block 'ddf-preprocessing' took: 99001.43476 ms
Code block 'ddf-preprocessing' took: 98881.85727 ms
Code block 'ddf-scaler-fit' took: 122400.33699 ms
Code block 'ddf-scaler-fit' took: 124866.93347 ms
Code block 'ddf-scaler-fit' took: 123340.64666 ms
Code block 'ddf-scaler-fit' took: 125619.76699 ms
Code block 'ddf-scaler-fit' took: 128292.58517 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 265462.80393 ms
Code block 'ddf-kmeans-score' took: 136122.97134 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 259259.81073 ms
Code block 'ddf-kmeans-score' took: 128457.10853 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 254367.82084 ms
Code block 'ddf-kmeans-score' took: 129178.37526 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 254362.16142 ms
Code block 'ddf-kmeans-score' took: 128437.70961 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 254977.94694 ms
Code block 'ddf-kmeans-score' took: 129105.98205 ms
scores=[array(-4.86131085e+08)]
client.get_worker_logs()={'tcp://127.0.0.1:34689': (('INFO', "2023-07-05 09:34:11,970 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:31:55,545 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:27:47,174 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:25:31,008 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:21:22,195 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:19:05,293 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:14:57,895 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:12:41,979 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:08:21,035 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:05:59,453 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 08:44:42,332 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 08:44:42,332 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:42677'), ('INFO', '2023-07-05 08:44:42,298 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO - Starting Worker plugin PreImport-8ec57674-6c35-4538-bd39-14da6914784f'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-106bada0-547a-469b-9d44-548db2ca94ab'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO - Starting Worker plugin RMMSetup-6a5de9f4-bf13-44bd-aef9-aa293a22526a'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-ra2pryub'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:42677'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43453'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:34689'), ('INFO', '2023-07-05 08:44:38,928 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:34689')), 'tcp://127.0.0.1:41919': (('INFO', "2023-07-05 09:34:11,970 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:31:55,545 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:27:47,174 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:25:31,008 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:21:22,195 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:19:05,293 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:14:57,895 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:12:41,979 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:08:21,035 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:05:59,453 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 08:44:42,333 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 08:44:42,333 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:42677'), ('INFO', '2023-07-05 08:44:42,298 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO - Starting Worker plugin PreImport-60a4b565-b6d1-489c-bdf2-ab0aa8dce1a6'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-d2529416-4abb-45c7-8dc4-f2f2e41f4f94'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO - Starting Worker plugin RMMSetup-950413f7-19ae-408a-8c2f-84a247176304'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-m_okk00e'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:42677'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46539'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:41919'), ('INFO', '2023-07-05 08:44:38,929 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:41919'))}
2023-07-05 09:36:26,076 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 09:36:26,078 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (350071)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 09:36:47,402 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 09:36:47,403 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 09:36:47,404 - distributed.diskutils - INFO - Found stale lock file and directory '/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-p61ovr4l', purging
2023-07-05 09:36:47,410 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 09:36:47,410 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 110648.89239 ms
Code block 'ddf-preprocessing' took: 85933.47243 ms
Code block 'ddf-preprocessing' took: 85597.90248 ms
Code block 'ddf-preprocessing' took: 85183.25956 ms
Code block 'ddf-preprocessing' took: 85086.45171 ms
Code block 'ddf-scaler-fit' took: 90066.11292 ms
Code block 'ddf-scaler-fit' took: 83713.66053 ms
Code block 'ddf-scaler-fit' took: 85840.07364 ms
Code block 'ddf-scaler-fit' took: 85870.52207 ms
Code block 'ddf-scaler-fit' took: 87160.07788 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 226256.03765 ms
Code block 'ddf-kmeans-score' took: 91599.40617 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 225636.57426 ms
Code block 'ddf-kmeans-score' took: 89262.41318 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 223696.48331 ms
Code block 'ddf-kmeans-score' took: 88819.81887 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 224475.33032 ms
Code block 'ddf-kmeans-score' took: 89952.99782 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 223313.29095 ms
Code block 'ddf-kmeans-score' took: 89558.68057 ms
scores=[array(-4.33893698e+08)]
client.get_worker_logs()={'tcp://127.0.0.1:42009': (('INFO', "2023-07-05 10:16:32,976 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:14:16,595 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:11:18,568 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:09:01,908 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:06:04,100 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:03:48,039 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:00:50,020 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:58:33,621 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:55:31,645 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:53:11,507 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 09:36:52,140 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 09:36:52,139 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37013'), ('INFO', '2023-07-05 09:36:52,071 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO - Starting Worker plugin PreImport-7cfed02d-9773-4eed-95f5-a0dd99f5683e'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-fe468d36-b499-4c24-ab97-d7ebe51fd368'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO - Starting Worker plugin RMMSetup-23abbfb5-6384-44a1-a5fb-7d537029fc49'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-gov_jk0d'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37013'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -          dashboard at:            127.0.0.1:45449'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:42009'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:42009')), 'tcp://127.0.0.1:42523': (('INFO', "2023-07-05 10:16:32,976 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:14:16,596 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:11:18,568 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:09:01,908 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:06:04,100 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:03:48,039 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:00:50,020 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:58:33,619 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 09:55:31,645 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 09:53:11,507 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 09:36:52,139 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 09:36:52,139 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:37013'), ('INFO', '2023-07-05 09:36:52,071 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 09:36:52,071 - distributed.worker - INFO - Starting Worker plugin RMMSetup-d12cc2e8-e736-4b30-941b-d2b76b5f113f'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO - Starting Worker plugin PreImport-9ebadbfd-921e-4f50-86f3-a515c2e23422'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-db7f437b-feea-4973-bf59-abd61a1e05d6'), ('INFO', '2023-07-05 09:36:48,634 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-phcarnxr'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:37013'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43163'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:42523'), ('INFO', '2023-07-05 09:36:48,633 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:42523'))}
2023-07-05 10:18:07,409 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-05 10:18:07,411 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ tcp == ucx ]]
+ [[ '' == '' ]]
+ [[ '' == '' ]]
+ FILES=
+ PROTOCOL=tcp
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (541184)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol tcp --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='tcp', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-05 10:18:28,529 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 10:18:28,531 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 10:18:28,531 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 10:18:28,531 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 112687.52574 ms
Code block 'ddf-preprocessing' took: 85233.87369 ms
Code block 'ddf-preprocessing' took: 85251.82961 ms
Code block 'ddf-preprocessing' took: 85161.12855 ms
Code block 'ddf-preprocessing' took: 85450.58251 ms
Code block 'ddf-scaler-fit' took: 103875.75312 ms
Code block 'ddf-scaler-fit' took: 97218.53915 ms
Code block 'ddf-scaler-fit' took: 100469.17761 ms
Code block 'ddf-scaler-fit' took: 101430.77721 ms
Code block 'ddf-scaler-fit' took: 102685.90151 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 241185.09818 ms
Code block 'ddf-kmeans-score' took: 102207.15913 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 238601.93502 ms
Code block 'ddf-kmeans-score' took: 103923.78654 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 239444.06755 ms
Code block 'ddf-kmeans-score' took: 104204.60191 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 237226.95406 ms
Code block 'ddf-kmeans-score' took: 107186.66861 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 238892.81193 ms
Code block 'ddf-kmeans-score' took: 104412.47985 ms
scores=[array(-1.14596797e+08)]
client.get_worker_logs()={'tcp://127.0.0.1:35369': (('INFO', "2023-07-05 11:01:39,046 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:59:21,419 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:55:51,838 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:53:35,519 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:50:09,070 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:47:50,957 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:44:24,585 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:42:07,239 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:38:42,431 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:36:23,220 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 10:18:33,292 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 10:18:33,292 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:34247'), ('INFO', '2023-07-05 10:18:33,245 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - Starting Worker plugin PreImport-3ca1393e-9d76-4fcc-bfa2-32712483ec1a'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-2d207783-5e5b-44a6-9b1d-7d57845c3709'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - Starting Worker plugin RMMSetup-cc76cd0d-5683-4e4e-8ecd-36284edbb334'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-n895po54'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:34247'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40047'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:35369'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:35369')), 'tcp://127.0.0.1:46503': (('INFO', "2023-07-05 11:01:39,046 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:59:21,419 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:55:51,838 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:53:35,519 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:50:09,070 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:47:50,958 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:44:24,585 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:42:07,239 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 10:38:42,431 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 10:36:23,220 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 10:18:33,293 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 10:18:33,292 - distributed.worker - INFO -         Registered to:      tcp://127.0.0.1:34247'), ('INFO', '2023-07-05 10:18:33,245 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 10:18:33,245 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-d4e394b9-862d-421a-b52a-333e7ede1ef4'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - Starting Worker plugin PreImport-38a2b178-42bf-4f1a-af77-672bd2a2ab03'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - Starting Worker plugin RMMSetup-d8a02f3b-4902-4909-8009-6c38a3d943c0'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-0vefg4gk'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO - Waiting to connect to:      tcp://127.0.0.1:34247'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46589'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -          Listening to:      tcp://127.0.0.1:46503'), ('INFO', '2023-07-05 10:18:29,952 - distributed.worker - INFO -       Start worker at:      tcp://127.0.0.1:46503'))}
2023-07-05 11:03:28,344 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 11:03:28,345 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for PROTOCOL in tcp ucx
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (587722)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 11:03:49,240 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 11:03:49,241 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 11:03:49,242 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 11:03:49,242 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 123971.72593 ms
Code block 'ddf-preprocessing' took: 97601.54778 ms
Code block 'ddf-preprocessing' took: 97555.49286 ms
Code block 'ddf-preprocessing' took: 98070.59905 ms
Code block 'ddf-preprocessing' took: 98373.91622 ms
Code block 'ddf-scaler-fit' took: 104898.39974 ms
Code block 'ddf-scaler-fit' took: 104085.85890 ms
Code block 'ddf-scaler-fit' took: 105844.12307 ms
Code block 'ddf-scaler-fit' took: 108210.72875 ms
Code block 'ddf-scaler-fit' took: 111417.92597 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 244029.22360 ms
Code block 'ddf-kmeans-score' took: 115255.21817 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 239839.14580 ms
Code block 'ddf-kmeans-score' took: 115928.12210 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 240719.59567 ms
Code block 'ddf-kmeans-score' took: 116676.16620 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 242389.80366 ms
Code block 'ddf-kmeans-score' took: 118665.81830 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 240428.34561 ms
Code block 'ddf-kmeans-score' took: 116002.89713 ms
scores=[array(-4.33906006e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:49489': (('INFO', "2023-07-05 11:49:31,883 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:47:13,653 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:43:31,305 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:41:14,434 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:37:30,806 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:35:14,465 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:31:32,704 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:29:16,984 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:25:36,098 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:23:15,860 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 11:03:53,353 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:03:53,353 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:44885'), ('INFO', '2023-07-05 11:03:53,266 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:03:49,938 - distributed.worker - INFO - Starting Worker plugin PreImport-8ce0850c-71a4-4fe2-a4a4-f37c97b72c4d'), ('INFO', '2023-07-05 11:03:49,938 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-29326e8d-5cef-428d-83a4-c2a75a58d0a2'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - Starting Worker plugin RMMSetup-bcf4e566-acf2-42c4-ad43-500aaffbeade'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-7z8tfg40'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:44885'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33179'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:49489'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:49489')), 'ucx://127.0.0.1:56939': (('INFO', "2023-07-05 11:49:31,883 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:47:13,653 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:43:31,305 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:41:14,434 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:37:30,806 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:35:14,465 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:31:32,704 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:29:16,984 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 11:25:36,098 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 11:23:15,860 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 11:03:53,352 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:03:53,352 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:44885'), ('INFO', '2023-07-05 11:03:53,266 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - Starting Worker plugin PreImport-07fa35d7-275f-4ed3-a06d-7f072f5d1b17'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - Starting Worker plugin RMMSetup-811e5f15-c98e-460b-8cc0-819d9c525a95'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-f6ca443d-21e2-422a-a2cd-39f8a2fedab7'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-j3iz7van'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:44885'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -          dashboard at:            127.0.0.1:34479'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:56939'), ('INFO', '2023-07-05 11:03:49,937 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:56939'))}
2023-07-05 11:51:33,623 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
2023-07-05 11:51:33,624 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (679412)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 11:51:59,511 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 11:51:59,512 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 11:51:59,513 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 11:51:59,513 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 126389.68112 ms
Code block 'ddf-preprocessing' took: 97460.27112 ms
Code block 'ddf-preprocessing' took: 98089.29443 ms
Code block 'ddf-preprocessing' took: 97272.78295 ms
Code block 'ddf-preprocessing' took: 96877.25672 ms
Code block 'ddf-scaler-fit' took: 117138.33813 ms
Code block 'ddf-scaler-fit' took: 117903.72276 ms
Code block 'ddf-scaler-fit' took: 118340.88309 ms
Code block 'ddf-scaler-fit' took: 120588.26031 ms
Code block 'ddf-scaler-fit' took: 125334.18403 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 263516.68741 ms
Code block 'ddf-kmeans-score' took: 142820.78210 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 269136.94074 ms
Code block 'ddf-kmeans-score' took: 139455.82340 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 257777.97192 ms
Code block 'ddf-kmeans-score' took: 144399.69568 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 266931.16234 ms
Code block 'ddf-kmeans-score' took: 144756.18102 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 269491.17832 ms
Code block 'ddf-kmeans-score' took: 145853.29685 ms
scores=[array(-4.33875864e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:38565': (('INFO', "2023-07-05 12:42:34,844 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:40:17,838 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:35:39,164 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:33:22,669 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:28:46,324 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:26:38,087 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:22:07,318 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:19:48,653 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:15:13,669 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:12:53,132 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 11:52:04,689 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:52:04,689 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:52983'), ('INFO', '2023-07-05 11:52:04,568 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Starting Worker plugin PreImport-d0d79d5d-b46b-4b28-b21b-047d584cc573'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-55a34a18-a654-468a-8aca-530760ae69fa'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Starting Worker plugin RMMSetup-5eea67ee-aae5-4e72-907b-ad0f7a6dcc8c'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-awwd4hva'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:52983'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -          dashboard at:            127.0.0.1:39119'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 11:52:00,201 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:38565'), ('INFO', '2023-07-05 11:52:00,201 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:38565')), 'ucx://127.0.0.1:48613': (('INFO', "2023-07-05 12:42:34,844 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:40:17,838 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:35:39,164 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:33:22,669 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:28:46,324 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:26:38,087 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:22:07,318 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:19:48,653 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 12:15:13,669 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 12:12:53,132 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 11:52:04,690 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:52:04,689 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:52983'), ('INFO', '2023-07-05 11:52:04,568 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Starting Worker plugin PreImport-6b03a15c-8446-4798-a812-535a24a5887d'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-f43b99c3-1fb2-43cb-bec8-ef317e556581'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Starting Worker plugin RMMSetup-0b386c7b-2b26-4d7f-9073-f2b01a91c531'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-gcqicsrv'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:52983'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36625'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:48613'), ('INFO', '2023-07-05 11:52:00,202 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:48613'))}
2023-07-05 12:45:05,861 - distributed.nanny - WARNING - Worker process still alive after 3.1999989318847657 seconds, killing
2023-07-05 12:45:05,863 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (2313928)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 12:45:38,109 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 12:45:38,110 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 12:45:38,111 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 12:45:38,111 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 120614.41327 ms
Code block 'ddf-preprocessing' took: 89055.83408 ms
Code block 'ddf-preprocessing' took: 88114.16311 ms
Code block 'ddf-preprocessing' took: 88808.32458 ms
Code block 'ddf-preprocessing' took: 87573.45805 ms
Code block 'ddf-scaler-fit' took: 96361.15896 ms
Code block 'ddf-scaler-fit' took: 90576.75200 ms
Code block 'ddf-scaler-fit' took: 92188.32488 ms
Code block 'ddf-scaler-fit' took: 87997.90997 ms
Code block 'ddf-scaler-fit' took: 89236.56223 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 227411.23200 ms
Code block 'ddf-kmeans-score' took: 90823.27174 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 225026.53851 ms
Code block 'ddf-kmeans-score' took: 91008.04445 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 227035.58948 ms
Code block 'ddf-kmeans-score' took: 91324.21164 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 122971.11337 ms
Code block 'ddf-kmeans-score' took: 91131.90361 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 227100.35115 ms
Code block 'ddf-kmeans-score' took: 91491.94193 ms
scores=[array(-3.87255503e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:45929': (('INFO', "2023-07-05 13:24:43,732 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:22:25,825 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:19:24,329 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:18:49,800 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:15:48,823 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:13:30,297 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:10:29,574 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:08:12,980 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:05:12,501 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:02:53,031 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 12:45:43,565 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 12:45:43,565 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:37583'), ('INFO', '2023-07-05 12:45:43,396 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 12:45:38,786 - distributed.worker - INFO - Starting Worker plugin PreImport-d3f1b35d-6950-41cb-bf19-047f4cac99f8'), ('INFO', '2023-07-05 12:45:38,786 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-6cb0a503-14a0-4e31-a010-644e336231cd'), ('INFO', '2023-07-05 12:45:38,786 - distributed.worker - INFO - Starting Worker plugin RMMSetup-613a040e-865e-41e3-b1a3-e4e7d899b5ff'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-3ztqpxs8'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:37583'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36243'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:45929'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:45929')), 'ucx://127.0.0.1:55095': (('INFO', "2023-07-05 13:24:43,732 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:22:25,825 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:19:24,329 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:18:49,800 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:15:48,823 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:13:30,296 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:10:29,574 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:08:12,980 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:05:12,501 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:02:53,031 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 12:45:43,564 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 12:45:43,564 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:37583'), ('INFO', '2023-07-05 12:45:43,396 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO - Starting Worker plugin PreImport-64822ed3-24d7-4982-af0e-433a48af7537'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-ead0d2fc-0f27-4ffa-9d10-f3822b9fd3f8'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO - Starting Worker plugin RMMSetup-18a99ea7-6143-49af-bcf2-26d85b960535'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-pr7mz8_8'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:37583'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -          dashboard at:            127.0.0.1:46291'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:55095'), ('INFO', '2023-07-05 12:45:38,785 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:55095'))}
2023-07-05 13:26:20,018 - distributed.nanny - WARNING - Worker process still alive after 3.1999990844726565 seconds, killing
2023-07-05 13:26:20,027 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (2982587)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 13:26:44,916 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 13:26:44,917 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 13:26:44,917 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 13:26:44,917 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 113131.33965 ms
Code block 'ddf-preprocessing' took: 86377.07831 ms
Code block 'ddf-preprocessing' took: 85837.04593 ms
Code block 'ddf-preprocessing' took: 86339.27142 ms
Code block 'ddf-preprocessing' took: 86270.56208 ms
Code block 'ddf-scaler-fit' took: 104596.22439 ms
Code block 'ddf-scaler-fit' took: 101046.23427 ms
Code block 'ddf-scaler-fit' took: 101907.00478 ms
Code block 'ddf-scaler-fit' took: 103831.50974 ms
Code block 'ddf-scaler-fit' took: 104754.30686 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 244067.77261 ms
Code block 'ddf-kmeans-score' took: 105036.35563 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 141575.38972 ms
Code block 'ddf-kmeans-score' took: 107370.08449 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 241076.52782 ms
Code block 'ddf-kmeans-score' took: 107833.49282 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 194945.68940 ms
Code block 'ddf-kmeans-score' took: 107924.84317 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 238901.77077 ms
Code block 'ddf-kmeans-score' took: 106269.91408 ms
scores=[array(-3.86724266e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:34415': (('INFO', "2023-07-05 14:08:05,467 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:05:48,157 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:02:17,438 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:00:46,388 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:57:13,436 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:54:54,598 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:51:23,776 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:50:45,939 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:47:15,930 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:44:54,812 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 13:26:49,162 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 13:26:49,162 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:37741'), ('INFO', '2023-07-05 13:26:49,073 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 13:26:49,073 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-cb851a62-87a6-48e1-a846-6c064e8d4fef'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO - Starting Worker plugin PreImport-dab8903d-e7eb-44a3-aba8-e018f25ddb93'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO - Starting Worker plugin RMMSetup-b8186f57-9492-465b-a55d-547bed9fa10b'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-a1i9j5ux'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:37741'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36597'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:34415'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:34415')), 'ucx://127.0.0.1:60815': (('INFO', "2023-07-05 14:08:05,467 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:05:48,156 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:02:17,438 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:00:46,388 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:57:13,436 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:54:54,598 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:51:23,776 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:50:45,939 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 13:47:15,930 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 13:44:54,812 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 13:26:49,163 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 13:26:49,163 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:37741'), ('INFO', '2023-07-05 13:26:49,073 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 13:26:49,073 - distributed.worker - INFO - Starting Worker plugin RMMSetup-99e22252-65e7-4d9f-b45a-5b98c3dc122e'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO - Starting Worker plugin PreImport-7ab42eec-d2c2-4820-80c9-8e4f8a9d721a'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-e83df83b-6553-410c-9103-37bbfcf06584'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-fsu5tucv'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:37741'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43357'), ('INFO', '2023-07-05 13:26:45,615 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:60815'), ('INFO', '2023-07-05 13:26:45,614 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:60815'))}
2023-07-05 14:09:56,580 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 14:09:56,582 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3220559)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 14:10:17,788 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 14:10:17,789 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 14:10:17,790 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 14:10:17,790 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 124378.89603 ms
Code block 'ddf-preprocessing' took: 97644.12829 ms
Code block 'ddf-preprocessing' took: 97145.50501 ms
Code block 'ddf-preprocessing' took: 98379.71888 ms
Code block 'ddf-preprocessing' took: 97277.79897 ms
Code block 'ddf-scaler-fit' took: 102476.14834 ms
Code block 'ddf-scaler-fit' took: 100731.50867 ms
Code block 'ddf-scaler-fit' took: 103417.34310 ms
Code block 'ddf-scaler-fit' took: 105769.59715 ms
Code block 'ddf-scaler-fit' took: 108632.89840 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 205506.99963 ms
Code block 'ddf-kmeans-score' took: 115176.28066 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 243072.67696 ms
Code block 'ddf-kmeans-score' took: 114486.32720 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 242322.61619 ms
Code block 'ddf-kmeans-score' took: 114812.96262 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 241775.42101 ms
Code block 'ddf-kmeans-score' took: 118056.40171 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 241966.20613 ms
Code block 'ddf-kmeans-score' took: 116323.58983 ms
scores=[array(-4.33900875e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:32935': (('INFO', "2023-07-05 14:55:09,973 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:52:53,814 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:49:08,445 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:46:50,529 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:43:10,369 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:40:52,642 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:37:12,044 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:34:53,118 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:31:12,336 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:29:29,559 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 14:10:21,954 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:10:21,954 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:45545'), ('INFO', '2023-07-05 14:10:21,868 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:10:21,868 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-b7057172-f4a9-41c1-8eab-c33f3872e83b'), ('INFO', '2023-07-05 14:10:21,867 - distributed.worker - INFO - Starting Worker plugin RMMSetup-78e15926-9e78-44ba-af48-4feab71c999b'), ('INFO', '2023-07-05 14:10:18,484 - distributed.worker - INFO - Starting Worker plugin PreImport-0aedad81-d6e3-44e7-b4a6-3d62320304bd'), ('INFO', '2023-07-05 14:10:18,484 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-j96i2kgy'), ('INFO', '2023-07-05 14:10:18,484 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 14:10:18,484 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:45545'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -          dashboard at:            127.0.0.1:42111'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:32935'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:32935')), 'ucx://127.0.0.1:56043': (('INFO', "2023-07-05 14:55:09,973 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:52:53,814 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:49:08,445 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:46:50,529 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:43:10,370 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:40:52,642 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:37:12,044 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:34:53,118 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 14:31:12,336 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 14:29:29,559 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 14:10:21,954 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:10:21,954 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:45545'), ('INFO', '2023-07-05 14:10:21,868 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:10:21,867 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-5d24b10d-40e5-4a30-a696-3f333432744a'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO - Starting Worker plugin PreImport-2ba92d9f-1476-48c3-8d30-1a57866b6d65'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO - Starting Worker plugin RMMSetup-311c7ac7-8d15-46dd-a1f5-535b9c3d9b77'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-2pwr8u71'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:45545'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40227'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:56043'), ('INFO', '2023-07-05 14:10:18,483 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:56043'))}
2023-07-05 14:57:11,572 - distributed.nanny - WARNING - Worker process still alive after 3.1999983215332035 seconds, killing
2023-07-05 14:57:11,573 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3286605)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-05 14:57:35,877 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 14:57:35,878 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 14:57:35,878 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 14:57:35,878 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 124746.34168 ms
Code block 'ddf-preprocessing' took: 98173.18805 ms
Code block 'ddf-preprocessing' took: 98231.28450 ms
Code block 'ddf-preprocessing' took: 99864.55863 ms
Code block 'ddf-preprocessing' took: 104245.59265 ms
Code block 'ddf-scaler-fit' took: 134452.35706 ms
Code block 'ddf-scaler-fit' took: 126183.94169 ms
Code block 'ddf-scaler-fit' took: 135711.95546 ms
Code block 'ddf-scaler-fit' took: 133686.98386 ms
Code block 'ddf-scaler-fit' took: 138135.80827 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 273906.39778 ms
Code block 'ddf-kmeans-score' took: 148240.94702 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 250778.45831 ms
Code block 'ddf-kmeans-score' took: 150933.00033 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 174395.88579 ms
Code block 'ddf-kmeans-score' took: 152452.03582 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 271059.51380 ms
Code block 'ddf-kmeans-score' took: 146497.31393 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 267687.51713 ms
Code block 'ddf-kmeans-score' took: 150487.68289 ms
scores=[array(-4.04204575e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:35641': (('INFO', "2023-07-05 15:48:24,952 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:46:08,572 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:41:29,185 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:39:13,068 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:34:24,156 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:33:44,325 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:28:57,301 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:27:01,315 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:22:16,749 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:19:55,430 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 14:57:40,094 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:57:40,093 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:53833'), ('INFO', '2023-07-05 14:57:40,002 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - Starting Worker plugin PreImport-0ed4b411-e6a5-4d7d-b6fa-1d46af4dee16'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-74f7c4ef-0ad8-4795-acb2-33b3110f96c4'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - Starting Worker plugin RMMSetup-6a5135c3-1647-49b3-a3d3-cd3e9d036e0c'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-f8lm6w9e'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:53833'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36119'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:35641'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:35641')), 'ucx://127.0.0.1:60051': (('INFO', "2023-07-05 15:48:24,952 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:46:08,571 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:41:29,185 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:39:13,068 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:34:24,156 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:33:44,325 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:28:57,301 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:27:01,314 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 15:22:16,749 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 15:19:55,430 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 14:57:40,095 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:57:40,094 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:53833'), ('INFO', '2023-07-05 14:57:40,002 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:57:40,001 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-e53b465a-4921-4dcb-8243-cbe0617284a8'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - Starting Worker plugin PreImport-7d48bc2d-b939-4b89-a7be-f17ca97311d7'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - Starting Worker plugin RMMSetup-91d4a43d-154e-4dda-9d33-2e4b4f63a696'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-boijvs_m'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:53833'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -          dashboard at:            127.0.0.1:40619'), ('INFO', '2023-07-05 14:57:36,541 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 14:57:36,540 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:60051'), ('INFO', '2023-07-05 14:57:36,540 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:60051'))}
2023-07-05 15:51:00,515 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 15:51:00,517 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3362332)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 15:51:26,441 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 15:51:26,442 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 15:51:26,443 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 15:51:26,443 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 117227.51270 ms
Code block 'ddf-preprocessing' took: 89855.23364 ms
Code block 'ddf-preprocessing' took: 89182.83437 ms
Code block 'ddf-preprocessing' took: 89298.03641 ms
Code block 'ddf-preprocessing' took: 90229.82843 ms
Task exception was never retrieved
future: <Task finished name='Task-13215' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
Code block 'ddf-scaler-fit' took: 103241.53443 ms
Code block 'ddf-scaler-fit' took: 99959.98818 ms
Code block 'ddf-scaler-fit' took: 98064.54600 ms
Code block 'ddf-scaler-fit' took: 101671.65833 ms
Code block 'ddf-scaler-fit' took: 103111.33446 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 239887.09523 ms
Code block 'ddf-kmeans-score' took: 105419.31780 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 237765.53943 ms
Code block 'ddf-kmeans-score' took: 99622.24649 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 238159.93041 ms
Code block 'ddf-kmeans-score' took: 103426.31582 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 239367.89282 ms
Code block 'ddf-kmeans-score' took: 106895.98524 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 240631.18846 ms
Code block 'ddf-kmeans-score' took: 109051.76255 ms
scores=[array(-5.07920397e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:35781': (('INFO', "2023-07-05 16:34:58,704 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:32:41,849 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:29:10,016 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:26:54,618 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:23:26,031 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:21:07,994 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:17:47,054 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:15:29,406 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:12:02,673 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:09:41,674 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 15:51:31,779 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 15:51:31,779 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35661'), ('INFO', '2023-07-05 15:51:31,678 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO - Starting Worker plugin PreImport-a8ff1d48-989a-4cfa-a315-fff12c9b62f9'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO - Starting Worker plugin RMMSetup-5bdbd437-1134-42de-8ec0-365a01d0955c'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-d72f3d23-0dd6-4343-9e14-430a872ed7ae'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-qkkg_d7f'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35661'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37321'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:35781'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:35781')), 'ucx://127.0.0.1:48725': (('INFO', "2023-07-05 16:34:58,704 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:32:41,849 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:29:10,016 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:26:54,617 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:23:26,031 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:21:07,994 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:17:47,054 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:15:29,405 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:12:02,673 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:09:41,674 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 15:51:31,779 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 15:51:31,779 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35661'), ('INFO', '2023-07-05 15:51:31,678 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 15:51:31,678 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-92c540ec-759c-4808-8c56-c95969af0a02'), ('INFO', '2023-07-05 15:51:31,678 - distributed.worker - INFO - Starting Worker plugin RMMSetup-6232fecc-60f9-4377-832d-32ff0df97417'), ('INFO', '2023-07-05 15:51:27,183 - distributed.worker - INFO - Starting Worker plugin PreImport-dcd3d82b-e0af-42d6-a3eb-713b4652b04f'), ('INFO', '2023-07-05 15:51:27,183 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-nx7p8hap'), ('INFO', '2023-07-05 15:51:27,183 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35661'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38483'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:48725'), ('INFO', '2023-07-05 15:51:27,182 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:48725'))}
2023-07-05 16:36:52,627 - distributed.nanny - WARNING - Worker process still alive after 3.199999389648438 seconds, killing
2023-07-05 16:36:52,629 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=--enable-infiniband
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3403990)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-infiniband --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=True, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-05 16:37:19,338 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 16:37:19,339 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 16:37:19,340 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 16:37:19,340 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 116859.16379 ms
Code block 'ddf-preprocessing' took: 90903.72954 ms
Code block 'ddf-preprocessing' took: 89675.93152 ms
Code block 'ddf-preprocessing' took: 89461.51370 ms
Code block 'ddf-preprocessing' took: 89790.28157 ms
Code block 'ddf-scaler-fit' took: 117771.57214 ms
Code block 'ddf-scaler-fit' took: 109221.50958 ms
Code block 'ddf-scaler-fit' took: 114322.81217 ms
Code block 'ddf-scaler-fit' took: 118970.33555 ms
Code block 'ddf-scaler-fit' took: 116429.33555 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 262431.17383 ms
Code block 'ddf-kmeans-score' took: 125387.86825 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 207456.57084 ms
Code block 'ddf-kmeans-score' took: 120642.63379 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 253720.03064 ms
Code block 'ddf-kmeans-score' took: 116112.98597 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 252594.93188 ms
Code block 'ddf-kmeans-score' took: 119990.19480 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 251064.09032 ms
Code block 'ddf-kmeans-score' took: 120953.03703 ms
scores=[array(-70491556.22906494)]
client.get_worker_logs()={'ucx://127.0.0.1:40247': (('INFO', "2023-07-05 17:23:42,244 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:21:26,016 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:17:29,971 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:15:13,536 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:11:20,024 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:09:02,200 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:05:03,904 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:03:31,852 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:59:29,803 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:57:07,952 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 16:37:24,096 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 16:37:24,096 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:50979'), ('INFO', '2023-07-05 16:37:23,996 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 16:37:23,996 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-5c466073-0b4a-4720-b2f7-ca9fd03bc429'), ('INFO', '2023-07-05 16:37:23,996 - distributed.worker - INFO - Starting Worker plugin RMMSetup-32d1b059-ec04-4309-ab85-a003b699c8d3'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO - Starting Worker plugin PreImport-4747bcae-e7a7-4897-ba36-58f30d6b8801'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-6p_a6bhl'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:50979'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33885'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:40247'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:40247')), 'ucx://127.0.0.1:58559': (('INFO', "2023-07-05 17:23:42,244 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:21:26,016 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:17:29,971 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:15:13,536 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:11:20,024 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:09:02,200 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:05:03,904 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:03:31,852 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 16:59:29,803 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 16:57:07,952 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 16:37:24,097 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 16:37:24,097 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:50979'), ('INFO', '2023-07-05 16:37:23,996 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 16:37:23,996 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-b891d2fc-beda-47aa-906f-8aa94aad53d5'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO - Starting Worker plugin PreImport-fa4ca397-2b3e-4de5-9b26-3a65d9532938'), ('INFO', '2023-07-05 16:37:20,035 - distributed.worker - INFO - Starting Worker plugin RMMSetup-6f1e5aa8-12dc-4a07-a001-5e75466c9509'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-x8vv2pbj'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:50979'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO -          dashboard at:            127.0.0.1:42781'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:58559'), ('INFO', '2023-07-05 16:37:20,034 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:58559'))}
2023-07-05 17:25:48,006 - distributed.nanny - WARNING - Worker process still alive after 3.199998474121094 seconds, killing
2023-07-05 17:25:48,007 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for ENABLE_IB in "--enable-infiniband" ""
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3447563)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 17:26:14,385 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 17:26:14,386 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 17:26:14,387 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 17:26:14,387 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 132715.08189 ms
Code block 'ddf-preprocessing' took: 104506.61041 ms
Code block 'ddf-preprocessing' took: 103396.10254 ms
Code block 'ddf-preprocessing' took: 103322.88501 ms
Code block 'ddf-preprocessing' took: 104169.60896 ms
Code block 'ddf-scaler-fit' took: 121867.46739 ms
Code block 'ddf-scaler-fit' took: 116704.42976 ms
Code block 'ddf-scaler-fit' took: 124791.05666 ms
Code block 'ddf-scaler-fit' took: 125579.47997 ms
Code block 'ddf-scaler-fit' took: 132084.55543 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 171079.15340 ms
Code block 'ddf-kmeans-score' took: 134322.29265 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 263097.35937 ms
Code block 'ddf-kmeans-score' took: 136575.37664 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 155949.16703 ms
Code block 'ddf-kmeans-score' took: 135330.63001 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 260024.61852 ms
Code block 'ddf-kmeans-score' took: 134672.41337 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 258375.94226 ms
Code block 'ddf-kmeans-score' took: 135190.55727 ms
scores=[array(-67793105.20410156)]
client.get_worker_logs()={'ucx://127.0.0.1:46697': (('INFO', "2023-07-05 18:13:33,637 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:11:17,530 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:06:59,102 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:04:42,484 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:00:22,123 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:59:48,966 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:55:28,122 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:53:08,927 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:48:49,155 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:48:04,890 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 17:26:19,365 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 17:26:19,364 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:34719'), ('INFO', '2023-07-05 17:26:19,253 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Starting Worker plugin PreImport-acaeab5f-d92a-41f6-9bdb-ebd57d2eb63e'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-f15ffa87-2503-449a-8137-ab6a840aac84'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Starting Worker plugin RMMSetup-f940f585-b166-46ee-9d37-c7a5e464185c'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-bdl2ubdd'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:34719'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -          dashboard at:            127.0.0.1:35029'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:46697'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:46697')), 'ucx://127.0.0.1:46893': (('INFO', "2023-07-05 18:13:33,637 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:11:17,530 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:06:59,102 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:04:42,484 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:00:22,123 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:59:48,967 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:55:28,123 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:53:08,927 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 17:48:49,155 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 17:48:04,891 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 17:26:19,364 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 17:26:19,364 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:34719'), ('INFO', '2023-07-05 17:26:19,253 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Starting Worker plugin PreImport-2dad4df8-0463-4905-8b4f-edb52d29d982'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-07eb81ea-90d8-4db6-b6f2-014eeafe4fe2'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Starting Worker plugin RMMSetup-e18d6e91-fbf8-4c84-b7f9-438387a16cd7'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-f8z1dyub'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:34719'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33883'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:46893'), ('INFO', '2023-07-05 17:26:15,009 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:46893'))}
2023-07-05 18:15:54,778 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 18:15:54,780 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3492716)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 18:16:19,528 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 18:16:19,529 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 18:16:19,529 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 18:16:19,529 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 131274.39815 ms
Code block 'ddf-preprocessing' took: 103781.05288 ms
Code block 'ddf-preprocessing' took: 103593.52032 ms
Code block 'ddf-preprocessing' took: 105325.15119 ms
Code block 'ddf-preprocessing' took: 103091.35884 ms
Code block 'ddf-scaler-fit' took: 133755.79342 ms
Code block 'ddf-scaler-fit' took: 135932.85637 ms
Code block 'ddf-scaler-fit' took: 133936.31406 ms
Code block 'ddf-scaler-fit' took: 137071.12617 ms
Code block 'ddf-scaler-fit' took: 138300.57518 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 203265.89008 ms
Code block 'ddf-kmeans-score' took: 147848.95599 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 271965.62597 ms
Code block 'ddf-kmeans-score' took: 147698.40467 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 273019.25619 ms
Code block 'ddf-kmeans-score' took: 148816.81341 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 271291.39693 ms
Code block 'ddf-kmeans-score' took: 149884.37872 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 175291.45327 ms
Code block 'ddf-kmeans-score' took: 145685.44895 ms
scores=[array(-6.60260306e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:39755': (('INFO', "2023-07-05 19:06:54,857 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:06:18,950 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:01:27,657 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:59:10,927 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:54:26,076 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:52:10,063 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:47:23,841 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:45:06,927 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:40:22,403 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:39:14,855 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 18:16:23,883 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 18:16:23,883 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:60423'), ('INFO', '2023-07-05 18:16:23,800 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 18:16:23,800 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-06b67f71-20d0-4bbc-af89-a1504441af12'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO - Starting Worker plugin PreImport-0faa8557-5db3-4dbe-aa19-ded515f7a23d'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO - Starting Worker plugin RMMSetup-3d99cba1-1fb7-429c-8476-05dc9733b032'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-19690eew'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:60423'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33147'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:39755'), ('INFO', '2023-07-05 18:16:20,158 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:39755')), 'ucx://127.0.0.1:55843': (('INFO', "2023-07-05 19:06:54,857 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:06:18,950 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:01:27,657 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:59:10,927 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:54:26,076 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:52:10,064 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:47:23,841 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:45:06,927 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 18:40:22,403 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 18:39:14,855 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 18:16:23,882 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 18:16:23,882 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:60423'), ('INFO', '2023-07-05 18:16:23,800 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO - Starting Worker plugin PreImport-ea8da051-4579-4a12-8b58-01f517fd5b39'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-ea7a9464-6ca5-4d7e-967e-8430fd1beabb'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO - Starting Worker plugin RMMSetup-242e8ba3-1488-4159-b8d3-fad80ef7dba1'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-mkf326zs'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:60423'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38763'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:55843'), ('INFO', '2023-07-05 18:16:20,159 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:55843'))}
2023-07-05 19:09:25,667 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 19:09:25,668 - distributed.nanny - WARNING - Worker process still alive after 3.1999995422363288 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3540482)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 19:09:51,111 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 19:09:51,112 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 19:09:51,113 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 19:09:51,113 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 116976.76881 ms
Code block 'ddf-preprocessing' took: 89477.95802 ms
Code block 'ddf-preprocessing' took: 88188.16998 ms
Code block 'ddf-preprocessing' took: 88729.90668 ms
Code block 'ddf-preprocessing' took: 88154.51299 ms
Code block 'ddf-scaler-fit' took: 99670.91013 ms
Task exception was never retrieved
future: <Task finished name='Task-12032' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
Code block 'ddf-scaler-fit' took: 99330.80833 ms
Code block 'ddf-scaler-fit' took: 99537.84514 ms
Code block 'ddf-scaler-fit' took: 102546.26204 ms
Code block 'ddf-scaler-fit' took: 98910.09454 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 240324.38017 ms
Code block 'ddf-kmeans-score' took: 103906.72802 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 239815.15476 ms
Code block 'ddf-kmeans-score' took: 105380.64495 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 236328.77979 ms
Code block 'ddf-kmeans-score' took: 104448.11316 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 236202.53855 ms
Code block 'ddf-kmeans-score' took: 104586.11746 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 238002.18510 ms
Code block 'ddf-kmeans-score' took: 105590.54735 ms
scores=[array(-98828043.83911133)]
client.get_worker_logs()={'ucx://127.0.0.1:33215': (('INFO', "2023-07-05 19:53:10,381 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:50:53,902 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:47:26,598 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:45:09,780 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:41:44,717 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:39:29,007 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:36:01,781 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:33:44,051 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:30:16,758 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:27:56,783 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 19:09:55,838 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:09:55,838 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:33977'), ('INFO', '2023-07-05 19:09:55,754 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO - Starting Worker plugin PreImport-e1d10999-f63c-4e92-b1e5-bb638ffbcb94'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-790b9fba-f3ee-46b5-86d0-596a5eaf55ee'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO - Starting Worker plugin RMMSetup-c1a53ba9-d255-4e42-9171-dbb562c9eb03'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-sytk6gla'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:33977'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37467'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:33215'), ('INFO', '2023-07-05 19:09:51,751 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:33215')), 'ucx://127.0.0.1:58221': (('INFO', "2023-07-05 19:53:10,381 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:50:53,901 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:47:26,598 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:45:09,780 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:41:44,717 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:39:29,007 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:36:01,781 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:33:44,051 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 19:30:16,752 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 19:27:56,783 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 19:09:55,839 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:09:55,838 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:33977'), ('INFO', '2023-07-05 19:09:55,754 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:09:55,754 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-9096c8bf-32f4-4a45-b7d1-055d4352d82d'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO - Starting Worker plugin PreImport-fc595ab9-98f7-46fb-bedc-5ffc5dbd3d52'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO - Starting Worker plugin RMMSetup-4938223b-2bb0-482f-b2ad-66a9a71a3f68'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-u7tmif6x'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:33977'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38813'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:58221'), ('INFO', '2023-07-05 19:09:51,750 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:58221'))}
2023-07-05 19:55:00,997 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 19:55:00,998 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=--enable-nvlink
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3582432)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --enable-nvlink --mp-blocksize 1GiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=True, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
/opt/conda/envs/rapids/lib/python3.10/site-packages/dask_cuda-23.2.0-py3.10.egg/dask_cuda/local_cuda_cluster.py:266: UserWarning: When using NVLink we recommend setting a `rmm_pool_size`. Please see: https://dask-cuda.readthedocs.io/en/latest/ucx.html#important-notes for more details
2023-07-05 19:55:24,578 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 19:55:24,579 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 19:55:24,580 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 19:55:24,580 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 117983.00420 ms
Code block 'ddf-preprocessing' took: 87967.02312 ms
Code block 'ddf-preprocessing' took: 88594.20179 ms
Code block 'ddf-preprocessing' took: 88415.20641 ms
Code block 'ddf-preprocessing' took: 88765.48380 ms
Code block 'ddf-scaler-fit' took: 115068.28844 ms
Code block 'ddf-scaler-fit' took: 113208.83066 ms
Code block 'ddf-scaler-fit' took: 112918.27463 ms
Code block 'ddf-scaler-fit' took: 116460.37113 ms
Code block 'ddf-scaler-fit' took: 114351.95642 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 220645.73083 ms
Code block 'ddf-kmeans-score' took: 116443.26109 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 152572.09185 ms
Code block 'ddf-kmeans-score' took: 113159.62704 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 252644.55862 ms
Code block 'ddf-kmeans-score' took: 117684.40837 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 255663.49666 ms
Code block 'ddf-kmeans-score' took: 121118.97118 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 252610.23687 ms
Code block 'ddf-kmeans-score' took: 119223.24368 ms
scores=[array(-4.3390882e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:33231': (('INFO', "2023-07-05 20:39:49,167 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:37:33,472 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:33:34,222 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:31:16,741 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:27:19,718 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:25:02,372 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:21:12,690 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:20:38,404 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:16:42,398 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:14:57,742 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 19:55:29,015 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:55:29,014 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35959'), ('INFO', '2023-07-05 19:55:28,922 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - Starting Worker plugin PreImport-0cdb5475-14f6-4835-af36-6ba8154cf933'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-6b86a539-5e24-434b-9dfd-cbf906c28e23'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - Starting Worker plugin RMMSetup-a7ac5409-f151-4152-b794-c9aa5e90e6cf'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-7qgokn3o'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35959'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37035'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:33231'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:33231')), 'ucx://127.0.0.1:56607': (('INFO', "2023-07-05 20:39:49,168 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:37:33,473 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:33:34,222 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:31:16,741 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:27:19,718 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:25:02,372 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:21:12,690 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:20:38,404 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 20:16:42,398 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 20:14:57,742 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 19:55:29,015 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:55:29,015 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35959'), ('INFO', '2023-07-05 19:55:28,922 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - Starting Worker plugin PreImport-160b10bd-cf74-4e70-bd92-575d789e37ee'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-1794bb3d-6e13-4ffe-ba34-48863e3c3363'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - Starting Worker plugin RMMSetup-d6d6efc5-c33c-432a-a283-b87cad0cc77c'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-a6shydmn'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 19:55:25,212 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 19:55:25,211 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35959'), ('INFO', '2023-07-05 19:55:25,211 - distributed.worker - INFO -          dashboard at:            127.0.0.1:36317'), ('INFO', '2023-07-05 19:55:25,211 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 19:55:25,211 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:56607'), ('INFO', '2023-07-05 19:55:25,211 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:56607'))}
2023-07-05 20:41:53,194 - distributed.nanny - WARNING - Worker process still alive after 3.1999990844726565 seconds, killing
2023-07-05 20:41:53,196 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for ENABLE_NVLINK in "--enable-nvlink" ""
+ for RMM_POOL_SIZE in ""
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3624586)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --mp-blocksize 256MiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 20:42:17,308 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 20:42:17,309 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 20:42:17,310 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 20:42:17,310 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 133617.22742 ms
Code block 'ddf-preprocessing' took: 101874.32643 ms
Code block 'ddf-preprocessing' took: 102819.27728 ms
Code block 'ddf-preprocessing' took: 102467.59627 ms
Code block 'ddf-preprocessing' took: 101374.28263 ms
Code block 'ddf-scaler-fit' took: 119295.41829 ms
Code block 'ddf-scaler-fit' took: 115419.06901 ms
Code block 'ddf-scaler-fit' took: 114973.79048 ms
Code block 'ddf-scaler-fit' took: 121931.79241 ms
Code block 'ddf-scaler-fit' took: 123393.18808 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 260136.65690 ms
Code block 'ddf-kmeans-score' took: 132212.90514 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 254303.76561 ms
Code block 'ddf-kmeans-score' took: 131060.01908 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 200025.83664 ms
Code block 'ddf-kmeans-score' took: 129224.54978 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 253638.16531 ms
Code block 'ddf-kmeans-score' took: 130403.77571 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 255664.57784 ms
Code block 'ddf-kmeans-score' took: 131873.93490 ms
scores=[array(-1.20791256e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:50405': (('INFO', "2023-07-05 21:30:40,480 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:28:21,806 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:24:12,914 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:21:57,387 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:17:48,503 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:16:25,208 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:12:15,844 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:10:00,158 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:05:47,767 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:03:25,417 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 20:42:21,262 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 20:42:21,262 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:56127'), ('INFO', '2023-07-05 20:42:21,185 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO - Starting Worker plugin PreImport-a16b29d0-bdda-4d02-960b-9fa8e9dc384b'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-90b88661-e2ff-4acd-aed0-1b2b97ffba43'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO - Starting Worker plugin RMMSetup-e0d4de02-61e9-4f8c-9911-63b3eae59cbe'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-x55wq2aw'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:56127'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO -          dashboard at:            127.0.0.1:33577'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:50405'), ('INFO', '2023-07-05 20:42:17,959 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:50405')), 'ucx://127.0.0.1:57595': (('INFO', "2023-07-05 21:30:40,480 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:28:21,807 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:24:12,914 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:21:57,387 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:17:48,503 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:16:25,208 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:12:15,843 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:10:00,158 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:05:47,768 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:03:25,417 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 20:42:21,263 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 20:42:21,262 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:56127'), ('INFO', '2023-07-05 20:42:21,185 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO - Starting Worker plugin PreImport-bf36078f-1b46-4632-a03f-2171edb97ab7'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-a7600392-788d-4f32-9044-14405519f2d6'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO - Starting Worker plugin RMMSetup-79977951-b0fd-49c3-b1c9-083c9396e12b'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-s4abtlqv'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:56127'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO -          dashboard at:            127.0.0.1:37509'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:57595'), ('INFO', '2023-07-05 20:42:17,960 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:57595'))}
2023-07-05 21:32:57,485 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 21:32:57,485 - distributed.nanny - WARNING - Worker process still alive after 3.199999694824219 seconds, killing
+ sleep 1
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=256MiB
+ MP_PINNED_READ=--mp-pinned-read
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3670315)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --mp-blocksize 256MiB --mp-force-host-read --mp-pinned-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='256MiB', mp_force_host_read=True, mp_pinned_read=True, mp_force_gpu_preprocess=False)
2023-07-05 21:33:21,190 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 21:33:21,190 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 21:33:21,191 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 21:33:21,191 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 129294.60021 ms
Code block 'ddf-preprocessing' took: 101834.96987 ms
Code block 'ddf-preprocessing' took: 101562.94028 ms
Code block 'ddf-preprocessing' took: 102246.54781 ms
Code block 'ddf-preprocessing' took: 101612.68652 ms
Code block 'ddf-scaler-fit' took: 132322.36061 ms
Code block 'ddf-scaler-fit' took: 129588.88944 ms
Code block 'ddf-scaler-fit' took: 129973.27080 ms
Code block 'ddf-scaler-fit' took: 134720.80858 ms
Code block 'ddf-scaler-fit' took: 136837.40855 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 271083.08682 ms
Code block 'ddf-kmeans-score' took: 145723.51323 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 272247.10834 ms
Code block 'ddf-kmeans-score' took: 146594.83252 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 268693.20864 ms
Code block 'ddf-kmeans-score' took: 146519.93986 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 269099.20650 ms
Code block 'ddf-kmeans-score' took: 147288.28737 ms
Fitting kmeans with 8 clusters
Code block 'ddf-kmeans-fit' took: 267753.50335 ms
Code block 'ddf-kmeans-score' took: 144870.79262 ms
scores=[array(-4.33893008e+08)]
client.get_worker_logs()={'ucx://127.0.0.1:57445': (('INFO', "2023-07-05 22:25:56,700 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:23:39,834 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 22:19:00,081 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:16:43,837 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 22:12:02,901 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:09:46,067 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 22:05:06,072 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:02:47,313 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:58:06,194 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:55:45,762 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 21:33:25,276 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 21:33:25,276 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35255'), ('INFO', '2023-07-05 21:33:25,197 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - Starting Worker plugin PreImport-dd188f70-d84c-4ef2-bc64-04ddf0c8e784'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-6999f418-f50e-4fab-b6d0-537388e44117'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - Starting Worker plugin RMMSetup-3c5f0f05-7d2f-44cc-b511-2fd12e614547'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-sd4v_ksd'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35255'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -          dashboard at:            127.0.0.1:43655'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -           Worker name:                          0'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:57445'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:57445')), 'ucx://127.0.0.1:59203': (('INFO', "2023-07-05 22:25:56,700 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:23:39,834 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 22:19:00,081 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:16:43,837 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 22:12:02,901 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:09:46,066 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 22:05:06,072 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 22:02:47,313 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', "2023-07-05 21:58:06,193 - distributed.worker - INFO - Run out-of-band function '_func_destroy_all'"), ('INFO', "2023-07-05 21:55:45,762 - distributed.worker - INFO - Run out-of-band function '_func_init_all'"), ('INFO', '2023-07-05 21:33:25,277 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 21:33:25,276 - distributed.worker - INFO -         Registered to:      ucx://127.0.0.1:35255'), ('INFO', '2023-07-05 21:33:25,197 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 21:33:21,786 - distributed.worker - INFO - Starting Worker plugin PreImport-7c6ea63a-dc28-41d7-a733-5b7458e5ac33'), ('INFO', '2023-07-05 21:33:21,786 - distributed.worker - INFO - Starting Worker plugin CPUAffinity-b47939b2-441c-4355-b3b1-fab6cb283476'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - Starting Worker plugin RMMSetup-a769480b-9f81-45db-a329-f5377c7ca20d'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -       Local Directory: /scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/tmp/dask-worker-space/worker-6wfr8_q7'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -                Memory:                  20.00 GiB'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -               Threads:                          2'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - -------------------------------------------------'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO - Waiting to connect to:      ucx://127.0.0.1:35255'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -          dashboard at:            127.0.0.1:38583'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -           Worker name:                          1'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -          Listening to:      ucx://127.0.0.1:59203'), ('INFO', '2023-07-05 21:33:21,785 - distributed.worker - INFO -       Start worker at:      ucx://127.0.0.1:59203'))}
2023-07-05 22:28:27,575 - distributed.nanny - WARNING - Worker process still alive after 3.1999992370605472 seconds, killing
2023-07-05 22:28:27,575 - distributed.nanny - WARNING - Worker process still alive after 3.19999984741211 seconds, killing
+ sleep 1
+ for MP_BLOCKSIZE in "256MiB" "1GiB"
+ for MP_PINNED_READ in "" "--mp-pinned-read"
+ [[ ucx == ucx ]]
+ FILES=
+ PROTOCOL=ucx
+ ENABLE_IB=
+ ENABLE_NVLINK=
+ RMM_POOL_SIZE=
+ MP_BLOCKSIZE=1GiB
+ MP_PINNED_READ=
+ MP_FORCE_HOST_READ=--mp-force-host-read
+ singularity run --nv -B /scratch/shared/pwesolowski /home2/faculty/pwesolowski/containers/cuml-prod.sif /bin/bash --rcfile /home2/faculty/pwesolowski/containers/singularity_rc -ci /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/run_no_gds.sh
[WARN  tini (3724686)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ cd /home2/faculty/pwesolowski/praca-mgr/pipelines-repo/1_dataset_cuml/
+ python -u cuml_single_node.py --files --reps 5 --protocol ucx --mp-blocksize 1GiB --mp-force-host-read
<Managed Device 0>, <Managed Device 1>
args=Namespace(data_dir='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml', files=[], reps=5, protocol='ucx', enable_infiniband=False, enable_nvlink=False, rmm_pool_size=None, jit_unspill=False, mp_blocksize='1GiB', mp_force_host_read=True, mp_pinned_read=False, mp_force_gpu_preprocess=False)
2023-07-05 22:28:53,934 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 22:28:53,934 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
2023-07-05 22:28:53,936 - distributed.preloading - INFO - Creating preload: dask_cuda.initialize
2023-07-05 22:28:53,937 - distributed.preloading - INFO - Import preload module: dask_cuda.initialize
Code block 'ddf-preprocessing' took: 120292.56932 ms
Code block 'ddf-preprocessing' took: 88443.30785 ms
Code block 'ddf-preprocessing' took: 89778.21203 ms
Code block 'ddf-preprocessing' took: 89659.29120 ms
Code block 'ddf-preprocessing' took: 88457.55989 ms
Code block 'ddf-scaler-fit' took: 104315.24373 ms
Task exception was never retrieved
future: <Task finished name='Task-12727' coro=<_listener_handler_coroutine() done, defined at /opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py:128> exception=UCXError('<stream_recv>: Connection reset by remote peer')>
Traceback (most recent call last):
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py", line 143, in _listener_handler_coroutine
    peer_info = await exchange_peer_info(
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/ucp/core.py", line 52, in exchange_peer_info
    await comm.stream_recv(endpoint, peer_info_arr, peer_info_arr.nbytes)
ucp._libs.exceptions.UCXError: <stream_recv>: Connection reset by remote peer
2023-07-05 22:48:52,228 - distributed.scheduler - WARNING - Worker failed to heartbeat within 300 seconds. Closing: <WorkerState 'ucx://127.0.0.1:54405', name: 1, status: running, memory: 193, processing: 3>
slurmstepd: error: *** JOB 688277 ON dgx-4 CANCELLED AT 2023-07-05T23:16:08 ***
