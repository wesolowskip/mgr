[WARN  tini (3356550)] Tini is not running as PID 1 .
Zombie processes will not be re-parented to Tini, so zombie reaping won't work.
To fix the problem, run Tini as PID 1.
This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.download.nvidia.com/licenses/NVIDIA_Deep_Learning_Container_License.pdf

bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
+ LIBCUDF_CUFILE_POLICY=OFF
+ python -u cudf_benchmark.py
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 6842.60894 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 318.78616 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 379.19284 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 372.59174 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 375.62863 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 414.52965 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 404.81049 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 386.13522 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 370.37618 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 377.23633 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 383.81535 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 762.36699 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 806.92757 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 782.86050 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 792.20254 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 794.38608 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 789.27702 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 792.39230 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 789.90062 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 792.88165 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 802.62664 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 790.82814 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1326.37335 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1477.09897 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1433.55371 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1436.12975 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1449.80546 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1440.27263 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1441.36227 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1443.35470 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1440.84393 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1451.63913 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 1450.14023 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Arizona.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 2029.00028 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/New York.json', os.environ['LIBCUDF_CUFILE_POLICY']='OFF', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')=None, os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')=None' took: 3371.48369 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
+ for LIBCUDF_CUFILE_THREAD_COUNT in 4 8 16 32 64
+ LIBCUDF_CUFILE_POLICY=GDS
+ LIBCUDF_CUFILE_SLICE_SIZE=1048576
+ LIBCUDF_CUFILE_THREAD_COUNT=4
+ python -u cudf_benchmark.py
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1235.23296 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 381.84232 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 390.39817 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 385.08687 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 382.02996 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 378.16718 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 379.55881 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 375.58382 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 379.07934 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 376.52858 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 383.48402 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 727.21173 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 708.87953 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 710.07673 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 725.47507 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 697.73562 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 694.36061 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 693.50719 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 698.68761 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 687.54850 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 684.94574 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 693.18563 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1256.72096 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1222.57882 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1222.58022 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1255.47686 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1227.08196 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1241.69433 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1243.82768 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1373.79101 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1228.99346 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1229.98746 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1223.91800 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Arizona.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1743.61472 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/New York.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='4', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 2894.02781 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
+ for LIBCUDF_CUFILE_THREAD_COUNT in 4 8 16 32 64
+ LIBCUDF_CUFILE_POLICY=GDS
+ LIBCUDF_CUFILE_SLICE_SIZE=1048576
+ LIBCUDF_CUFILE_THREAD_COUNT=8
+ python -u cudf_benchmark.py
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 954.15537 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 291.86409 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 288.18744 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 296.62360 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 292.50712 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 287.16728 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 291.35064 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 288.02970 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 285.77214 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 285.18056 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 296.69574 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 537.85917 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 519.80813 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 519.67792 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 529.27678 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 523.73537 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 593.23927 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 883.26393 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 538.81767 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 725.41039 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 529.71660 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 809.65220 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 875.51478 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1194.49451 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1395.88208 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1188.28215 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1408.46980 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 871.94645 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1196.74171 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1552.75255 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 888.92347 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1195.56325 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1561.08307 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Arizona.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 978.29277 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/New York.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='8', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1593.86012 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
+ for LIBCUDF_CUFILE_THREAD_COUNT in 4 8 16 32 64
+ LIBCUDF_CUFILE_POLICY=GDS
+ LIBCUDF_CUFILE_SLICE_SIZE=1048576
+ LIBCUDF_CUFILE_THREAD_COUNT=16
+ python -u cudf_benchmark.py
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 902.14869 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 251.18574 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 249.16085 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 255.82118 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 251.31429 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 253.68995 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 249.42634 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 249.55861 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 257.64494 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 253.67456 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 249.86116 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 444.88035 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 434.63104 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 449.24169 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 783.28061 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 434.55658 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 829.44077 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 452.60834 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 579.62530 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 881.92431 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 447.30754 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 823.32768 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 743.46845 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1537.84386 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 911.90954 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1589.86795 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 758.34028 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1542.30466 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1252.79558 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1049.51212 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1367.65715 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1043.29868 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1000.26391 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Arizona.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 663.77768 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/New York.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='16', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1013.90296 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
+ for LIBCUDF_CUFILE_THREAD_COUNT in 4 8 16 32 64
+ LIBCUDF_CUFILE_POLICY=GDS
+ LIBCUDF_CUFILE_SLICE_SIZE=1048576
+ LIBCUDF_CUFILE_THREAD_COUNT=32
+ python -u cudf_benchmark.py
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 900.90708 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 243.22883 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 250.78897 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 246.32193 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 244.65785 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 243.45650 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 250.58961 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 252.66783 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 242.42058 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 240.44907 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 243.38717 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 428.50981 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 409.65693 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 416.91404 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 828.84432 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 619.32884 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 418.00993 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 855.49830 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 633.16498 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 679.40376 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 450.39526 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 794.75163 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 714.04223 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1529.29008 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1258.66253 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1049.53470 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1365.63143 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1235.96872 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1271.94129 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1271.98848 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 884.47263 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1511.71593 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1259.11562 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Arizona.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 503.39281 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/New York.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='32', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 761.97979 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
+ for LIBCUDF_CUFILE_THREAD_COUNT in 4 8 16 32 64
+ LIBCUDF_CUFILE_POLICY=GDS
+ LIBCUDF_CUFILE_SLICE_SIZE=1048576
+ LIBCUDF_CUFILE_THREAD_COUNT=64
+ python -u cudf_benchmark.py
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 900.75579 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 262.08510 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 244.91824 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 239.47189 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 248.04095 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 242.90930 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 246.00165 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 242.74138 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 237.22099 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 241.25250 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/West Virginia.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 243.77220 ms
shape=(2187197, 7)
df.memory_usage()=user_id       54679929
gmap_id       89541785
rating        17497576
category     127631997
latitude      17497576
longitude     17497576
time          17497576
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 424.25103 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 410.42126 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 418.74969 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 829.05419 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 413.55280 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 848.26797 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 594.41823 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 680.16822 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 419.37541 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 853.53219 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Iowa.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 409.95680 ms
shape=(4799312, 7)
df.memory_usage()=user_id      119982804
gmap_id      196460638
rating        38394496
category     286935552
latitude      38394496
longitude     38394496
time          38394496
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 662.75221 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=1, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1553.35420 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=2, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1260.62520 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=3, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1052.75967 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=4, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1354.17798 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=5, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1263.39569 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=6, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1265.67458 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=7, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1256.68930 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=8, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1039.09794 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=9, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1192.41289 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=10, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Alabama.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 1355.84760 ms
shape=(8900582, 7)
df.memory_usage()=user_id      222514554
gmap_id      364346849
rating        71204656
category     549710736
latitude      71204656
longitude     71204656
time          71204656
Index                0
dtype: int64
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/Arizona.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 489.26268 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
Code block 'i=0, fname='/scratch/shared/pwesolowski/mgr-pipeline/joined-cuml/New York.json', os.environ['LIBCUDF_CUFILE_POLICY']='GDS', os.environ.get('LIBCUDF_CUFILE_THREAD_COUNT')='64', os.environ.get('LIBCUDF_CUFILE_SLICE_SIZE')='1048576'' took: 699.84800 ms
Traceback (most recent call last):
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 46, in <module>
    benchmark_read_json(file)
  File "/home2/faculty/pwesolowski/praca-mgr/pipelines-repo/2_metajsonparser/cudf-parser/cudf_benchmark.py", line 36, in benchmark_read_json
    df = cudf.read_json(fname, lines=True, engine="cudf", compression=None)
  File "/opt/conda/envs/rapids/lib/python3.10/site-packages/cudf/io/json.py", line 111, in read_json
    df = libjson.read_json(
  File "json.pyx", line 50, in cudf._lib.json.read_json
  File "json.pyx", line 138, in cudf._lib.json.read_json
MemoryError: std::bad_alloc: out_of_memory: CUDA error at: /opt/conda/envs/rapids/include/rmm/mr/device/cuda_memory_resource.hpp:70: cudaErrorMemoryAllocation out of memory
